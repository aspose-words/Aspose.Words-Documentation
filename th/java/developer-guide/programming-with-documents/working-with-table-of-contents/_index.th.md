---
title: การ ทํา งาน ร่วม กับ สารบัญ ใน Java
second_title: Aspose.Words สําหรับ Java
articleTitle: การ ทํา งาน กับ สารบัญ
linktitle: การ ทํา งาน กับ สารบัญ
description: "ตารางของเนื้อหาในรายละเอียด วิธี สร้าง และ แก้ไข `TOC` ใช้ช่องข้อมูล Java."
type: docs
weight: 170
url: /th/java/working-with-table-of-contents/
timestamp: 2024-10-21-11-17-44
---

บ่อย ครั้ง คุณ จะ ทํา งาน กับ เอกสาร ที่ บรรจุ เนื้อหา ไว้ ใน โต๊ะ (TOC). ใช้ Aspose.Words คุณสามารถแทรกตารางเนื้อหาของคุณเอง หรือสร้างตารางเนื้อหาที่มีอยู่ในเอกสาร โดยใช้รหัสเพียงไม่กี่บรรทัด

บทความ นี้ อธิบาย วิธี ทํา งาน ร่วม กับ ตาราง เนื้อหา และ แสดง ให้ เห็น ว่า:

- จะใส่ TOC ใหม่
- ปรับปรุงใหม่หรือใช้ TOCs ในเอกสาร
- ระบุสวิตช์เพื่อควบคุมการฟอร์แมตและโครงสร้างโดยรวมของ TOC
- วิธีแก้ไขสไตล์และรูปลักษณ์ของตารางของเนื้อหา
- วิธีการเอาทั้ง `TOC` ช่องข้อมูลพร้อมกับรายการทั้งหมดจากเอกสาร

## แก้ไขโครงการหลัก.

คุณสามารถใส่ `TOC` ช่องข้อมูลข้อความเข้าเอกสารในตําแหน่งปัจจุบัน [InsertTableOfContents](https://reference.aspose.com/words/java/com.aspose.words/documentbuilder/#insertTableOfContents-java.lang.String) วิธี

ตาราง เนื้อหา ใน เอกสาร คํา สามารถ สร้าง ได้ ใน หลาย วิธี และ ปรับ ปรุง ให้ ดี ขึ้น โดย ใช้ วิธี ต่าง ๆ กัน. สลับสนามที่คุณส่งต่อวิธีการควบคุม วิธีการสร้างตารางและแสดงในเอกสารของคุณ

สวิทช์ปริยายที่ใช้ใน `TOC` แทรกเข้าไป Microsoft Word คือ **""/o "1-3/h/z/u"**. ราย ละเอียด เกี่ยว กับ การ เปลี่ยน แปลง เหล่า นี้ รวม ทั้ง รายการ ของ การ เปลี่ยน แปลง ที่ ได้ รับ การ สนับสนุน จะ พบ ได้ ใน บทความ นี้. คุณสามารถใช้คู่มือเพื่อให้ได้สวิทช์ที่ถูกต้อง หรือถ้าคุณมีอยู่แล้วเอกสารที่บรรจุคล้ายกัน `TOC` ที่คุณต้องการ คุณสามารถแสดงรหัสสนาม (ALT+F9*) และคัดลอกสวิทช์จากสนามโดยตรง

ตัว อย่าง รหัส ต่อ ไป นี้ แสดง ให้ เห็น วิธี ที่ จะ สอด แผ่น เนื้อหา เข้า ไป ใน เอกสาร:

{{< gist "aspose-words-gists" "827e71ccc0b8516a3cfe247b86ce6d4e" "Examples-src-main-java-com-aspose-words-examples-programming_documents-tableofcontents-InsertATableOfContentsField-InsertATableOfContentsField.java" >}}

ตัวอย่างโค้ดต่อไปนี้ จะแสดงวิธีแทรกตารางเนื้อหา (TOC) ไปยังเอกสารโดยใช้รูปแบบหัวเรื่องเป็นรายการ:

{{< gist "aspose-words-gists" "827e71ccc0b8516a3cfe247b86ce6d4e" "Examples-src-main-java-com-aspose-words-examples-programming_documents-tableofcontents-InsertATableOfContentsUsingHeadingStyles-InsertATableOfContentsUsingHeadingStyles.java" >}}

รหัสแสดงถึงตารางใหม่ของเนื้อหาจะถูกแทรกลงในเอกสารเปล่า เดอะ [DocumentBuilder](https://reference.aspose.com/words/java/com.aspose.words/documentbuilder/) จาก นั้น ก็ จะ ใช้ ใส่ เนื้อหา ตัว อย่าง บาง อย่าง ซึ่ง เป็น แบบ หัว เรื่อง ที่ เหมาะ สม ซึ่ง ใช้ หมาย เลข เนื้อหา ที่ จะ รวม ไว้ ใน TOC. บรรทัดต่อไปแล้ว popped `TOC` โดยการปรับปรุงช่องข้อมูลและการจัดวางหน้ากระดาษ

![insert-table-of-contents-field-aspose-words-java](/words/java/working-with-table-of-contents/how-to-insert-and-work-with-the-table-of-contents-field-1.png)

{{% alert color="primary" %}}

โดยไม่ต้องใช้วิธีที่ใช้ในตัวอย่าง เมื่อคุณเปิดเอกสารผลลัพธ์ คุณจะพบ `TOC` ทุ่งหญ้า แต่ไม่มีเนื้อหาที่มองเห็นได้ เพราะว่า `TOC` มี การ ใส่ แผ่น ดิน เหนียว เข้า ไป แต่ ยัง ไม่ มี การ เพิ่ม จํานวน จน กระทั่ง มี การ ปรับ ปรุง ใน เอกสาร ฉบับ นี้. มี การ พิจารณา ข้อมูล เพิ่ม เติม เกี่ยว กับ เรื่อง นี้ ใน ตอน ถัด ไป.

{{% /alert %}}

## สารบัญ

Aspose.Words ให้คุณได้ปรับปรุง `TOC` ด้วยรหัสไม่กี่บรรทัด นี้สามารถทําเพื่อขยายการแทรกใหม่ `TOC` หรือเพื่ออัปเดตรายการที่มีอยู่ `TOC` หลังจากมีการเปลี่ยนแปลงในเอกสารแล้ว

วิธีสองต่อไปนี้จะต้องใช้ในการปรับปรุง `TOC` ช่องข้อมูลในเอกสาร:

1. [Document.updateFields()](https://reference.aspose.com/words/java/com.aspose.words/Document#updateFields())
1. [Document.updatePageLayout()](https://reference.aspose.com/words/java/com.aspose.words/Document#updatePageLayout())

โปรดสังเกตว่า วิธีการปรับปรุงทั้งสองนี้ จะต้องถูกเรียกตามลําดับ หากกลับค่าของตารางเนื้อหาจะถูกวางอยู่ แต่จะไม่มีการแสดงหมายเลขหน้า TOCs จํานวนต่าง ๆ สามารถปรับปรุงได้ วิธีการเหล่านี้จะปรับปรุงค่า TOCs ทั้งหมดที่พบในเอกสารโดยอัตโนมัติ

ตัวอย่างรหัสต่อไปนี้ แสดงให้เห็นว่าจะสร้างใหม่อย่างสมบูรณ์ `TOC` ช่องข้อมูลในเอกสารโดยการปรับปรุงช่องข้อมูล:

{{< gist "aspose-words-gists" "827e71ccc0b8516a3cfe247b86ce6d4e" "Examples-src-main-java-com-aspose-words-examples-programming_documents-tableofcontents-InsertATableOfContentsField-UpdateTableOfContents.java" >}}

การเรียกครั้งแรก [Document.updateFields()](https://reference.aspose.com/words/java/com.aspose.words/document/#updateFields) จะสร้าง `TOC`'"> รายการข้อความทั้งหมดมีคนอยู่ และ `TOC` ดูเหมือนเกือบเสร็จสมบูรณ์แล้ว สิ่งเดียวที่ขาดไป คือหมายเลขหน้าสําหรับตอนนี้คือ "?".

การเรียกครั้งที่สอง [Document.updatePageLayout()](https://reference.aspose.com/words/java/com.aspose.words/document/#updatePageLayout) จะสร้างแผนผังของเอกสารในหน่วยความจํา นี่ต้องเสร็จสิ้นในการรวบรวมหมายเลขหน้าของรายการ ตัว เลข หน้า ที่ ถูก ต้อง ซึ่ง คํานวณ จาก การ เรียก นี้ จะ ถูก แทรก เข้า ไป ใน TOC.

## ใช้สวิทช์เพื่อควบคุมพฤติกรรมต่าง ๆ ของเนื้อหา

เหมือนกับสนามอื่น `TOC` สนามสามารถยอมรับการเปลี่ยนแปลงที่นิยามไว้ในรหัสสนาม ที่ควบคุมวิธีการสร้างตารางเนื้อหา การ เปลี่ยน แปลง บาง อย่าง ถูก ใช้ เพื่อ ควบคุม ว่า รายการ ไหน รวม อยู่ ด้วย และ ใน ระดับ ไหน ที่ คน อื่น ใช้ ควบคุม การ ปรากฏ ตัว ของ TOC. สวิทช์สามารถรวมกันเพื่อให้ตารางที่ซับซ้อนของเนื้อหาที่จะผลิต

![ccontrol-table-of-contents-field-aspose-words-java](/words/java/working-with-table-of-contents/how-to-insert-and-work-with-the-table-of-contents-field-2.png)


โดยปริยายแล้ว สวิทช์เหล่านี้จะรวมอยู่ด้วย เมื่อใส่ค่าปริยายเข้าไป `TOC` ในเอกสาร A `TOC` ไม่มีสวิตช์ใด ๆ จะรวมเนื้อหาจากรูปแบบหัวเรื่องที่สร้างขึ้นภายใน (เช่นหากตั้งค่า / O แล้ว)

ที่มีอยู่ `TOC` สลับที่รองรับโดย Aspose.Words มี ราย ชื่อ ข้าง ล่าง นี้ และ มี การ อธิบาย ราย ละเอียด เกี่ยว กับ สิ่ง เหล่า นี้. พวก มัน สามารถ แบ่ง เป็น ส่วน ต่าง ๆ ตาม ชนิด ของ มัน. สวิทช์ในส่วนแรก กําหนดสิ่งที่เนื้อหาจะรวม `TOC` และสวิตช์ในส่วนที่สอง ควบคุมรูปลักษณ์ของ TOC

หากไม่มีรายการสวิตซ์ที่นี่ มันก็จะไม่รองรับ สวิทช์ทั้งหมดจะได้รับการสนับสนุนในรุ่นต่อไป เรากําลังเพิ่มการสนับสนุน ต่อไปยังทุกปล่อย

### สลับการทําเครื่องหมายรายการ

|  สลับ | คําอธิบาย |
|  :-  |  :-  |
| **Heading Styles** <br/> ♪(/ O สลับ) ♪ <br/> | <p>สวิตช์นี้นิยามว่า `TOC` ควรจะสร้างจากรูปแบบหัวพิมพ์ ใน Microsoft Word, 2551) จุดหมายปลายทาง: พ.ศ. 9 ใน Aspose.Words รูป แบบ เหล่า นี้ แสดง ให้ เห็น ด้วย การ ผสม ผสาน รูป แบบ ที่ ตรง กัน. การเผาศพนี้แสดงถึง การระบุความพึ่งพาในท้องถิ่นของสไตล์ เช่น `StyleIdentifier.Heading1` เป็นตัวแทนของรูปแบบ 1 ใช้นี่ เพื่อทําการฟอร์แมตและคุณสมบัติต่าง ๆ ของรูปแบบ จะสามารถดึงข้อมูลได้จากรูปแบบสะสมของเอกสาร สามารถรับคลาสรูปแบบที่สอดคล้องกันได้จาก `Document.Styles` คลังภาพโดยการใช้คุณสมบัติการทําดัชนีของประเภท Schemedentifier</p>

<p>![style-table-of-contents-field-aspose-words-java](/words/java/working-with-table-of-contents/how-to-insert-and-work-with-the-table-of-contents-field-3.png)</p>

<p><br/><br/>เนื้อหา ใด ๆ ที่ มี ลักษณะ เหล่า นี้ รวม อยู่ ใน สารบัญ. ระดับของหัวจะนิยามระดับลําดับชั้นที่สอดคล้องกันของรายการใน TOC ตัวอย่างเช่น วรรคที่มีหัวเรื่อง 1 รูปแบบจะถูกปฏิบัติเป็นระดับแรกใน `TOC` ในขณะที่ วรรคที่ 2 จะทําหน้าที่เป็นระดับถัดไปในลําดับชั้นและอื่น ๆ</p>
 |
| **Outline Levels** <br/> *(/U สวิทช์)* <br/> | <p>แต่ละย่อหน้าสามารถกําหนดระดับกรอบภายใต้ตัวเลือกวรรค</p>

<p>![modify-table-of-contents-field-aspose-words-java](/words/java/working-with-table-of-contents/how-to-insert-and-work-with-the-table-of-contents-field-4.png)</p>

<p><br/><br/>การตั้งค่านี้จะใช้กําหนดระดับที่จะใช้กับย่อหน้านี้ในลําดับชั้นของเอกสาร นี่เป็นแบบฝึกหัดที่ใช้โดยทั่วไปเพื่อทําโครงสร้างผังแป้นพิมพ์ของเอกสาร ลําดับชั้นนี้สามารถมองได้โดยการเปลี่ยนมุมมองแบบกรอบ Microsoft Word. คล้าย กัน กับ รูป แบบ หัว เรื่อง อาจ มี ระดับ 1 – 9 แบบ นอก เหนือ จาก ระดับ "ช่อง เสียง ". ระดับมุม 1 – 9 จะปรากฏใน `TOC` ในระดับที่สอดคล้องกันของลําดับชั้น <br/>เนื้อหาใด ๆ ที่มีระดับกรอบ ถ้าอยู่ในรูปแบบย่อหน้าหรือโดยตรงบน ย่อหน้าตัวเองจะรวมอยู่ใน TOC ใน Aspose.Words ระดับกรอบแสดงโดย `ParagraphFormat.OutlineLevel` ทรัพย์สินของโหนดวรรค ระดับกรอบของรูปแบบย่อหน้าจะแทนในรูปแบบเดียวกันโดย `Style.ParagraphFormat` ทรัพย์สิน</p>

<p>{{% alert color="primary" %}}</p>

<p>หมายเหตุที่รูปแบบหัวเรื่องที่สร้างขึ้น เช่น หัวเรื่อง 1 มีเกณฑ์กําหนดระดับกํากับในรูปแบบ</p>

<p>{{% /alert %}}</p>
 |
| **Custom Styles** <br/> ♪(/ t สลับ) ♪ <br/> | <p>สวิทช์นี้จะอนุญาตให้ใช้รูปแบบที่กําหนดเอง เมื่อมีการเก็บรายการที่จะใช้ใน TOC นี่มักใช้ร่วมกับปุ่ม /O เพื่อรวมรูปแบบที่ตั้งเอง เข้ากับรูปแบบหัวพิมพ์ใน TOC <br/>ส่วน ต่าง ๆ ของ การ เปลี่ยน แปลง ควร ถูก ปิด ไว้ ภาย ใน เครื่องหมาย คํา พูด. คุณสามารถรวมรูปแบบที่กําหนดเองได้หลายรูปแบบ สําหรับแต่ละรูปแบบ ควรกําหนดชื่อตามด้วยเครื่องหมายจุลภาค ตามด้วยระดับที่รูปแบบควรจะปรากฏใน `TOC` อย่าง รูปแบบเพิ่มเติมยังแยกด้วยเครื่องหมายจุลภาคเช่นกัน <br/>ตัวอย่างเช่น</p>

<p>{{< highlight csharp >}}
{ TOC \o "1-3" \t "CustomHeading1, 1,   CustomHeading2, 2"}{{< /highlight >}}</p>

<p>จะใช้เนื้อหาที่มีรูปแบบเป็น hading1 เองเป็นระดับ 1 ในเนื้อหา `TOC` และกําหนด Hading2 เป็นระดับ 2</p>
 |
| ใช้ช่องข้อมูล TC <br/> *(/F และ L สลับกัน)* <br/> | <p>ในรุ่นเก่าของ Microsoft Word, ทางเดียวที่จะสร้าง `TOC` เป็นการใช้ TC สนาม ช่อง เหล่า นี้ จะ ถูก สอด เข้า ไป ใน เอกสาร แม้ เมื่อ มี การ แสดง รหัส สนาม. ข้อความที่ควรจะแสดงในรายการและ `TOC` ถูกสร้างขึ้นจากพวกเขา การใช้งานนี้ในปัจจุบันไม่ได้ใช้บ่อย แต่อาจจะยังมีประโยชน์ในบางโอกาสที่จะรวมค่าใน `TOC` ซึ่งไม่สามารถมองเห็นได้ในเอกสาร <br/>เมื่อใส่ช่องข้อมูลเหล่านี้จะปรากฏซ่อนแม้เมื่อแสดงรหัสสนาม มันไม่สามารถมองเห็นได้โดยไม่แสดงเนื้อหาที่ซ่อนอยู่ หากต้องการดูรายการเหล่านี้ แสดงการฟอร์แมตย่อหน้าจะต้องถูกเลือก</p>

<p>![setup-table-of-contents-field-aspose-words-java](/words/java/working-with-table-of-contents/how-to-insert-and-work-with-the-table-of-contents-field-5.png)</p>

<p>สนามเหล่านี้สามารถใส่ลงในเอกสารที่ ตําแหน่งใด ๆ เช่นสนามอื่น ๆ และแสดงโดย `FieldType.FieldTOCEntry` การเผาศพ<br/>สลับที่ 09 `TOC` ใช้เพื่อกําหนดช่องข้อมูล TC ที่ควรใช้เป็นรายการ สวิตช์ของมันเองโดยไม่ต้องระบุเพิ่มเติมใด ๆ หมายความว่าสนาม TC ใด ๆ ในเอกสารจะรวม พารามิเตอร์อื่น ๆ บ่อยครั้งตัวอักษรเดียว จะระบุว่าเฉพาะ TC สนามที่มีคู่ –f จะรวมอยู่ใน TOC ตัวอย่างเช่น *</p>

<p>{{< highlight csharp >}}
{ TOC \f t }{{< /highlight >}}</p>

<p>จะรวมเฉพาะช่อง TC เช่น</p>

<p>{{< highlight csharp >}}
{ TC \f t }{{< /highlight >}}</p>

<p>เดอะ `TOC` นอก จาก นี้ สนาม ยัง มี การ เปลี่ยน แปลง ที่ เกี่ยว ข้อง กัน ซึ่ง มี การ กําหนด ว่า สนาม TC เท่า นั้น ที่ มี ระดับ ใน ช่วง ที่ กําหนด ไว้ จะ รวม อยู่ ด้วย.</p>

<p>![table-of-contents-field-aspose-words-java](/words/java/working-with-table-of-contents/how-to-insert-and-work-with-the-table-of-contents-field-6.png)</p>

<p><br/><br/>เดอะ `TC` ทุ่งหญ้าเองก็มี `{several, multiple, a few, many, numerous}` สวิทช์ตั้ง นี่คือ:</p>

<p>- เอฟ - อธิบายไว้ข้างบน *</p>

<p>- L – กําหนดระดับ `TOC` TC นี้จะปรากฏใน A `TOC` ซึ่ง ใช้ สลับ เดียว กัน นี้ จะ รวม สนาม ที ซี นี้ ด้วย ถ้า อยู่ ใน ช่วง ที่ กําหนด ไว้.</p>

<p>- แ_ค่ จํานวนหน้าสําหรับสิ่งนี้ `TOC` รายการที่ไม่ได้แสดง โค้ดตัวอย่างของวิธีการแทรกช่อง TC จะพบในส่วนถัดไป</p>
 |

### รูปลักษณ์สลับที่เชื่อมโยง

|  สลับ | คําอธิบาย |
|  :-  |  :-  |
| **Omit Page Numbers** <br/> ♪ (/ N สลับ) ♪ | <p>สวิตต์นี้ใช้ในการซ่อนหมายเลขหน้าสําหรับค่าระดับของ TOC ตัวอย่างเช่น คุณสามารถนิยาม</p>

<p>{{< highlight csharp >}}
{TOC \o "1-4" \n "3-4" }{{< /highlight >}}</p>

<p>และหมายเลขหน้าที่อยู่บนชั้น 3 และ 4 จะถูกซ่อนไว้พร้อมกับจุดนํา (ถ้ามี) เพื่อระบุระยะที่ควรใช้อยู่เพียงระดับเดียว ตัวอย่างเช่น "1-1" จะไม่สามารถแยกหมายเลขหน้าได้เฉพาะระดับแรกเท่านั้น <br/>การใส่ค่าช่วงของระดับจะไม่ลดระยะของหน้าสําหรับทุกระดับใน TOC ใช้สําหรับตั้งค่าการส่งออกเอกสารไปเป็นเอกสาร HTML หรือรูปแบบที่คล้ายกัน นี่ เป็น เพราะ แบบ แปลน แบบ HTML ไม่ มี แนว คิด ใน หน้า ใด ๆ และ ด้วย เหตุ นี้ จึง ไม่ ต้อง ใช้ หมาย เลข หน้า ใด ๆ.</p>

<p>![table-of-contents-aspose-words-java](/words/java/working-with-table-of-contents/how-to-insert-and-work-with-the-table-of-contents-field-7.png)</p>
 |
| แทรกเป็นไฮเปอร์ลิงก์ <br/> ♪(/ H สลับ) ♪ | <p>สวิตช์นี้ระบุ `TOC` รายการจะถูกแทรกเป็นไฮเปอร์ลิงก์ เมื่อมีการดูเอกสาร Microsoft Word รายการเหล่านี้ยังคงปรากฏเป็นข้อความปกติภายใน `TOC` แต่จะถูกเชื่อมโยงแบบไฮเปอร์ไลน์และจึงสามารถใช้เพื่อนําทางไปยังตําแหน่งของรายการต้นฉบับในเอกสารได้ โดยใช้ *Ctrl + คลิกซ้าย* Microsoft Word. เมื่อสวิตช์นี้ถูกรวมเข้ากับลิงก์เหล่านี้ จะถูกเก็บไว้ในรูปแบบอื่น ๆ ตัวอย่างเช่น ในรูปแบบ HTML รวมทั้ง EPUB และแปลงรูปแบบเช่น PDF และ XPS, ต่อไปนี้จะถูกส่งออกเป็นลิงก์ที่ทํางาน <br/>ถ้าไม่มีสวิตช์นี้ `TOC` ในบรรดาผลลัพธ์เหล่านี้ จะถูกส่งออกเป็นข้อความธรรมดาและจะไม่แสดงพฤติกรรมนี้ หากมีเอกสารถูกเปิดใน MS Word ข้อความของรายการจะไม่ถูกคลิกด้วยรูปแบบนี้ แต่หมายเลขหน้ายังคงสามารถใช้นําทางไปยังรายการต้นฉบับได้</p>

<p>![tree-table-of-contents-field-aspose-words-java](/words/java/working-with-table-of-contents/how-to-insert-and-work-with-the-table-of-contents-field-8.png)</p>
 |
| **Set Separator Character** <br/> * (/ P สลับ)* <br/> | <p>สวิตช์นี้ช่วยให้เนื้อหาสามารถแยกชื่อรายการและหมายเลขหน้าได้อย่างง่ายดาย ให้ระบุสัญลักษณ์ที่ใช้แยกส่วน หลังจากเปลี่ยนสวิตช์นี้และแนบไว้ในเครื่องหมายคําพูด <br/>ตรง กัน ข้าม กับ สิ่ง ที่ มี การ บันทึก ไว้ ใน เอกสาร ของ สํานักงาน มี เพียง บุคคล เดียว ที่ สามารถ ใช้ ได้ แทน ที่ จะ ใช้ ถึง ห้า ตัว. นี้ใช้ได้กับทั้งคํา MSS และ Aspose.Words. <br/>ไม่แนะนําให้ใช้สวิตซ์นี้ เนื่องจากมันไม่ช่วยให้ควบคุมสิ่งที่ใช้แยกรายการและหมายเลขเพจใน TOC ได้มากนัก แทน ที่ จะ ทํา เช่น นั้น มี การ แนะ นํา ให้ แก้ไข สิ่ง ที่ เหมาะ สม `TOC` รูปแบบเช่น `StyleIdentifier.TOC1` และจากที่นั่น แก้ไขรูปแบบผู้นํา โดยเข้าถึงสมาชิกแบบอักษรต่าง ๆ เป็นต้น คุณ จะ ตอบ อย่าง ไร?</p>

<p>![list-table-of-contents-field-aspose-words-java](/words/java/working-with-table-of-contents/how-to-insert-and-work-with-the-table-of-contents-field-9.png)</p>
 |
| **Preserve Tab Entries** <br/> ♪(/ W สลับ) ♪ | <p>การใช้สวิทช์นี้ จะระบุว่า รายการใด ๆ ก็ตามที่มีอักขระแท็บ เช่น หัวเรื่องที่มีแท็บ ตอนปลายบรรทัด จะถูกคงไว้เป็นอักขระแท็บที่เหมาะสม เมื่อทําการเรียกแท็บ ซึ่งหมายความว่า ฟังก์ชันของอักขระแท็บจะปรากฏอยู่ใน `TOC` และสามารถใช้เป็นรูปแบบรายการได้ ตัวอย่างเช่น บางรายการอาจจะใช้อักขระแท็บ หยุดและแท็บ เพื่อแยกระยะเยื้องของข้อความ ตราบใดที่มันตรงกัน `TOC` ระดับกําหนดแท็บที่เทียบเท่ากันหยุดแล้วสร้าง `TOC` รายการต่าง ๆ จะปรากฏด้วยช่องว่างที่คล้ายกัน <br/><br/>ในสถานการณ์เดียวกันหากสวิตช์นี้ยังไม่ได้นิยาม แล้วอักขระแท็บจะถูกแปลงเป็นช่องว่างเทียบเท่ากับแท็บที่ไม่ทํางาน จาก นั้น ก็ จะ ไม่ ปรากฏ ผล ตาม ที่ คาด หมาย.</p>

<p>![tab-table-of-contents-field-aspose-words-java](/words/java/working-with-table-of-contents/how-to-insert-and-work-with-the-table-of-contents-field-10.png)</p>
 |
| **Preserve New Line Entries** <br/> *(/ x สลับ)* <br/> | <p>คล้าย กับ สวิตช์ ข้าง บน ปุ่ม นี้ ระบุ ว่า หัว เรื่อง ครอบ คลุม หลาย บรรทัด (ใช้ ตัว อักษร ใหม่, ไม่ แยก วรรค) จะ ถูก เก็บ ไว้ ขณะ ที่ อยู่ ใน TOC ที่ สร้าง ขึ้น. ตัวอย่างเช่น หัวเรื่องที่จะแพร่กระจายไปทั่วหลายบรรทัด สามารถใช้อักขระบรรทัดใหม่ (Ctrl + Enter) หรือ `ControlChar.LineBreak`) เพื่อแยกเนื้อหา ข้ามเส้นต่างๆ ใช้สวิตช์นี้ระบุ, ค่าใน `TOC` จะรักษาอักขระบรรทัดใหม่เหล่านี้ไว้ ดังที่แสดงด้านล่างนี้ <br/><br/>ในกรณีนี้ หากสวิทช์ไม่ได้นิยาม แล้วอักขระบรรทัดใหม่จะถูกแปลงเป็นช่องว่างเดียว</p>

<p>![tab-space-table-of-contents-field-aspose-words-java](/words/java/working-with-table-of-contents/how-to-insert-and-work-with-the-table-of-contents-field-11.png)</p>
 |

## แทรกช่องข้อมูล TC

คุณสามารถแทรกช่อง TC ใหม่ในตําแหน่งปัจจุบันของ `DocumentBuilder` โดยเรียก `DocumentBuilder.InsertField` วิธีการและระบุชื่อสนามเป็น "TC" พร้อมกับสวิทช์ใด ๆ ที่ต้องการ

ตัวอย่างรหัสต่อไปนี้แสดงวิธีการแทรก `TC` ค้นหาในเอกสารโดยใช้ [DocumentBuilder](https://reference.aspose.com/words/java/com.aspose.words/documentbuilder/).

{{< gist "aspose-words-gists" "827e71ccc0b8516a3cfe247b86ce6d4e" "Examples-src-main-java-com-aspose-words-examples-programming_documents-tableofcontents-InsertTCField-InsertTCField.java" >}}

บ่อย ครั้ง มี การ กําหนด บรรทัด เฉพาะ สําหรับ ข้อ ความ `TOC` และถูกทําเครื่องหมายไว้ด้วย `TC` สนาม วิธีทําง่าย ๆ นี้ใน MS Word คือการเน้นข้อความและกดปุ่ม *ALT+HIFT+O*. สิ่งนี้สร้าง `TC` ใช้ช่องข้อความที่เลือกไว้ เทคนิค เดียว กัน นี้ สามารถ ทํา ได้ โดย ใช้ รหัส. รหัสด้านล่างนี้จะค้นหาข้อความที่ตรงกับค่านําเข้าและแทรก `TC` ตรงตําแหน่งเดียวกับข้อความ รหัส อาศัย เทคนิค เดียว กัน ที่ ใช้ ใน บทความ นี้. ตัวอย่างรหัสต่อไปนี้ แสดงให้เห็นว่าจะหาและใส่ `TC` ตรงช่องข้อความในเอกสาร

{{< gist "aspose-words-gists" "827e71ccc0b8516a3cfe247b86ce6d4e" "Examples-src-main-java-com-aspose-words-examples-programming_documents-tableofcontents-FindAndInsertATCField-InsertTCFieldHandler.java" >}}

## แก้ไข สารบัญ

### เปลี่ยนรูปแบบรูปแบบ

รูปแบบของรายการใน `TOC` ไม่ใช้รูปแบบเดิมของรายการที่ทําเครื่องหมายไว้ แต่แต่ละระดับจะฟอร์แมตโดยใช้รูปแบบที่เทียบเท่ากัน `TOC` สไตล์ ยกตัวอย่างเช่น ระดับแรกของ `TOC` เป็นรูปแบบ **TOC1** รูปแบบ, ระดับที่สองจัดรูปแบบด้วย **TOC2** สไตล์และอื่นๆ นี่หมายความว่า เพื่อเปลี่ยนลักษณะของ `TOC` รูปแบบเหล่านี้ต้องถูกแก้ไข ใน Aspose.Words รูปแบบเหล่านี้แสดงโดย การพึ่งพาในท้องถิ่น `StyleIdentifier.TOC1` ผ่านไปยัง `StyleIdentifier.TOC9` และสามารถรับมาจาก `Document.Styles` คลังภาพโดยใช้ตัวระบุเหล่านี้

เมื่อมีการรับรูปแบบที่เหมาะสมของเอกสาร การฟอร์แมตสําหรับรูปแบบนี้ สามารถแก้ไขได้ จะ เห็น การ เปลี่ยน แปลง ใด ๆ ใน รูป แบบ เหล่า นี้ ได้ โดย อัตโนมัติ ใน เอกสาร.

ตัวอย่างรหัสต่อไปนี้เปลี่ยนคุณสมบัติการฟอร์แมตที่ใช้ในระดับแรก `TOC` สไตล์

{{< gist "aspose-words-gists" "827e71ccc0b8516a3cfe247b86ce6d4e" "Examples-src-main-java-com-aspose-words-examples-programming_documents-tableofcontents-ModifyATableOfContents-changeAFormattingPropertyUsedInFirstLevelTOCStyle.java" >}}

เป็น ประโยชน์ เช่น กัน ที่ จะ สังเกต ว่า การ ทํา แบบ วรรค โดย ตรง ใด ๆ (หมาย ถึง ตัว วรรค เอง และ ไม่ ใช่ แบบ นั้น) ที่ ถูก ระบุ ไว้ `TOC` จะถูกคัดลอกไปยังรายการใน TOC ยกตัวอย่างเช่น หากมีการใช้รูปแบบ 1 หัวเรื่อง เพื่อเน้นเนื้อหา `TOC` และสไตล์นี้มีการตกแต่งตัวหนา ในขณะที่วรรคยังมีการตกแต่งแบบตัวเอียงโดยตรง ผล `TOC` รายการที่ป้อนจะไม่หนาเนื่องจากเป็นส่วนหนึ่งของการฟอร์แมตรูปแบบ อย่างไรก็ตามมันจะเป็นตัวเอียง เนื่องจากนี่มีการฟอร์แมตโดยตรงบนย่อหน้า

นอกจากนี้คุณยังสามารถควบคุมการฟอร์แมตของสัญลักษณ์ที่ใช้ ระหว่างแต่ละรายการกับหมายเลขหน้าได้ โดยปริยายแล้ว, นี่เป็นเส้นประที่กระจายไปตามหมายเลขหน้า โดยการใช้อักขระแท็บ และแท็บขวา

ใช้ `Style` ได้มาจากชั้นเรียน `TOC` ระดับที่คุณต้องการแก้ไข นอกจากนี้คุณสามารถแก้ไขวิธีการเหล่านี้ปรากฏในเอกสาร

เพื่อเปลี่ยนสิ่งที่ปรากฏครั้งแรก `Style.ParagraphFormat` ต้องถูกเรียกตัวรับรูปแบบย่อหน้าสําหรับรูปแบบนี้ก่อน จากนี้ จะสามารถรับแท็บได้โดยโทร `ParagraphFormat.TabStops` และแท็บที่เหมาะสมหยุดการแก้ไข การใช้เทคนิคเดียวกันนี้เองแท็บสามารถย้ายหรือเอาออกทั้งหมด

ตัวอย่างรหัสต่อไปนี้แสดงวิธีการแก้ไขตําแหน่งของแท็บด้านขวาหยุดใน `TOC` วรรคที่เกี่ยวข้องกัน

{{< gist "aspose-words-gists" "827e71ccc0b8516a3cfe247b86ce6d4e" "Examples-src-main-java-com-aspose-words-examples-programming_documents-tableofcontents-ModifyATableOfContents-modifyPositionOfRightTabStopInTOC.java" >}}

## ลบ สารบัญออกจากเอกสาร

ตารางเนื้อหาสามารถลบออกจากเอกสารได้ โดยการลบโหนดทั้งหมดที่พบระหว่างเอกสาร `FieldStart` และโหนดสนามของ `TOC` สนาม

รหัสข้างล่างแสดงให้เห็นสิ่งนี้ การกําจัด `TOC` ทุ่ง นา ง่าย กว่า สนาม ธรรมดา เนื่อง จาก เรา ไม่ ได้ เฝ้า ดู ทุ่ง นา ที่ มี รัง. แทนที่เราจะตรวจสอบ `FieldEnd` โหนดเป็นประเภท `FieldType.FieldTOC` ซึ่งหมายความว่าเราได้พบจุดจบของ TOC ในปัจจุบัน เทคนิค นี้ สามารถ ใช้ ได้ ใน กรณี นี้ โดย ไม่ กังวล เกี่ยว กับ ทุ่ง นา ที่ มี รัง เป็น อย่าง ที่ เรา อาจ สันนิษฐาน ได้ ว่า เอกสาร ใด ๆ ที่ ตั้ง ขึ้น อย่าง ถูก ต้อง จะ ไม่ มี รัง อย่าง เต็ม ที่ `TOC` # ในสนามอื่น `TOC` สนาม

อย่างแรก `FieldStart` โหนดของแต่ละตัว `TOC` ถูกเก็บและเก็บไว้ ที่ระบุ `TOC` แล้ว ก็ มี การ ระบุ ไว้ ว่า ทุก ปม ใน สนาม จะ ถูก เก็บ ไว้. จากนั้นโหนดจะถูกเอาออกจากเอกสาร ตัวอย่างรหัสต่อไปนี้แสดงถึงวิธีเอารายการที่ระบุไว้ `TOC` จากเอกสาร

{{< gist "aspose-words-gists" "827e71ccc0b8516a3cfe247b86ce6d4e" "Examples-src-main-java-com-aspose-words-examples-programming_documents-tableofcontents-RemoveATableOfContents-RemoveATableOfContents.java" >}}

## สารบัญ

หากคุณต้องการดึงเนื้อหาออกจากเอกสารคําใด ๆ ก็สามารถใช้ตัวอย่างโค้ดต่อไปนี้ได้

{{< gist "aspose-words-gists" "827e71ccc0b8516a3cfe247b86ce6d4e" "Examples-src-main-java-com-aspose-words-examples-programming_documents-tableofcontents-ExtractTableOfContents-ExtractTableOfContents.java" >}}
