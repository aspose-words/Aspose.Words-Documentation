---
title: ตรวจหารูปแบบแฟ้ม
second_title: Aspose.Words สําหรับ Java
articleTitle: ตรวจสอบรูปแบบแฟ้มและตรวจสอบความเข้ากันได้ของรูปแบบ
linktitle: ตรวจสอบรูปแบบแฟ้มและตรวจสอบความเข้ากันได้ของรูปแบบ
description: "เก็บข้อมูลเกี่ยวกับรูปแบบของเอกสารก่อนที่จะเปิดมันเพื่อหลีกเลี่ยงการยกเว้น หากคุณไม่แน่ใจว่า เนื้อหาของเอกสารที่ใช้อยู่คืออะไร Java."
type: docs
weight: 20
url: /th/java/detect-file-format-and-check-format-compatibility/
---

บางครั้งจําเป็นในการกําหนดรูปแบบของเอกสาร ก่อนที่จะเปิดเพราะว่านามสกุลของแฟ้มไม่รับประกันว่า เนื้อหาของแฟ้มนั้นเหมาะสมหรือไม่ ตัว อย่าง เช่น เป็น ที่ รู้ กัน ว่า วารสาร คริสตัล รีพอร์ต มัก จะ ส่ง เอกสาร ออก ใน รูป แบบ อาร์ ที เอฟ แต่ ให้ ข้อมูล ต่อ ไป นี้.

Aspose.Words ให้ ความ สามารถ ใน การ ได้ ข้อมูล เกี่ยว กับ ชนิดแฟ้ม เพื่อ หลีก เลี่ยง การ ยก เว้น หาก คุณ ไม่ แน่ ใจ ว่า เนื้อหา แท้ ของ แฟ้ม คือ อะไร.

## ตรวจหารูปแบบแฟ้มโดยไม่มีข้อยกเว้น

เมื่อคุณกําลังจัดการกับเอกสารหลาย ๆ เอกสารในรูปแบบแฟ้มต่าง ๆ คุณอาจต้องแยกแฟ้มที่ประมวลผลได้ออกไป Aspose.Words จากผู้ที่ไม่สามารถ คุณ อาจ ต้องการ ทราบ ด้วย ว่า ทําไม เอกสาร บาง ฉบับ จึง ไม่ สามารถ ดําเนิน การ ได้.

หากคุณพยายามโหลดแฟ้มเข้า [Document](https://reference.aspose.com/words/java/com.aspose.words/document/) วัตถุ Aspose.Words ไม่สามารถจัดการรูปแบบแฟ้มหรือฟอร์แมตนี้ได้ Aspose.Words จะโยนข้อยกเว้น คุณสามารถจับข้อยกเว้นเหล่านั้นและวิเคราะห์พวกเขา แต่ Aspose.Words ยังให้ [DetectFileFormat](https://reference.aspose.com/words/java/com.aspose.words/fileformatutil/#detectFileFormat-java.lang.String) วิธีการที่ทําให้เราสามารถกําหนดฟอร์แมตแฟ้มได้อย่างรวดเร็ว โดยไม่ต้องทําการโหลดเอกสารที่มีข้อยกเว้นที่เป็นไปได้ วิธีการนี้จะคืนค่ากลับมาเป็น [FileFormatInfo](https://reference.aspose.com/words/java/com.aspose.words/fileformatinfo/) วัตถุที่บรรจุข้อมูลที่ตรวจพบเกี่ยวกับประเภทแฟ้มนี้

{{% alert color="primary" %}}

ตรวจหาแฟ้ม ฟอร์แมตเฉพาะการตรวจสอบรูปแบบแฟ้มเท่านั้น แต่ไม่ได้ตรวจสอบรูปแบบของแฟ้ม ไม่มีการรับประกันว่าแฟ้มที่จะเปิดได้สําเร็จ **DetectFileFormat** HOURSฟังก์ชัน () จะคืนค่ากลับมาเป็นชั่วโมงของค่าเวลาที่กําหนด มันเป็นเพราะ **DetectFileFormat** วิธีการอ่านข้อมูลรูปแบบแฟ้มบางส่วนเท่านั้น ซึ่งเพียงพอต่อการตรวจสอบฟอร์แมตแฟ้ม แต่ไม่เพียงพอสําหรับความถูกต้องที่สมบูรณ์

{{% /alert %}}

## ตรวจสอบความเข้ากันได้ของรูปแบบแฟ้ม

เราสามารถตรวจสอบรูปแบบความเข้ากันได้ของแฟ้มทั้งหมดในโฟลเดอร์ที่เลือก และเรียงลําดับมันโดยใช้รูปแบบเป็นโฟลเดอร์ย่อยที่สอดคล้องกัน

เนื่องจากเรากําลังจัดการกับเนื้อหาในโฟลเดอร์ สิ่งแรกที่เราต้องทําคือ การรวบรวมแฟ้มทั้งหมดในแฟ้มนี้โดยใช้ **GetFiles** วิธีการ `Directory` คลาส (จาก `System.IO` ชื่อแฟ้ม).

ตัวอย่างรหัสต่อไปนี้ จะแสดงวิธีรับรายการของแฟ้มทั้งหมดในโฟลเดอร์:

{{< gist "aspose-words-gists" "827e71ccc0b8516a3cfe247b86ce6d4e" "Examples-src-main-java-com-aspose-words-examples-loading_saving-CheckFormatCompatibility-GetListOfFilesInFolder.java" >}}

เมื่อเก็บแฟ้มทั้งหมด ส่วนที่เหลือของงานจะดําเนินการโดย **DetectFileFormat** วิธีการตรวจสอบฟอร์แมตของแฟ้ม

ตัวอย่างรหัสต่อไปนี้ จะแสดงวิธีการทําการทําซ้ําเหนือรายการของแฟ้มที่เก็บมา ตรวจดูรูปแบบของแต่ละแฟ้ม และย้ายแต่ละแฟ้มไปยังโฟลเดอร์ที่เหมาะสม:

{{< gist "aspose-words-gists" "827e71ccc0b8516a3cfe247b86ce6d4e" "Examples-src-main-java-com-aspose-words-examples-loading_saving-CheckFormatCompatibility-CheckFormatCompatibility.java" >}}

แฟ้มจะถูกย้ายไปยังโฟลเดอร์ย่อยที่เหมาะสมโดยใช้ `Move` วิธีการ `File` รุ่นเดียวกัน `System.IO` ชื่อสถานที่

แฟ้มต่อไปนี้จะถูกใช้ในตัวอย่างทางด้านบน ชื่อแฟ้มอยู่ด้านซ้าย และคําอธิบายอยู่ทางด้านขวา:

| Group แฟ้ม | เอกสารนําเข้า | ชนิด |
|  :-  |  :-  |  :-  |
| รูปแบบแฟ้มที่รองรับ | แฟ้มทดสอบ ( doc). doc | Microsoft Word 95/6.0 หรือ Microsoft Word 97 – 2003 เอกสาร. |
|  | แฟ้มทดสอบ (ดอต). dot | Microsoft Word 95/6.0 หรือ Microsoft Word 97 – 2003 ต้นแบบ. |
|  | แฟ้มทดสอบ ( docx). docx | การประมวลผลคํา XML ในสํานักงาน เอกสาร ML ไม่มีเมกะทรอน |
|  | แฟ้มทดสอบ ( docm). docm | การประมวลผลคํา XML ในสํานักงาน เอกสาร ML กับแมโคร |
|  | แฟ้มทดสอบ (Dotx). dotx | การประมวลผลคํา XML ในสํานักงาน แม่แบบ ML |
|  | แฟ้มทดสอบ (Dotm). dotm | การประมวลผลคํา XML ในสํานักงาน แม่แบบ ML กับแมโคร |
|  | แฟ้มทดสอบ (XML). xml | BlatOPC เอกสาร OOXML |
|  | แฟ้มทดสอบ (RTF). rf | เอกสารรูปแบบข้อความแบบสมบูรณ์ |
|  | แฟ้มทดสอบ (WordML). xml | Microsoft Word 2003 การประมวลผลคํา เอกสาร ML |
|  | แฟ้มทดสอบ (HTML). html | เอกสาร HTML |
|  | แฟ้มทดสอบ (MHTML).html | เอกสารของ MHTML (แฟ้มจัดเก็บหน้าเว็บ) |
|  | แฟ้มทดสอบ (ตรงข้าม). odt | ข้อความ OpenDocument (Office Award). |
|  | แฟ้มทดสอบ (Ot). ott | ต้นแบบเอกสาร OpenDocument |
|  | แฟ้มทดสอบ (DocPreWord60). doc | Microsoft Word เอกสาร 2.0 |
| เอกสารที่ถูกเข้ารหัสไว้ | แฟ้มทดสอบ (Enc). doc | เข้ารหัสแล้ว Microsoft Word 95/6.0 หรือ Microsoft Word 97 – 2003 เอกสาร. |
|  | แฟ้มทดสอบ (Enc). docx | การประมวลผลคําแบบ XML ที่ถูกเข้ารหัสไว้ เอกสาร ML |
| รูปแบบของแฟ้มที่ไม่รองรับ | แฟ้มทดสอบ (JPG). แบบ Jpg | แฟ้มอิมเมจ JPEG |

