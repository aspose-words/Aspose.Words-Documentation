---
title: ทํา งาน ต่อ ไป กับ เอกสาร ใน ฐานข้อมูล
second_title: Aspose.Words สําหรับ Java
articleTitle: ทํา งาน ต่อ ไป กับ เอกสาร ใน ฐานข้อมูล
linktitle: ทํา งาน ต่อ ไป กับ เอกสาร ใน ฐานข้อมูล
description: "แปลงเอกสารเป็นอาร์เรย์ไบต์สําหรับการทํางานร่วมกับเอกสารนี้ในฐานข้อมูล คุณสามารถจัดเก็บและรับเอกสารจากฐานข้อมูลได้ Java."
type: docs
weight: 40
url: /th/java/serialize-and-work-with-a-document-in-a-database/
timestamp: 2024-01-27-14-07-04
---

งาน อย่าง หนึ่ง ที่ คุณ อาจ ต้อง ทํา ให้ เสร็จ เมื่อ ทํา งาน กับ เอกสาร ต่าง ๆ คือ เก็บ และ เก็บ เกี่ยว **Document** วัตถุถึงและจากฐานข้อมูล ตัว อย่าง เช่น คง จําเป็น ต้อง ทํา เช่น นั้น หาก คุณ กําลัง ใช้ ระบบ จัด การ เรื่อง เนื้อหา ทุก รูป แบบ. เอกสารต่าง ๆ ที่แล้วทั้งหมด จะต้องถูกเก็บไว้ในระบบฐานข้อมูล ความสามารถในการจัดเก็บเอกสารไว้ในฐานข้อมูล ยังมีประโยชน์อย่างมากเมื่อโปรแกรมของคุณให้บริการทางเว็บ

Aspose.Words ให้ความสามารถในการแปลงเอกสารเป็นอาร์เรย์แบบไบต์ สําหรับการทํางานภายหลังกับเอกสารนี้ในฐานข้อมูล

## แปลงเอกสารเป็นไบต์

เพื่อ จะ เก็บ เอกสาร ไว้ ใน ฐานข้อมูล หรือ เพื่อ เตรียม เอกสาร สําหรับ การ ถ่ายทอด ทาง อินเทอร์เน็ต บ่อย ครั้ง จําเป็น ต้อง ทํา การ บันทึก เอกสาร ต่อ เนื่อง เพื่อ จะ ได้ อาร์เรย์ แบบ ไบต์.

เพื่อสร้างลําดับ [Document](https://reference.aspose.com/words/java/com.aspose.words/document/) วัตถุใน Aspose.Words

1 เก็บไว้ให้ **MemoryStream** ใช้ [Save](https://reference.aspose.com/words/java/com.aspose.words/document/#save-java.io.OutputStream-int) เกินขนาดวิธีการ **Document** ชั้นเรียน.
1 เรียก **ToArray** วิธีการในการส่งค่ากลับมาเป็นลําดับของค่าไบต์

ขั้น ตอน ต่าง ๆ ข้าง บน จะ กลับ ไป อีก ได้ เพื่อ บรรจุ น้ํา ลง ใน น้ํา **Document** วัตถุ

{{% alert color="primary" %}}

รูปแบบการบันทึกที่เลือกมีความสําคัญเพื่อให้แน่ใจว่ามีการคงความถูกต้องสูงสุด เมื่อมีการบันทึกและโหลดใหม่อีกครั้ง **Document** วัตถุ ด้วยเหตุผลนี้ จึงแนะนําให้ใช้รูปแบบแฟ้ม OXML ชุดหนึ่ง

{{% /alert %}}

ตัวอย่างด้านล่างนี้แสดงวิธีการต่อเนื่อง **Document** วัตถุประสงค์ที่จะได้รับอาร์เรย์ไบต์แล้ววิธีการ unserution ข้อมูล byte ที่จะได้รับ **Document** วัตถุอีกครั้ง:

{{< gist "aspose-words-gists" "827e71ccc0b8516a3cfe247b86ce6d4e" "Examples-src-main-java-com-aspose-words-examples-loading_saving-ConvertDocumentToByte-ConvertDocumentToByte.java" >}}

{{% alert color="primary" %}}

คุณสามารถดาวน์โหลดแฟ้มต้นแบบของตัวอย่างนี้ได้ [Aspose.Words GitHub](https://github.com/aspose-words/Aspose.Words-for-Java/blob/master/Examples/Data/Document.doc).

{{% /alert %}}

## จัดเก็บ, อ่านและลบเอกสารในฐานข้อมูล

ส่วนนี้แสดงวิธีบันทึกเอกสารในฐานข้อมูล แล้วโหลดกลับไปที่ `Document` วัตถุสําหรับทํางานกับมัน เพื่อความง่าย ชื่อแฟ้มคือกุญแจที่ใช้เก็บและเรียกเอกสารจากฐานข้อมูล ฐานข้อมูลมีสองคอลัมน์ คอลัมน์แรก "แฟ้ม" จะถูกจัดเก็บในรูปแบบสตริง และใช้สําหรับระบุเอกสาร คอลัมน์ที่สอง "ตําแหน่งแฟ้ม" จะถูกเก็บไว้เป็น `BLOB` วัตถุที่จัดเก็บวัตถุของเอกสารในรูปแบบไบต์

ตัวอย่างรหัสต่อไปนี้ จะแสดงวิธีตั้งค่าการเชื่อมต่อฐานข้อมูลและประมวลผลคําสั่ง:

{{< gist "aspose-words-gists" "827e71ccc0b8516a3cfe247b86ce6d4e" "Examples-src-main-java-com-aspose-words-examples-loading_saving-LoadAndSaveFromDatabase-OpenDatabaseConnection.java" >}}

{{% alert color="primary" %}}

ในตัวอย่างนี้ เราใช้ฐานข้อมูล MySQL Aspose.Words เอกสาร

{{% /alert %}}

ตัวอย่างโค้ดต่อไปนี้ จะแสดงวิธีการบันทึกเอกสารไปยังฐานข้อมูล จากนั้นอ่านเอกสารเดิมอีกครั้ง และในที่สุดก็ลบบันทึกที่มีเอกสารอยู่ในฐานข้อมูล:

{{< gist "aspose-words-gists" "827e71ccc0b8516a3cfe247b86ce6d4e" "Examples-src-main-java-com-aspose-words-examples-loading_saving-LoadAndSaveFromDatabase-OpenRetrieveAndDelete.java" >}}

### บันทึกเอกสารเป็นฐานข้อมูล

เพื่อบันทึกเอกสารในฐานข้อมูลแปลงเอกสารนี้ เป็นแฟ้มแบบชุดไบต์ ดัง พรรณนาไว้ตอนต้นของบทความนี้ จากนั้น เก็บข้อมูลนี้ไว้ในฐานข้อมูล

ตัวอย่างรหัสต่อไปนี้ จะแสดงวิธีการบันทึกเอกสารไปยังฐานข้อมูลที่ระบุ:

{{< gist "aspose-words-gists" "827e71ccc0b8516a3cfe247b86ce6d4e" "Examples-src-main-java-com-aspose-words-examples-loading_saving-LoadAndSaveFromDatabase-StoreToDatabase.java" >}}

ระบุคําสั่ง string ซึ่งเป็นการแสดงออกแบบ SQL ที่ทํางานทั้งหมด:

- เพื่อบันทึกเอกสารไว้ในฐานข้อมูล มีการใช้คําสั่ง "ภายใน" และใช้ตารางที่ระบุร่วมกับค่าของสนามบันทึกเสียง 2 แห่ง - แฟ้ม และส่วนเชื่อมโยงของแฟ้ม เพื่อหลีกเลี่ยงพารามิเตอร์เพิ่มเติม ชื่อแฟ้มจะถูกเอามาจาก **Document** วัตถุเอง เดอะ `FileContent` ค่าในช่องข้อมูลจะถูกกําหนดเป็นไบต์จากแหล่งหน่วยความจํา ซึ่งบรรจุการแสดงเอกสารที่ถูกจัดเก็บเป็นฐานสอง
- บรรทัดที่เหลือของรหัสดําเนินการคําสั่งที่เก็บ Aspose.Words เอกสารในฐานข้อมูล

### เรียกเอกสารจากฐานข้อมูล

เพื่อรับเอกสารจากฐานข้อมูล ให้เลือกบันทึกที่มีเอกสารเป็นลําดับของไบต์ แล้วใส่ลําดับ ไบต์จากบันทึกเป็น **MemoryStream** และสร้าง **Document** วัตถุที่จะโหลดเอกสารจาก **MemoryStream**.

ตัวอย่างรหัสต่อไปนี้ จะแสดงวิธีการรับและคืนเอกสารจากฐานข้อมูลที่ระบุ โดยใช้ชื่อแฟ้มเป็นกุญแจในการดึงเอกสารนี้:

{{< gist "aspose-words-gists" "827e71ccc0b8516a3cfe247b86ce6d4e" "Examples-src-main-java-com-aspose-words-examples-loading_saving-LoadAndSaveFromDatabase-ReadFromDatabase.java" >}}

{{% alert color="primary" %}}

คําสั่ง SQL "SELECT * จาก)" ใช้เพื่อดึงข้อมูลบันทึกที่เหมาะสม โดยใช้ตามชื่อแฟ้ม

{{% /alert %}}

### ลบเอกสารออกจากฐานข้อมูล

เพื่อลบเอกสารจากฐานข้อมูล ให้ใช้คําสั่ง SQL ที่เหมาะสม โดยไม่ต้องปรับแต่ง **Document** วัตถุ

ตัวอย่างรหัสต่อไปนี้ จะแสดงวิธีลบเอกสารจากฐานข้อมูล โดยใช้ชื่อแฟ้มเพื่อดึงข้อมูล:

{{< gist "aspose-words-gists" "827e71ccc0b8516a3cfe247b86ce6d4e" "Examples-src-main-java-com-aspose-words-examples-loading_saving-LoadAndSaveFromDatabase-DeleteFromDatabase.java" >}}
