---
title: การจัดการเมตาไฟล์WindowsในC++
second_title: Aspose.WordsสำหรับC++
articleTitle: การจัดการเมตาไฟล์Windows
linktitle: การจัดการเมตาไฟล์Windows
description: "Aspose.WordsสำหรับC++ นินการของตัวเองWindowsผู้เล่นเมตาไฟล์ในการเล่นรูปแบบเมตาไฟล์บนแพลตฟอร์มทั้งหมดและสนั."
type: docs
weight: 30
url: /th/cpp/handling-windows-metafiles/
timestamp: 2024-01-30-16-22-34
---

Windowsรูปแบบเมตาไฟล์เป็นรูปแบบไฟล์ภาพที่สามารถประกอบด้วยกราฟิกแบบเวกเตอร์และแรสเ รูปแบบนี้ใช้ในการจัดเก็บข้อมูลกราฟิกในหน่วยความจำหรือแฟ้มบนดิสก์ รเรียกฟังก์ชันในอินเทอร์เฟซอุปกรณ์กราฟิกWindows(GDI)ที่ต้องดำเนินการเพื่อแสดงรูปภาพบนหน้าจอ ระบบตีความและรันคำสั่งเหล่านี้ในบริบทการแสดงผล.

เดิมWindowsเมตาไฟล์เป็นรูปแบบภาพเวกเตอร์เดียวที่รองรับโดยMicrosoft Word Microsoft Wordตอนนี้ยังสนับสนุนSVGรูปแบบ,แต่รูปแบบเมไฟล์ยังคงเป็นที่นิยมใช้ในเอกสารคำ. การแลกเปลี่ยนสำหรับโปรแกรมอื่นๆบางอย่างเช่นMicrosoftวิสัยทัศน์ การแลกเปลี่ยนข้อมูลแบบกราฟิกระหว่างการใช้งานWindows.

มีเวอร์ชัน3ของWindows:

- WMF-ร้านค้าโทรไป 16 บิตGDI.
- EMF-ร้านค้าโทรไปที่วิน32/GDI.
- EMF+ร้านค้าเมตาไฟล์โทรไปที่GDI+. EMF+เมตาไฟล์อาจเป็นแบบคู่,อธิบายกราฟิกเดียวกันกับทั้งEMFและEMF+ชิ้นส่วน.

ปัญหาที่มีอยู่กับWindowsเมตาไฟล์คือว่ามันไม่ได้รับการสนับสนุนโดยรูปแบบที่ไม่ใช่คำส่วนใหญ่ซึ่งเ นั้นจึงจำเป็นต้องแปลงรูปแบบเมไฟล์ในรูปแบบแรสเตอร์หรือเวกเตอร์อื่นๆ มันเป็นเรื่องง่ายที่จะแปลงWindowsเมตาไฟล์เป็นภาพแรสเตอร์บน.NETโดยเพียงแค่ผ่านมันไปGDI+แต่มันเป็นไปไม่ได้บนแพลตฟอร์มอื่นๆตั้งแต่แม้แต่GDI+ไม่ได้ให้ฟังก์ชั่นเพื่อดึงกราฟิกแบบเวกเตอร์จากเมตาไฟล์ เพื่อแก้ปัญหาเหล่านี้Aspose.Wordsใช้โปรแกรมเล่นเมตาไฟล์ของตัวเองWindowsซึ่งสามารถเล่นรูปแบบเมตาไฟล์ทั้งแบบเวกเตอร์และกราฟิกแรสเตอร์บนแพลตฟอร์มทั้งหมด.

## การควบคุมโปรแกรมเล่นเมตาไฟล์Aspose.Words

[MetafileRenderingOptions](https://reference.aspose.com/words/cpp/aspose.words.saving/metafilerenderingoptions/)ชั้นช่วยให้คุณสามารถควบคุมเครื่องเล่นเมตาไฟล์. ใช้คุณสมบัติ[RenderingMode](https://reference.aspose.com/words/cpp/aspose.words.saving/metafilerenderingoptions/get_renderingmode/)ซึ่งมีความหมายพิเศษเมื่อแปลงเป็นบิตแมป(ดูคุณสมบัติของ[MetafileRenderingOptions](https://reference.aspose.com/words/cpp/aspose.words.saving/metafilerenderingoptions/metafilerenderingoptions/)ด้วย).

การบันทึกเป็นบิตแม็พทำงานต่างกันบนแพลตฟอร์มอื่นที่ไม่ใช่.NET ในขณะที่.NETGDI+การแสดงผลเป็นข้อมูลอ้างอิงที่ทำงานได้เกือบสมบูรณ์แม้สำหรับรูปแบบเมไฟล์ที่ซับซ้อนที่สุดบนแพลตฟอร์มอื่นๆมันอาจทำให้เกิดปัญหาหรือไม่ได้รับการสนับสนุนเลย.

## สนับสนุนการดำเนินงานแรสเตอร์

การดำเนินงานแรสเตอร์เป็นคุณลักษณะเมตาแฟ้มที่ซับซ้อนซึ่งขณะนี้มีการสนับสนุนที่จำกัด การดำเนินงานของแรสเตอร์มีอยู่ในรูปแบบเมตาแฟ้มWMFและEMF รูปแบบเมตาไฟล์EMF+ไม่ได้ใช้การดำเนินการแรสเตอร์โดยตรงแต่สามารถประกอบด้วยEMFชิ้นส่วนฝังWMFหรือEMFเมตาไฟล์.

มีการดำเนินการแรสเตอร์ไบนารีและไบนารี:

- การดำเนินการแรสเตอร์ไบนารีจะนำไปใช้กับคำสั่งวาดปากกาเช่นวาดเส้นและเส้นโค้ง เมื่อวาดเส้นสีปากกาจะรวมกับสีบิตแมปปลายทาง(สีของพิกเซลที่สอดคล้องกันบนพื้นผิวของอุ ตัวอย่างภาพด้านล่างแสดงให้เห็นถึงผลของการดำเนินงานแรสเตอร์ไบนารีทั้งหมด 16 นำไปใช้กับแถบสีที่แตกต่างกัน 20 แถบ แถบสีแนวตั้งจะวาดก่อนแถบแนวนอนจะวาดหลังจากแต่ละการดำเนินการแรสเตอร์ไบน สำหรับกรณีง่ายๆR2_BLACKวาดสีดำ,R2_NOTจะผกผันสี,R2_NOPจะไม่เปลี่ยนพื้นหลัง,และR2_WHITEวาดสีขาว.

<img src="handling-windows-metafiles-1.png" alt="handling-windows-metafiles-aspose-words-cpp-1" style="width:650px"/>

- ใช้เมื่อวาดภาพบิตแมป บิตแมปที่สอดคล้องกันพิกเซล,แปรง,และบิตแมปปลายทางโดยใช้การดำเนินงานแบบตรรกะบิ หนึ่งในวัตถุประสงค์ที่พบบ่อยที่สุดของการใช้การดำเนินการแรสเตอร์สามัญคือการจำลอง ภาพที่แสดงในตัวอย่างด้านล่างแสดงให้เห็นถึงวิธีที่ไอคอนโปร่งใสสามารถเทิดทูน มีสองประเภทของบิตแม็พ:บิตแม็พหน้ากากบี/ดับเบิลยูและบิตแม็พสี ขั้นแรกบิตแมปหน้ากากถูกวาดด้วยการดำเนินการแรสเตอร์SRCAND ไอคอนแพ็ครอบด้วยอายแชโดว์สีเข้มยาวที่แข็งแกร่งที่หลบภัยเป็นสิ่งที่แตกต่าง จากนั้นบิตแมปที่สองจะถูกวาดด้วยการดำเนินการแรสเตอร์SRCINVERT แสดงพิกเซลสีบนขอบเขตสีดำทำให้พื้นที่โปร่งใสไม่เปลี่ยนแปลง.

<img src="handling-windows-metafiles-2.png" alt="handling-windows-metafiles-aspose-words-cpp-2" style="width:650px"/>

การดำเนินการแรสเตอร์ไม่สามารถแปลงเป็นกราฟิกแบบเวกเตอร์โดยตรง Aspose.Wordsเลียนแบบการดำเนินงานของแรสเตอร์โดยการแรสเตอร์บางส่วนพื้นผิวอุปกรณ์ที่ได้รับผล เพื่อจุดประสงค์นี้ใช้คุณสมบัติ[EmulateRasterOperations](https://reference.aspose.com/words/cpp/aspose.words.saving/metafilerenderingoptions/get_emulaterasteroperations/).

{{% alert color="primary" %}}

ในขณะที่การดำเนินงานของแรสเตอร์ไบนารีไม่ได้รับการสนับสนุนในปัจจุบันและจำนวนที่จำกัดของการดำเนินงานแรสเตอร์สามัญได้รับการสนับสนุนโดยAspose.Words,มันสามารถจัดการกับกรณีพื้นฐานของการแปลงเป็นกราฟิกแบบเวกเตอร์โดยตรง,ตัวอย่างเช่น, R2_BLACK, R2_WHITE, R2_NOP. งยิ่งเมื่อจำนวนอย่างมีนัยสำคัญของการบันทึกการดำเนินงานแรสเตอร์ที่มีส่วนเกี่ยวข้อง.

{{% /alert %}}

ตัวอย่างที่แสดงด้านล่างแสดงให้เห็นว่าAspose.Wordsแสดงเมตาไฟล์เป็นบิตแมปเมื่อไม่สามารถแสดงผล:

{{< gist "aspose-words-gists" "d55d8631947d283b1f0da99afa06c492" "cpp-Loading-and-Saving-Doc2Pdf-RenderMetafileToBitmap.cpp" >}}

## การตั้งค่าทางเลือก

Aspose.Wordsไม่สนับสนุนจำนวนของคุณสมบัติเมไฟล์ที่มีความซับซ้อนมากที่สุดหรือหายาก ผู้ใช้สามารถใช้อินเตอร์เฟซ[IWarningCallBack](https://reference.aspose.com/words/cpp/aspose.words/iwarningcallback/)และรับข้อความเตือน ถ้าAspose.Wordsพบคุณลักษณะที่ไม่สนับสนุนในเมตาไฟล์ระบบจะส่งข้อความเตือนด้วย[WarningSource](https://reference.aspose.com/words/cpp/aspose.words/warninginfo/get_source/)**Metafile**. ในกรณีนี้Aspose.Wordsอาจดำเนินการสำรองไปยังประเภทที่แตกต่างกันของผู้เล่นไฟล์. ข้อความเตือนเกี่ยวกับทางเลือกที่จะออกยัง.

ประการแรก Aspose.Words จะดำเนินการย้อนกลับจากโปรแกรมเล่นเมตาไฟล์เวกเตอร์ไปเป็นแรสเตอร์ ซึ่งควบคุมโดยคุณสมบัติ [RenderingMode](https://reference.aspose.com/words/cpp/aspose.words.saving/metafilerenderingoptions/get_renderingmode/) หากปิดใช้งานคุณสมบัติย้อนกลับ Aspose.Words จะพยายามเรนเดอร์กราฟิกทดแทนบางส่วนแทนคุณสมบัติที่ไม่ได้รับการสนับสนุน.

Aspose.Wordsเล่นแฟ้มเมตาแฟ้มกับแรสเตอร์ได้สำเร็จโดยใช้GDI+บน.NETซึ่งทำให้ตัวเลือกการโทรกลับนี้ปลอดภัย.

ประการที่สอง,มีตัวเลือกสำหรับEMF+คู่เมไฟล์ที่จะสำรองจากการเล่นส่วนEMF+ไปยังส่วนEMF. มันถูกควบคุมโดย[EmfPlusDualRenderingMode](https://reference.aspose.com/words/cpp/aspose.words.saving/metafilerenderingoptions/get_emfplusdualrenderingmode/) หากมีปัญหาบางอย่างเกิดขึ้นเมื่อเล่นส่วนEMFแล้วทางเลือกที่จะแรสเตอร์อาจจะดำเนินการเ.

สำหรับการดำเนินการแรสเตอร์ หาก [EmulateRasterOperations](https://reference.aspose.com/words/cpp/aspose.words.saving/metafilerenderingoptions/get_emulaterasteroperations/) ถูกปิดใช้งาน การดำเนินการแรสเตอร์จะถือว่าไม่ได้รับการสนับสนุน ซึ่งจะทริกเกอร์การย้อนกลับไปยังตัวเล่นเมตาไฟล์บิตแมปหากเปิดใช้งาน ดังนั้น หากคุณมีเมตาไฟล์ที่มีการดำเนินการแรสเตอร์ แต่คุณไม่ต้องการใช้การจำลองการดำเนินการแรสเตอร์และยังต้องการรับเอาต์พุตเวกเตอร์พร้อมกราฟิกที่แทนที่ ให้เลือก [MetafileRenderingMode](https://reference.aspose.com/words/cpp/aspose.words.saving/metafilerenderingoptions/get_renderingmode/).**Vector**.
