---
title: ทำความสะอาดก่อนหรือระหว่าง Mail Merge การดำเนินงาน
second_title: Aspose.Words สำหรับ C++
articleTitle: ทำความสะอาดก่อนหรือระหว่าง Mail Merge การดำเนินงาน
linktitle: ทำความสะอาดก่อนหรือระหว่าง Mail Merge การดำเนินงาน
type: docs
description: "ใช้การทำความสะอาดที่แตกต่างกันและการลบตัวเลือกเช่นการลบเขตข้อมูลผสานก่อนที่จ mail merge การดำเนินการหรือการลบพื้นที่ที่ไม่ได้ใช้ในระหว่าง mail merge การดำเนินงาน."
keywords: "cleanup options mail merge c#"
weight: 10
url: /th/cpp/clean-up-before-or-during-mail-merge/
timestamp: 2024-01-27-14-07-04
---

Aspose.Words ช่วยให้คุณสามารถใช้การทำความสะอาดที่แตกต่างกันและการลบตัวเลือกเช่นการลบเขตข้ mail merge การดำเนินการหรือการลบพื้นที่ที่ไม่ได้ใช้ในระหว่าง mail merge การดำเนินงาน ส่วนนี้จะอธิบายวิธีการลบฟิลด์ที่รวมและวิธีการตั้งค่าตัวเลือกการเอาออก.

## ลบเขตข้อมูลที่ผสาน

เมื่อคุณใช้เทมเพลตที่ยาวบางส่วนที่สร้างขึ้นโดยบุคคลอื่นคุณอาจต้องการลบฟิลด์ผสานทั้งหมดที่มีอยู่แล้วในเทมเพลตนั้นก่อนที่จะทำ mail merge การดำเนินงาน คุณสามารถใช้ [DeleteFields](https://reference.aspose.com/words/cpp/aspose.words.mailmerging/mailmerge/deletefields/) วิธีถ้าคุณต้องการลบเขตข้อมูลผสานทั้งหมดจากเอกสารโดยไม่ต้องดำเนินการ mail merge การดำเนินงาน วิธีการนี้จะไม่ได้รับผลกระทบจากการลบตัวเลือกใดๆของ [CleanupOptions](https://reference.aspose.com/words/cpp/aspose.words.mailmerging/mailmerge/get_cleanupoptions/) คุณสมบัติและการดำเนินการก็เพียงแต่เอาเขตข้อมูลที่ผสานไม่ได้มีเขตข้อมูลหรือย่อหน้าที่.

ตัวอย่างรหัสต่อไปนี้แสดงวิธีการลบฟิลด์ผสานทั้งหมดจากแม่แบบของคุณโดยไม่ต้องดำเนิน mail merge การดำเนินงาน:

{{< gist "aspose-words-gists" "d55d8631947d283b1f0da99afa06c492" "Examples-DocsExamples-source-Programming with Documents-Working with Fields-DeleteFields.h" >}}

## ตั้งค่า `Removing` ตัวเลือก

Aspose.Words ช่วยให้คุณสามารถลบฟิลด์ภูมิภาคและย่อหน้าที่ไม่รวมออกจากเทมเพลตในระหว่าง mail merge การดำเนินการโดยใช้ตัวเลือกการลบ.

ใช้ **CleanupOptions** สถานที่ให้บริการพร้อมกับ [MailMergeCleanupOptions](https://reference.aspose.com/words/cpp/aspose.words.mailmerging/mailmergecleanupoptions/) การแจงนับเพื่อตั้งค่าตัวเลือกการลบ ระบุรายการที่คุณต้องการลบโดยการเลือกตัวเลือกต่อไปนี้(คุณสามารถรวมมากกว่าหนึ่ง):

* ลบย่อหน้าว่าง
* ลบพื้นที่ที่ไม่ได้ใช้
* ลบเขตข้อมูลที่ไม่ได้ใช้
* ลบเขตข้อมูลที่มี
* ลบเขตข้อมูลแบบคงที่
* ลบแถวตารางที่ว่างเปล่า

คุณสามารถพิจารณาฟิลด์รวมเป็นไม่รวมในเงื่อนไขใดเงื่อนไขหนึ่งต่อไปนี้:

1. ถ้าฟิลด์ผสานในแหล่งข้อมูลไม่มีคอลัมน์หรือฟิลด์การแม็พ.
2. ถ้าฟิลด์ผสานในแหล่งข้อมูลประกอบด้วยฟิลด์การแม็พแต่ข้อมูลเป็นโมฆะ.

{{% alert color="primary" %}}

ถ้าคุณกำลังรวมข้อมูลโดยใช้แหล่งข้อมูลที่แยกจากกันแล้วตัวเลือกการลบเหล่านั้นจะถูกเปิ mail merge วิธีการดำเนินการ.

{{% /alert %}}

### ลบย่อหน้าว่าง

ย่อหน้าที่มีเฉพาะเขตข้อมูลผสานจะว่างเปล่าเมื่อ mail merge กระบวนการเอาเขตข้อมูลการผสานทั้งหมดเป็นไม่รวม ย่อหน้าว่างเหล่านั้นสามารถเพิ่มพื้นที่ที่ไม่ต้องการและเปลี่ยนวิธีการสร้างรายงานจะมีลักษ คุณอาจต้องเผชิญกับสองสถานการณ์ที่มีย่อหน้าในช่วง mail merge การดำเนินงาน:

1. ร mail merge ฟิลด์จะถูกรวมเข้ากับข้อมูลที่ว่างเปล่า.
2. ฟิลด์ผสานไม่ได้ใช้และจะถูกลบออก.

ในทั้งสองสถานการณ์ **RemoveEmptyParagraphs** ตัวเลือกจะลบย่อหน้าว่างออกจากเอกสารโดยอัตโนมัติ บทความเครื่องใช้ในครัวเรือน/เครื่องครัว `TableStart` และ TableEnd ผสานเขตข้อมูลถ้าส่วนที่เหลือของย่อหน้าว่างเปล่า.

ตัวอย่างรหัสต่อไปนี้แสดงวิธีการเอาย่อหน้าว่าง:

{{< gist "aspose-words-gists" "d55d8631947d283b1f0da99afa06c492" "Examples-DocsExamples-source-Mail Merge and Reporting-Working with CleanupOptions-RemoveEmptyParagraphs.h" >}}

{{% alert color="primary" %}}

คุณสามารถดาวน์โหลดไฟล์ตัวอย่างของตัวอย่างนี้ได้จาก [Aspose.Words GitHub](https://github.com/aspose-words/Aspose.Words-for-C/tree/master/Examples).

{{% /alert %}}

### ลบเขตข้อมูลที่ไม่ได้ใช้

Aspose.Words ช่วยให้คุณลบใดๆที่ไม่ได้ใช้ mail merge เขตข้อมูลโดยการกำหนด **RemoveUnusedFields** ธงไปยัง **CleanupOptions**. ตัวเลือกนี้จะลบฟิลด์ผสานที่ไม่มีข้อมูลที่สอดคล้องกันในแหล่งข้อมูล.

ตัวอย่างรหัสต่อไปนี้แสดงวิธีการเอาเขตข้อมูลใดๆที่ไม่ได้ใช้ผสานจากเอกสารโดยอัตโนมัติ mail merge การดำเนินงาน:

{{< gist "aspose-words-gists" "d55d8631947d283b1f0da99afa06c492" "cpp-Mail-Merge-MailMergeCleanUp-RemoveUnusedFields.cpp" >}}

### การลบเขตข้อมูลที่มี

ฟิลด์ผสานสามารถอยู่ภายในฟิลด์อื่นเช่น **IF** ฟิลด์หรือฟิลด์สูตร ลบฟิลด์นี้ด้านนอกเมื่อรวมฟิลด์ผสานหรือลบออกจากเอกสาร.

ตัวอย่างรหัสต่อไปนี้แสดงวิธีการเอาเขตข้อมูลที่ประกอบด้วยเขตข้อมูลผสานจากเอกสาร:

{{< gist "aspose-words-gists" "d55d8631947d283b1f0da99afa06c492" "cpp-Mail-Merge-MailMergeCleanUp-RemoveContainingFields.cpp" >}}

**หมายเหตุ**

### ลบแถวตารางที่ว่างเปล่า

Aspose.Words ช่วยให้คุณลบแถวตารางที่ว่างเปล่าโดยการกำหนด **RemoveEmptyTableRows** ธงไปยัง **CleanupOptions**. ตัวเลือกนี้จะลบแถวตารางที่มีเขตข้อมูลผสานที่ว่างเปล่า.

ตัวอย่างรหัสต่อไปนี้แสดงวิธีการเอาแถวตารางว่างที่ประกอบด้วย mail merge ภูมิภาคจากเอกสาร:

{{< gist "aspose-words-gists" "d55d8631947d283b1f0da99afa06c492" "cpp-Mail-Merge-MailMergeCleanUp-RemoveEmptyTableRows.cpp" >}}
