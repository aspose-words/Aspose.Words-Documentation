---
title: รวมเซลล์ตารางใน C#
second_title: Aspose.Words สำหรับ .NET
articleTitle: ผสานเซลล์ตาราง
linktitle: ผสานเซลล์ตาราง
description: "วิธีผสานเซลล์ตารางใน C# ตรวจสอบว่าเซลล์ในตารางผสานโดยใช้ C# หรือไม่"
type: docs
weight: 40
url: /th/net/working-with-merged-cells/
---

บางครั้งบางแถวในตารางจำเป็นต้องมีส่วนหัวหรือบล็อกข้อความขนาดใหญ่ที่ใช้ความกว้างเต็มตาราง เพื่อการออกแบบตารางที่เหมาะสม ผู้ใช้สามารถรวมเซลล์ตารางหลายเซลล์ให้เป็นเซลล์เดียวได้ Aspose.Words รองรับเซลล์ที่ผสานเมื่อทำงานกับรูปแบบอินพุตทั้งหมด รวมถึงการนำเข้าเนื้อหา HTML

## วิธีผสานเซลล์ตาราง

ใน Aspose.Words เซลล์ที่ผสานจะแสดงด้วยคุณสมบัติของคลาส [CellFormat](https://reference.aspose.com/words/net/aspose.words.tables/cellformat/) ต่อไปนี้:

- [HorizontalMerge](https://reference.aspose.com/words/net/aspose.words.tables/cellformat/horizontalmerge/) ซึ่งอธิบายว่าเซลล์เป็นส่วนหนึ่งของการผสานเซลล์ในแนวนอนหรือไม่
- [VerticalMerge](https://reference.aspose.com/words/net/aspose.words.tables/cellformat/verticalmerge/) ซึ่งอธิบายว่าเซลล์เป็นส่วนหนึ่งของการผสานเซลล์ในแนวตั้งหรือไม่

ค่าของคุณสมบัติเหล่านี้จะกำหนดพฤติกรรมการผสานของเซลล์:

- เซลล์แรกในลำดับของเซลล์ที่ผสานจะมี [CellMerge.First](https://reference.aspose.com/words/net/aspose.words.tables/cellmerge/)
- เซลล์ที่รวมเข้าด้วยกันในเวลาต่อมาจะมี [CellMerge.Previous](https://reference.aspose.com/words/net/aspose.words.tables/cellmerge/)
- เซลล์ที่ไม่ถูกผสานจะมี [CellMerge.None](https://reference.aspose.com/words/net/aspose.words.tables/cellmerge/)

{{% alert color="primary" %}}

บางครั้งเมื่อโหลดเซลล์เอกสารที่มีอยู่ในตาราง เซลล์เหล่านั้นจะปรากฏเป็นผสานกัน อย่างไรก็ตาม จริงๆ แล้วอาจเป็นเซลล์ยาวเซลล์เดียวก็ได้ บางครั้ง Microsoft Word จะส่งออกเซลล์ที่ผสานด้วยวิธีนี้ สิ่งนี้อาจทำให้เกิดความสับสนเมื่อพยายามทำงานกับเซลล์แต่ละเซลล์ แต่ดูเหมือนว่าจะไม่มีรูปแบบเฉพาะเจาะจงว่าเหตุการณ์นี้จะเกิดขึ้นเมื่อใด

{{% /alert %}}

## ตรวจสอบว่าเซลล์ถูกผสานหรือไม่

หากต้องการตรวจสอบว่าเซลล์เป็นส่วนหนึ่งของลำดับของเซลล์ที่ผสานหรือไม่ เราเพียงตรวจสอบคุณสมบัติ **HorizontalMerge** และ **VerticalMerge**

ตัวอย่างโค้ดต่อไปนี้แสดงวิธีการพิมพ์ชนิดการผสานเซลล์แนวนอนและแนวตั้ง:

{{< gist "aspose-words-gists" "93de23a2f74a7f2e4971ed203874c983" "check-cells-merged.cs" >}}

{{% alert color="primary" %}}

คุณสามารถดาวน์โหลดไฟล์ตัวอย่างของตัวอย่างนี้ได้จาก [Aspose.Words GitHub](https://github.com/aspose-words/Aspose.Words-for-.NET/blob/master/Examples/Data/Table%20with%20merged%20cells.docx)

{{% /alert %}}

## ผสานเซลล์ตารางเมื่อใช้ DocumentBuilder

หากต้องการผสานเซลล์ในตารางที่สร้างด้วย [DocumentBuilder](https://reference.aspose.com/words/net/aspose.words/documentbuilder/) คุณต้องตั้งค่าประเภทการผสานที่เหมาะสมสำหรับเซลล์แต่ละเซลล์ที่คาดว่าจะมีการผสาน - **CellMerge.First** แรกแล้วตามด้วย **CellMerge.Previous**

นอกจากนี้ คุณต้องไม่ลืมล้างการตั้งค่าการผสานสำหรับเซลล์ที่ไม่จำเป็นต้องผสาน ซึ่งสามารถทำได้โดยการตั้งค่าเซลล์แรกที่ยังไม่ผสานเป็น **CellMerge.None** หากยังไม่เสร็จสิ้น เซลล์ทั้งหมดในตารางจะถูกรวมเข้าด้วยกัน

ตัวอย่างโค้ดต่อไปนี้แสดงวิธีสร้างตารางที่มีสองแถวโดยที่เซลล์ในแถวแรกจะผสานกันในแนวนอน:

{{< gist "aspose-words-gists" "93de23a2f74a7f2e4971ed203874c983" "horizontal-merge.cs" >}}

ตัวอย่างโค้ดต่อไปนี้แสดงวิธีสร้างตารางสองคอลัมน์โดยที่เซลล์ในคอลัมน์แรกถูกผสานในแนวตั้ง:

{{< gist "aspose-words-gists" "93de23a2f74a7f2e4971ed203874c983" "vertical-merge.cs" >}}

## รวมเซลล์ตารางในกรณีอื่นๆ

ในสถานการณ์อื่นๆ ที่ไม่ได้ใช้ **DocumentBuilder** เช่น ในตารางที่มีอยู่ การรวมเซลล์ด้วยวิธีก่อนหน้าอาจไม่ง่ายอย่างนั้น แต่เราสามารถรวมการดำเนินการพื้นฐานที่เกี่ยวข้องกับการใช้คุณสมบัติการผสานกับเซลล์ด้วยวิธีที่ทำให้งานง่ายขึ้นมาก วิธีการนี้จะคล้ายกับวิธีการผสานอัตโนมัติ ซึ่งเรียกว่าการผสานช่วงของเซลล์ในตาราง

โค้ดด้านล่างนี้จะรวมเซลล์ตารางในช่วงที่ระบุ โดยเริ่มต้นที่เซลล์ที่กำหนดและสิ้นสุดที่เซลล์สุดท้าย ในกรณีนี้ ช่วงสามารถขยายได้หลายแถวหรือคอลัมน์:

{{< gist "aspose-words-gists" "93de23a2f74a7f2e4971ed203874c983" "merge-cells.cs" >}}

ตัวอย่างโค้ดต่อไปนี้แสดงวิธีการผสานช่วงของเซลล์ระหว่างสองเซลล์ที่ระบุ:

{{< gist "aspose-words-gists" "93de23a2f74a7f2e4971ed203874c983" "merge-cell-range.cs" >}}

{{% alert color="primary" %}}

คุณสามารถดาวน์โหลดไฟล์ตัวอย่างของตัวอย่างนี้ได้จาก [Aspose.Words GitHub](https://github.com/aspose-words/Aspose.Words-for-.NET/blob/master/Examples/Data/Table%20with%20merged%20cells.docx)

{{% /alert %}}

ขึ้นอยู่กับเวอร์ชันของ .NET Framework ที่คุณใช้ คุณอาจต้องการปรับแต่งวิธีนี้โดยเปลี่ยนเป็นวิธีการขยาย ในกรณีนี้ คุณสามารถเรียกใช้เมธอดนี้บนเซลล์ได้โดยตรงเพื่อผสานช่วงของเซลล์ เช่น `cell1.Merge(cell2)`

## เซลล์ที่ผสานแนวตั้งและแนวนอนในตาราง HTML

ดังที่เราได้กล่าวไปแล้วในบทความก่อนหน้านี้ ตารางใน Microsoft Word คือชุดของแถวที่เป็นอิสระ แต่ละแถวมีชุดเซลล์ที่ไม่ขึ้นอยู่กับเซลล์ของแถวอื่นๆ ดังนั้นในตาราง Microsoft Word จึงไม่มีวัตถุเช่น "คอลัมน์" และ "คอลัมน์ที่ 1" ก็เหมือนกับ "ชุดของเซลล์ที่ 1 ของแต่ละแถวในตาราง" ซึ่งจะทำให้ผู้ใช้สามารถมีตารางได้ เช่น แถวที่ 1 ประกอบด้วยเซลล์ 2 เซลล์ ขนาด 2 ซม. และ 1 ซม. และแถวที่ 2 ประกอบด้วยเซลล์ที่แตกต่างกัน 2 เซลล์ กว้าง 1 ซม. และ 2 ซม. และ Aspose.Words สนับสนุนแนวคิดของตารางนี้

ตารางใน HTML มีโครงสร้างที่แตกต่างกัน โดยแต่ละแถวมีจำนวนเซลล์เท่ากัน และ (ซึ่งเป็นสิ่งสำคัญสำหรับงาน) แต่ละเซลล์มีความกว้างของคอลัมน์ที่สอดคล้องกัน ซึ่งเหมือนกันสำหรับเซลล์ทั้งหมดในคอลัมน์เดียว ดังนั้นหาก **HorizontalMerge** และ **VerticalMerge** ส่งกลับค่าที่ไม่ถูกต้อง ให้ใช้ตัวอย่างโค้ดต่อไปนี้:

{{< gist "aspose-words-gists" "93de23a2f74a7f2e4971ed203874c983" "print-horizontal-and-vertical-merged.cs" >}}

{{< gist "aspose-words-gists" "93de23a2f74a7f2e4971ed203874c983" "horizontal-and-vertical-merge-helper-classes.cs" >}}

{{% alert color="primary" %}}

คุณสามารถดาวน์โหลดไฟล์ตัวอย่างของตัวอย่างนี้ได้จาก [Aspose.Words GitHub](https://github.com/aspose-words/Aspose.Words-for-.NET/blob/master/Examples/Data/Table%20with%20merged%20cells.docx)

{{% /alert %}}

## แปลงเป็นเซลล์ที่ผสานในแนวนอน

บางครั้งก็เป็นไปไม่ได้ที่จะตรวจสอบว่าเซลล์ใดถูกผสาน เนื่องจาก Microsoft Word เวอร์ชันใหม่บางเวอร์ชันไม่ใช้แฟล็กผสานอีกต่อไปเมื่อเซลล์ถูกผสานในแนวนอน แต่สำหรับสถานการณ์ที่เซลล์ถูกผสานเข้ากับเซลล์ในแนวนอนตามความกว้างโดยใช้แฟล็กผสาน Aspose.Words จัดเตรียมวิธี `ConvertToHorizontallyMergedCells` เพื่อแปลงเซลล์ วิธีนี้จะแปลงตารางและเพิ่มเซลล์ใหม่ตามต้องการ

ตัวอย่างโค้ดต่อไปนี้แสดงวิธีการข้างต้นในการดำเนินการ:

{{< gist "aspose-words-gists" "93de23a2f74a7f2e4971ed203874c983" "convert-to-horizontally-merged-cells.cs" >}}
