---
title: Преобразование в формат фиксированной страницы
second_title: Aspose.Words для Python via .NET
articleTitle: Преобразование в формат фиксированной страницы
linktitle: Преобразование в формат фиксированной страницы
description: "Сохраняйте документы в форматах PDF, XPS, HTML, XAML, PostScript и PCL, используя Python."
type: docs
weight: 10
url: /ru/python-net/converting-to-fixed-page-format/
---

Aspose.Words реализует собственный движок макета страницы. Прежде чем углубляться в его характеристики, стоит сначала обсудить документ на высоком уровне. Размышляя о документе, пользователи обычно представляют себе несколько листов бумаги, содержащих слова, изображения, таблицы и диаграммы. Документы могут быть разных типов, например текст, электронные таблицы, слайды, чертежи САПР, блок-схемы, и, следовательно, могут иметь существенно разные макеты. Большинство приложений позволяют отправлять документы на принтер; это когда пользователь может фактически просмотреть окончательный предполагаемый вид документа.

## Отображение документа в различных приложениях

Различные приложения для просмотра или публикации документов позволяют пользователям открывать (Adobe Acrobat, XPS Viewer), а иногда и редактировать (Adobe InDesign) документы определенных форматов. Эти приложения обычно создают документы так называемого формата "фиксированной страницы". Такой формат документа точно описывает, где на каждой странице размещается содержимое документа. Внутри формат PDF или XPS содержит описание каждой страницы, а также инструкции по рисованию, определяющие расположение содержимого на странице. Это похоже на форматы изображений, описывающие, где контент отображается в растровой или векторной форме.

Напротив, некоторые приложения для редактирования текста не поддерживают просмотр страниц документа. Например, Блокнот Microsoft поддерживает очень мало функций, кроме простого отображения, редактирования и печати текста. Важным наблюдением здесь является то, что такие приложения не могут ни показывать страницы документа, ни сообщать пользователю, сколько из них будет напечатано, а позволяют только просматривать содержимое документа. Документ можно сохранить в текстовом формате и открыть во многих других приложениях. С помощью приложения, позволяющего просматривать двоичное содержимое произвольного файла, можно увидеть, что хранится в файле документа – это просто текст, больше в нем ничего нет.

Немного более сложные приложения для редактирования текста, такие как Microsoft WordPad, сохраняют документ в расширенном текстовом формате (RTF), который поддерживает больше функций форматирования, таких как вставка изображений, форматирование символов, поля абзаца и интервалы. Однако формат RTF также содержит только содержимое документа, не имея информации о страницах.

Microsoft Word — это самое продвинутое на сегодняшний день приложение для редактирования текста в Windows. Он форматирует файлы в формате DOCX, который гибко и подробно описывает содержимое документа, позволяя пользователям указывать размер страницы, ориентацию раздела документа, а, будучи приложением WYSIWYG, даже отображать страницы документа на экране. Тем не менее, до сих пор нет информации о том, как содержимое документа отображается на страницах, доступных в файле документа. Файл документа описывает только само содержимое и взаимосвязь объектов документа друг с другом, а также некоторые геометрические ограничения. В результате перед отображением документа Microsoft Word сам вычисляет эту информацию. Здесь в игру вступает макет страницы.

## Что такое макет страницы

Макет страницы документа — это структура данных, описывающая расположение конкретного объекта на страницах для всех объектов документа. Кроме того, поскольку объекты имеют свойства, влияющие на их внешний вид, такие как размер шрифта, эффекты затенения или рисования, вам необходимо не только знать, где находится объект, но и какую область(и) страницы он занимает и будет ли он применять к нескольким страницам, чтобы другие объекты не перекрывали одну и ту же область(и).

В Aspose.Words реализована внутренняя функциональность макета страницы, позволяющая создавать все фиксированные форматы страниц, такие как PDF, XPS и различные форматы изображений. Без макета страницы информация, хранящаяся в файле документа с фиксированной страницей, была бы недоступна, и все эти форматы не поддерживались бы.

Связь между документом и макетом страницы довольно проста. В то время как документ описывает содержимое, соответствующий макет страницы описывает геометрию этого содержимого. Обратите внимание, что макет страницы не может существовать без документа, поскольку не будет контента для расчета геометрии, но документ может существовать без макета страницы. Например, когда документ DOCX преобразуется в документ RTF, обычно нет необходимости знать геометрию, поскольку ни один из форматов не хранит ее.

## Создание макета страницы

Создание макета страницы может оказаться дорогостоящей процедурой как с точки зрения скорости, так и с точки зрения памяти. Это связано с несколькими причинами:

- Документ может содержать большой объем содержимого, которое может потребоваться отобразить на тысячах страниц. Геометрию каждого объекта на каждой странице придется описывать, что потребует ресурсов памяти.
- В документе может быть много правил, накладывающих ограничения на геометрию. На обеспечение выполнения каждого ограничения может быть потрачено значительное время вычислений
— Некоторые функции документа, например поле `NUMPAGES`, создают рекурсивные зависимости для будущих значений свойств, которые недоступны во время расчета. Это приводит к повторным вычислениям и увеличивает время вычислений.

По вышеуказанным причинам Aspose.Words создаст макет страницы только тогда, когда это необходимо. Типичной причиной этого может быть запрос на отображение страниц документа или получение значения поля, которое зависит от информации, доступной в макете страницы. Менее очевидной причиной может быть экспорт документа в HTML. Несмотря на то, что HTML не является форматом фиксированной страницы и не описывает геометрию объектов контента, он по-прежнему поддерживает изображения. Такие изображения могут иметь форму фигур, созданных в Microsoft Word, с текстом внутри них. Например, диаграмму с метками осей можно экспортировать в HTML как изображение, но прежде чем это можно будет сделать, Aspose.Words необходимо отобразить это изображение и, следовательно, необходимо знать, где отображать метку. См. пример диаграммы ниже:

<img src="/words/python-net/converting-to-fixed-page-format/converting-to-fixed-page-format-1.png" alt="преобразование в фиксированный формат страницы_1" style="width:800px"/>

### Негеометрические свойства

Помимо обработки геометрической информации, макет страницы также отвечает за расчет цветов и стилей границ. В Microsoft Word цвет текста может быть задан как автоматический, подразумевая, что выбор цвета должен основываться на цвете заливки ячейки или абзаца или на основе цвета страницы, на которой появляется текст.

Макет страницы рассчитывает, где будет отображаться текст и какой контент будет отображаться за ним, что позволяет рассчитывать цвет. Существуют и другие конкретные расчеты, выполняемые макетом страницы. Например, горизонтальная граница таблицы зависит от того, является ли строка таблицы последней в текстовом столбце и разбита ли она на несколько столбцов. Если строка отображается последней в столбце, вместо горизонтальной используется нижняя граница.

![converting-to-fixed-page-format_2](/words/python-net/converting-to-fixed-page-format/converting-to-fixed-page-format-2.png)

В Aspose.Words пользователь может запросить, создать ли новый макет страницы или обновить существующий. Обе эти операции можно выполнить с помощью метода [update_page_layout](https://reference.aspose.com/words/python-net/aspose.words/document/update_page_layout/), предоставляемого классом [Document](https://reference.aspose.com/words/python-net/aspose.words/document/). Если макет страницы не существует, но в нем есть необходимость (например, при экспорте документа в формат фиксированной страницы), Aspose.Words автоматически вызовет этот метод. Однако если макет страницы уже существует, Aspose.Words будет использовать существующий, чтобы избежать потребления ресурсов, необходимых для его обновления. В этом случае пользователю необходимо вызвать метод [update_page_layout](https://reference.aspose.com/words/python-net/aspose.words/document/update_page_layout/), чтобы убедиться, что макет страницы соответствует модели документа.

### Динамическая структура

Процесс создания макета страницы состоит из следующих этапов:

- *Conversion* – перечисление содержимого модели документа и подготовка соответствующих объектов макета.
- *Build* – расположение объектов макета для представления содержимого документа на страницах.
- *Reflow* – обновление расположения объектов для удовлетворения геометрических ограничений.
- *Проецирование объектов макета в фиксированное представление страницы и доработка информации о цвете*.
- *Создание и перекомпоновка содержимого фигуры* — шаг, необходимый, если документ содержит фигуры с вложенным текстовым содержимым.

Обратите внимание, что макет страницы представляет собой динамическую структуру, которую можно частично перестраивать. Это особенно необходимо, когда невозможно вычислить значения полей без перестройки структуры макета документа. Поле может ссылаться на расположение объекта на странице, и в то же время само значение поля также отображается на странице, влияя на расположение объекта, на который ссылаются. Макет страницы невозможно создать за один раз, поскольку значения полей могут быть еще недоступны на момент размещения на странице.

Рассмотрим типичный сценарий, когда поле `NUMPAGES` появляется в нижнем колонтитуле первой страницы документа. Значение этого поля — общее количество страниц. Чтобы расположить поле на странице, необходимо знать его значение. Если в настоящее время создается только первая страница, общее количество страниц еще не известно. В этом случае макет страницы должен использовать значение по умолчанию, а затем вернуться к этому полю и изменить его значение в соответствии с фактическими вычислениями. Однако изменение значения поля может повлиять на другое содержимое документа на странице и в конечном итоге привести к добавлению новой страницы или удалению существующей страницы, что приведет к устареванию вычисленного значения. Эту проблему можно решить, сделав возможность обновления существующего макета страницы.

При создании макета также есть возможность настроить [LayoutOptions](https://reference.aspose.com/words/python-net/aspose.words.layout/layoutoptions/) свойств, влияющих на вывод документа на страницах.

## Сохранение в формате фиксированной страницы

После построения макета страницы и расчета геометрии объектов и их положения на странице документ можно сохранить в формате фиксированной страницы, поддерживаемом Aspose.Words. При сохранении документов в форматах фиксированной страницы используются общие для всех параметры рендеринга. из этих форматов можно использовать. Они позволяют контролировать:

- Количество и диапазон страниц, содержащихся в выходном документе ([page_set](https://reference.aspose.com/words/python-net/aspose.words.saving/fixedpagesaveoptions/page_set/)).
- Набор символов, используемых для рендеринга чисел ([numeral_format](https://reference.aspose.com/words/python-net/aspose.words.saving/fixedpagesaveoptions/numeral_format/)).
- Проигрыватель метафайлов ([metafile_rendering_options](https://reference.aspose.com/words/python-net/aspose.words.saving/fixedpagesaveoptions/metafile_rendering_options/)). Подробнее читайте в статье [Обработка Windows метафайлов](/words/ru/python-net/handling-windows-metafiles/).
- Показатель качества повторного сжатия изображений JPEG, значение которого может незначительно отличаться в зависимости от выбранного формата сохранения ([jpeg_quality](https://reference.aspose.com/words/python-net/aspose.words.saving/fixedpagesaveoptions/jpeg_quality/)).
- Оптимизация векторной графики на выходе Aspose.Words ([optimize_output](https://reference.aspose.com/words/python-net/aspose.words.saving/fixedpagesaveoptions/optimize_output/)).
— Параметры графики при сохранении в форматах Tiff, Png, Bmp, Jpeg, Emf ([use_anti_aliasing](https://reference.aspose.com/words/python-net/aspose.words.saving/saveoptions/use_anti_aliasing/), [use_high_quality_rendering](https://reference.aspose.com/words/python-net/aspose.words.saving/saveoptions/use_high_quality_rendering/)).
- Сохранение документа в оттенках серого ([color_mode](https://reference.aspose.com/words/python-net/aspose.words.saving/fixedpagesaveoptions/color_mode/)).
— Переключение между рендерингом фигур DrawingML и резервными фигурами ([dml_rendering_mode](https://reference.aspose.com/words/python-net/aspose.words.saving/saveoptions/dml_rendering_mode/)).
— Переключение между режимами отрисовки DML-эффектов ([dml_effects_rendering_mode](https://reference.aspose.com/words/python-net/aspose.words.saving/saveoptions/dml_effects_rendering_mode/)).

В примере ниже показано, как сохранить документ в формате JPEG, используя метод [save](https://reference.aspose.com/words/python-net/aspose.words/document/save/) и параметры рендеринга:

{{< highlight python >}}
# Open the document
doc = aw.Document(docs_base.my_dir + "Rendering.docx")
# Save as a JPEG image file with default options
doc.save(docs_base.artifacts_dir + "Rendering.JpegDefaultOptions.jpg")

# Save document to stream as a JPEG with default options
docStream = io.BytesIO()
doc.save(docStream, aw.SaveFormat.JPEG)
# Rewind the stream position back to the beginning, ready for use
docStream.seek(0)

# Save document to a JPEG image with specified options.
# Render the third page only and set the JPEG quality to 80%
# In this case we need to pass the desired SaveFormat to the ImageSaveOptions constructor 
# to signal what type of image to save as.
imageOptions = aw.saving.ImageSaveOptions(aw.SaveFormat.JPEG)
imageOptions.page_index = 2
imageOptions.page_count = 1
imageOptions.jpeg_quality = 80
doc.save(docs_base.artifacts_dir + "Rendering.JpegCustomOptions.jpg", imageOptions)
{{< /highlight >}}
