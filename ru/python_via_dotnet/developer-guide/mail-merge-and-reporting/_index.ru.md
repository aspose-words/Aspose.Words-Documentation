---
title: Mail Merge и отчет в Python
second_title: Aspose.Words для Python via .NET
articleTitle: Mail Merge и отчетность
linktitle: Mail Merge и отчетность
type: docs
description: "Mail Merge - популярная функция для быстрого создания документов с помощью Python. Aspose.Words for Python via .NET использует стандартную функциональность Mail Merge и развивает ее на много шагов вперед, превращая в полноценное решение для создания отчетов, которое позволяет создавать еще более сложные документы, такие как отчеты, каталоги, инвентаризации и счета-фактуры."
keywords: "how to use Mail Merge python"
weight: 30
url: /ru/python-net/mail-merge-and-reporting/
timestamp: 2024-01-27-14-07-04
---

Mail Merge - популярная функция для быстрого и простого создания документов, таких как письма, этикетки и конверты. Aspose.Words позволяет создавать документы на основе шаблонов с полями Mail Merge.

Поле Mail Merge - это поле, которое можно вставить в шаблон mail merge для включения определенных значений из записи источника данных в выходные документы. Например, вы можете вставить объединяющее поле в шаблон электронного письма, чтобы в приветствии было указано имя получателя, а не обычное "Привет!". Aspose.Words в эти поля помещаются данные из внешнего источника, такие как база данных или файл, и они форматируются. Полученный документ сохраняется в указанной папке.

Aspose.Words использует стандартную функциональность Mail Merge и развивает ее на много шагов вперед, превращая в полноценное решение для создания отчетов, которое позволяет создавать еще более сложные документы, такие как отчеты, каталоги, инвентаризации и счета-фактуры. Вот несколько преимуществ решения для создания отчетов Aspose.Words:

- Создавайте отчеты в Microsoft Word с использованием стандартных Mail Merge полей
- Определите растущие области в документе, такие как строки подробного заказа (в настоящее время не поддерживается в версии Python)
- Вставка изображений во время mail merge
- Выполняйте любую пользовательскую логику, управляйте форматированием или вставляйте сложное содержимое с помощью обработчиков событий Mail Merge (в настоящее время не поддерживается в версии Python)
- Заполнять документы данными из любого типа источника данных (в настоящее время не поддерживается в версии Python, поддерживается только источник данных arrays)

{{% alert color="primary" %}}

Модуль [aspose.words.mailmerging](https://reference.aspose.com/words/python-net/aspose.words.mailmerging/) используется для работы с объединением почты.

{{% /alert %}}

## Механизм и основные компоненты операции Mail Merge {#mechanism-and-main-components-of-a-mail-merge-operation}

Aspose.Words предоставляет возможность загружать документы в различных [supported formats](https://reference.aspose.com/words/python-net/aspose.words/loadformat/) форматах, а затем позволяет пользователям выполнять Mail Merge операции.

Обычно загруженный документ позволяет сохранять поля слияния, например, документ в формате DOCX. Но есть форматы, которые не хранят такие поля, например, TXT. Если Aspose.Words поддерживает загрузку таких форматов файлов, вы можете добавить поля слияния непосредственно в модель документа, сохранить документ в удобном [supported format](https://reference.aspose.com/words/python-net/aspose.words/saveformat/) виде и выполнить операцию Mail Merge.

Операция Mail Merge объединит ваши *mail merge template* и ваши *data source* для создания отдельного *merged documents*.

## Что такое шаблон Mail Merge {#what-is-a-mail-merge-template}

Цель применения операции mail merge с использованием шаблона слияния состоит в том, чтобы упростить процесс создания документа.

Существует несколько способов создания и оформления шаблона слияния. Вы можете использовать Microsoft Word, и шаблон слияния не обязательно должен быть шаблоном Microsoft Word, то есть документом в формате DOT или DOTX, это может быть обычный документ в формате DOC или DOCX. Вам нужно вставить в этот шаблон несколько специальных полей, называемых полями слияния, в тех местах, куда вы хотите позже вставить данные из вашего источника данных. Или вы можете программно создать шаблон слияния, используя класс [DocumentBuilder](https://reference.aspose.com/words/python-net/aspose.words/documentbuilder/).

Шаблон объединения содержит основной текст, который должен быть одинаковым во всех выходных документах после выполнения операции Mail Merge. Вы можете использовать любой формат для своего шаблона, если есть возможность добавить в него поля для объединения. Все поля для объединения в вашем шаблоне будут заполнены из вашего источника данных во время операции Mail Merge.

## Типы источников данных для операции Mail Merge {#data-source-types-for-a-mail-merge-operation}

В настоящее время Aspose.Words для Python via .NET Mail Merge принимает только массив значений в качестве источника данных. Другие типы будут добавлены в будущих версиях.

В следующем примере кода показано, как создать простой шаблон и заполнить его данными, используя функциональность Mail Merge:

{{< gist "aspose-words-gists" "e9d8f984dac599756ccb4a64b8c79768" "Examples-DocsExamples-DocsExamples-Mail Merge and Reporting-base_operations-SimpleMailMerge.py" >}}


## Объединенные документы операции Mail Merge {#merged-documents-of-a-mail-merge-operation}

Объединенный документ является результатом операции Mail Merge, выполняемой при объединении шаблона с источником данных. Все поля для объединения в объединенном документе заменяются фактическими данными из вашего источника данных.

На следующем рисунке показан пример шаблона объединения с объединенными полями перед выполнением операции Mail Merge.

![mail-merge-and-reporting-fields-aspose-words-net](mail-merge-and-reporting-1.jpg)

На следующем рисунке показан пример выходного объединенного документа, полученного в результате выполнения операции Mail Merge.

![mail-merge-and-reporting-result-aspose-words-net](mail-merge-and-reporting-2.jpg)

## Смотрите также

- [Работа с шаблонами Mail Merge в Word](https://docs.microsoft.com/en-us/power-platform/admin/work-mail-merge-templates)
