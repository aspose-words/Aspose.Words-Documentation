---
title: Сериализация и работа с документом в базе данных
second_title: Aspose.Words для Java
articleTitle: Сериализация и работа с документом в базе данных
linktitle: Сериализация и работа с документом в базе данных
description: "Преобразовать документ в байтовый массив для работы с этим документом в базе данных. Вы можете хранить и извлекать документ из базы данных, используя Java."
type: docs
weight: 40
url: /ru/java/serialize-and-work-with-a-document-in-a-database/
timestamp: 2024-01-27-14-07-04
---

Одной из задач, которую вам, возможно, придется выполнить при работе с документами, является хранение и извлечение. **Document** объектов в базу данных и из нее. Например, это необходимо, если вы внедряете какой-либо тип системы управления контентом. Все предыдущие версии документов должны храниться в базе данных. Возможность хранения документов в базе данных также чрезвычайно полезна, когда ваше приложение предоставляет веб-сервис.

Aspose.Words обеспечивает возможность преобразования документа в байтовый массив для последующей работы с этим документом в базе данных.

## Преобразование документа в Byte Array

Чтобы сохранить документ в базе данных или подготовить документ для передачи по сети, часто необходимо сериализовать документ, чтобы получить байтовый массив.

Для сериализации [Document](https://reference.aspose.com/words/java/com.aspose.words/document/) объект в Aspose.Words:

1. Сохранить его в a **MemoryStream** используя [Save](https://reference.aspose.com/words/java/com.aspose.words/document/#save-java.io.OutputStream-int) метод перегрузки **Document** класс.
1. Звони. **ToArray** метод, который возвращает массив байтов, представляющих документ в байтовой форме.

Вышеуказанные шаги затем можно перевернуть, чтобы загрузить байты обратно в **Document** объект.

{{% alert color="primary" %}}

Выбранный формат сохранения важен для обеспечения максимальной точности при сохранении и перезагрузке. **Document** объект. По этой причине предлагается использовать ряд форматов файлов OOXML.

{{% /alert %}}

В приведенном ниже примере показано, как сериализовать **Document** объект для получения байтового массива, а затем как разсериализировать байтовый массив для получения **Document** Еще раз возражаю:

{{< gist "aspose-words-gists" "827e71ccc0b8516a3cfe247b86ce6d4e" "Examples-src-main-java-com-aspose-words-examples-loading_saving-ConvertDocumentToByte-ConvertDocumentToByte.java" >}}

{{% alert color="primary" %}}

Вы можете скачать файл шаблона этого примера из [Aspose.Words GitHub](https://github.com/aspose-words/Aspose.Words-for-Java/blob/master/Examples/Data/Document.doc).

{{% /alert %}}

## Хранить, читать и удалять документ в базе данных

В этом разделе показано, как сохранить документ в базе данных, а затем загрузить его обратно в базу данных. `Document` Объект для работы с ним. Для простоты имя файла - это ключ, используемый для хранения и извлечения документов из базы данных. База данных содержит две колонки. Первая колонка "Имя файла" хранится в виде строки и используется для идентификации документов. Вторая колонка "FileContent" хранится в виде `BLOB` объект, который хранит объект документа в байтовой форме.

Следующий пример кода показывает, как настроить соединение с базой данных и выполнить команды:

{{< gist "aspose-words-gists" "827e71ccc0b8516a3cfe247b86ce6d4e" "Examples-src-main-java-com-aspose-words-examples-loading_saving-LoadAndSaveFromDatabase-OpenDatabaseConnection.java" >}}

{{% alert color="primary" %}}

В этом примере мы используем базу данных MySQL для хранения Aspose.Words Документ.

{{% /alert %}}

Следующий пример кода показывает, как сохранить документ в базу данных, затем снова прочитать тот же документ и, наконец, удалить запись, содержащую документ из базы данных:

{{< gist "aspose-words-gists" "827e71ccc0b8516a3cfe247b86ce6d4e" "Examples-src-main-java-com-aspose-words-examples-loading_saving-LoadAndSaveFromDatabase-OpenRetrieveAndDelete.java" >}}

### Сохранить документ в базу данных

Для сохранения документа в базе данных преобразуйте этот документ в массив байтов, как описано в начале данной статьи. Затем сохраните этот байтовый массив в поле базы данных.

Следующий пример кода показывает, как сохранить документ в указанной базе данных:

{{< gist "aspose-words-gists" "827e71ccc0b8516a3cfe247b86ce6d4e" "Examples-src-main-java-com-aspose-words-examples-loading_saving-LoadAndSaveFromDatabase-StoreToDatabase.java" >}}

Укажите командную строку, которая является выражением SQL, выполняющим всю работу:

- Для сохранения документа в базе данных используется команда "INSERT INTO" и указанная таблица вместе со значениями двух полей записи - FileName и FileContent. Чтобы избежать дополнительных параметров, имя файла берется из **Document** сам объект. The `FileContent` Значение поля присваивается байтами из потока памяти, который содержит двоичное представление хранимого документа.
- Оставшаяся строка кода выполняет команду, которая хранит Aspose.Words документ в базе данных.

### Восстановление документа из базы данных

Чтобы извлечь документ из базы данных, выберите запись, содержащую данные документа, в виде массива байтов. После этого снимите байт с пластинки. **MemoryStream** и создать **Document** объект, который будет загружать документ из **MemoryStream**.

Следующий пример кода показывает, как извлечь и вернуть документ из указанной базы данных, используя имя файла в качестве ключа для получения этого документа:

{{< gist "aspose-words-gists" "827e71ccc0b8516a3cfe247b86ce6d4e" "Examples-src-main-java-com-aspose-words-examples-loading_saving-LoadAndSaveFromDatabase-ReadFromDatabase.java" >}}

{{% alert color="primary" %}}

Команда SQL "SELECT * FROM" используется для получения соответствующей записи на основе имени файла.

{{% /alert %}}

### Удалить документ из базы данных

Чтобы удалить документ из базы данных, используйте соответствующую команду SQL без каких-либо манипуляций. **Document** объект.

Следующий пример кода показывает, как удалить документ из базы данных, используя имя файла для получения записи:

{{< gist "aspose-words-gists" "827e71ccc0b8516a3cfe247b86ce6d4e" "Examples-src-main-java-com-aspose-words-examples-loading_saving-LoadAndSaveFromDatabase-DeleteFromDatabase.java" >}}
