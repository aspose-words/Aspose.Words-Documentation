---
title: Разделить документ в C#
second_title: Aspose.Words для .NET
articleTitle: Разделить документ
linktitle: Разделить документ
description: "Разделите документ на несколько файлов с помощью C#. Используйте функцию разделения, чтобы эффективно разделить документ по заголовкам или разделам, а также по страницам или по диапазонам страниц."
type: docs
weight: 90
url: /ru/net/split-a-document/
---

*Splitting* или *разделить документ* — это процесс разбиения большого документа на большее количество файлов меньшего размера. Существуют различные причины для разделения файла. Например, вам нужны только несколько страниц конкретного документа, а не весь. Или из соображений конфиденциальности вы хотите поделиться с другими только некоторыми частями документа. Благодаря функции разделения вы сможете получить только нужные части документа и проделать с ними необходимые действия, например, разметить, сохранить или отправить.

Aspose.Words предоставляет вам эффективный способ разделить один документ на несколько документов по заголовкам или разделам. Вы также можете разделить документ по страницам или по диапазонам страниц. Оба варианта разделения будут описаны в этой статье.

Чтобы разделить документ на файлы меньшего размера с помощью Aspose.Words, вам необходимо выполнить следующие действия:

1. Загрузите документ в любом поддерживаемом формате.
1. Разделите документ.
1. Сохраните выходные документы.

После разделения документа вы сможете открыть все выходные документы, которые начнутся с необходимых страниц, текста и т.д.

{{% alert color="primary" %}}

**Попробуйте онлайн**

Вы можете попробовать эту функциональность с нашим [Бесплатный онлайн-разделитель документов](https://products.aspose.app/words/splitter).

{{% /alert %}}

## Разделение документа по разным критериям {#split-a-document-using-different-criteria}

Aspose.Words позволяет разбивать документы EPUB или HTML на главы по различным критериям. При этом стиль и макет исходного документа сохраняются для выходных документов.

Вы можете указать критерии, используя перечисление [DocumentSplitCriteria](https://reference.aspose.com/words/net/aspose.words.saving/documentsplitcriteria/). Таким образом, вы можете разделить документ на главы, используя один из следующих критериев, или объединить несколько критериев вместе:

- заголовок абзаца,
- разрыв раздела,
- разрыв столбца,
- разрыв страницы.

При сохранении вывода в HTML Aspose.Words сохраняет каждую отдельную главу как отдельный файл HTML. В результате документ будет разделен на несколько HTML-файлов. При сохранении вывода в EPUB Aspose.Words сохраняет результат в одном файле EPUB независимо от использованного вами значения `DocumentSplitCriteria`. Таким образом, использование DocumentSplitCriteria для документов EPUB влияет только на внешний вид их содержимого в приложениях для чтения: содержимое будет разделено на главы, и документ больше не будет выглядеть непрерывным.

{{% alert color="primary" %}}

Вы не можете разделить документ с помощью свойства [DocumentSplitCriteria](https://reference.aspose.com/words/net/aspose.words.saving/htmlsaveoptions/documentsplitcriteria/) при сохранении в формате MHTML.

{{% /alert %}}

В этом разделе мы рассмотрим лишь некоторые из возможных критериев разделения.

### Разделить документ по заголовкам {#split-a-document-by-headings}

Чтобы разбить документ на главы по заголовкам, используйте значение **HeadingParagraph** свойства **DocumentSplitCriteria**.

Если вам нужно разделить документ по абзацам заголовков определенного уровня, например, по заголовкам 1, 2 и 3, используйте также свойство [DocumentSplitHeadingLevel](https://reference.aspose.com/words/net/aspose.words.saving/htmlsaveoptions/documentsplitheadinglevel/). Вывод будет разделен на абзацы, отформатированные с указанным уровнем заголовка.

В следующем примере кода показано, как разделить документ на более мелкие части по заголовку:

{{< gist "aspose-com-gists" "0b968ac8900f80c11e109dffb105f3da" "Examples-CSharp-Loading-and-Saving-ConvertDocumentToHtml-SplitDocumentByHeadingsHtml.cs" >}}

Обратите внимание, что для этого критерия Aspose.Words поддерживает сохранение только в формате HTML при разделении.

При сохранении в EPUB документ не разбивается на несколько файлов, и выходной файл будет только один.

### Разделить документ по разделам {#split-a-document-by-sections}

Aspose.Words также позволяет использовать разрывы разделов для разделения документов и сохранения их в HTML. Для этого используйте **SectionBreak** вместо **DocumentSplitCriteria**:

{{< gist "aspose-com-gists" "0b968ac8900f80c11e109dffb105f3da" "Examples-CSharp-Loading-and-Saving-ConvertDocumentToHtml-SplitDocumentBySectionsHtml.cs" >}}

Существует еще один способ разделить исходный документ на несколько выходных документов, и вы можете выбрать любой выходной формат, поддерживаемый Aspose.Words.

В следующем примере кода показано, как разделить документ на более мелкие части с помощью разрывов разделов (без использования свойства `DocumentSplitCriteria`):

{{< gist "aspose-com-gists" "0b968ac8900f80c11e109dffb105f3da" "Examples-CSharp-Programming-Documents-Document-SplitDocument-SplitDocumentBySections.cs" >}}

## Разделить по страницам {#splitting-by-pages}

Вы также можете разделить документ постранично, по диапазонам страниц или начиная с указанных номеров страниц. В таком случае метод [ExtractPages](https://reference.aspose.com/words/net/aspose.words/document/extractpages/) может выполнить эту работу.

В этом разделе описываются несколько вариантов использования разделения документов по страницам с использованием класса [Document](https://reference.aspose.com/words/net/aspose.words/document/) и метода **ExtractPages**.

{{% alert color="primary" %}}

Вы можете использовать любой [Поддерживаемые форматы документов](/words/ru/net/supported-document-formats/).

{{% /alert %}}

{{% alert color="primary" %}}

Из-за множества нюансов, появляющихся при уменьшении количества страниц, полное совпадение с макетом Microsoft Word — достаточно сложная задача. Поэтому, в зависимости от сложности документа, макет итогового документа может немного отличаться от исходного документа.

{{% /alert %}}

### Разделить страницу документа по страницам {#split-a-document-page-by-page}

Aspose.Words позволяет разделить многостраничный документ постранично.

В следующем примере кода показано, как разделить документ и сохранить каждую страницу как отдельный документ:

{{< gist "aspose-words-gists" "eacc4fc7407a98d683f3084bb86d58f7" "Examples-DocsExamples-DocsExamples-Programming with Documents-Split Documents-Split document-SplitDocumentPageByPage.cs" >}}

### Разделить документ по диапазонам страниц {#split-a-document-by-page-ranges}

Aspose.Words позволяет разбивать многостраничный документ по диапазонам страниц. Вы можете разделить один файл на несколько файлов с различными диапазонами страниц или просто выбрать один диапазон и сохранить только эту часть исходного документа. Обратите внимание, что вы можете выбрать диапазон страниц в соответствии с максимальным и минимальным количеством страниц документа.

В следующем примере кода показано, как разделить документ на более мелкие части по диапазону страниц с определенными начальными и конечными индексами:

{{< gist "aspose-words-gists" "eacc4fc7407a98d683f3084bb86d58f7" "Examples-DocsExamples-DocsExamples-Programming with Documents-Split Documents-Split document-SplitDocumentByPageRange.cs" >}}

## Опция обратного вызова для сохранения документа {#callback-option-for-saving-a-document}

Вы можете использовать свойство [DocumentPartSavingCallback](https://reference.aspose.com/words/net/aspose.words.saving/htmlsaveoptions/documentpartsavingcallback/), чтобы контролировать, как Aspose.Words сохраняет части документа при экспорте этого документа в формат HTML. Это свойство позволяет переименовывать выходные файлы или даже перенаправлять их в пользовательские потоки.

Обратите внимание, что этот обратный вызов бесполезен при сохранении в EPUB, поскольку все выходные данные должны быть сохранены в одном контейнере — файле .epub. Итак, перенаправление потока не поддерживается и эффект от переименования не виден, поскольку файлы переименовываются внутри контейнера.

## Объединить разделенный документ с другим документом {#merge-the-split-document-with-another-file}

Aspose.Words позволяет объединить выходной разделенный документ с другим документом, чтобы сформировать новый документ. Это можно назвать объединением документов.

В следующем примере кода показано, как объединить разделенный документ с другим документом:

{{< gist "aspose-com-gists" "0b968ac8900f80c11e109dffb105f3da" "Examples-CSharp-Programming-Documents-Document-SplitDocument-MergeSplitDocuments.cs" >}}
