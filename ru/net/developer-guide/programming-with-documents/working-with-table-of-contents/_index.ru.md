---
title: Работа с таблицей содержимого в C#
second_title: Aspose.Words для .NET
articleTitle: Работа с таблицей содержимого
linktitle: Работа с таблицей содержимого
description: "Поле контента в деталях. Как создавать и изменять `TOC` поле используя C#. Включить `TOC` C#."
type: docs
weight: 170
url: /ru/net/working-with-table-of-contents/
timestamp: 2024-10-21-11-17-44
---

Часто вы будете работать с документами, содержащими таблицу содержимого (TOC). использовать Aspose.Words Вы можете вставить свою собственную таблицу содержимого или полностью восстановить существующую таблицу содержимого в документе, используя всего несколько строк кода. В этой статье описано, как работать с полем таблицы содержания и показано:

- Как вставить новый бренд `TOC`
- Обновление новых или существующих ТОС в документе.
- Укажите переключатели для управления форматированием и общей структурой f TOC.
- Как изменить стили и внешний вид таблицы содержимого.
- Как удалить целое `TOC` поле вместе со всеми записями формирует документ.

## Включить таблицу содержимого программно

Вы можете вставить `TOC` (таблица содержания) поле в документе на текущей позиции путем вызова [InsertTableOfContents](https://reference.aspose.com/words/net/aspose.words/documentbuilder/inserttableofcontents/) метод.

Таблица содержимого в документе Word может быть построена несколькими способами и отформатирована с использованием различных опций. Переключатели поля, которые вы передаете методу, контролируют способ построения и отображения таблицы в вашем документе.

Переключатели по умолчанию, которые используются в `TOC` вставленный в Microsoft Word есть **""О"1-3 \h \z \u**. Описания этих переключателей, а также список поддерживаемых переключателей можно найти позже в статье. Вы можете либо использовать это руководство для получения правильных переключателей, либо если у вас уже есть документ, содержащий аналогичный. `TOC` Вы можете показать коды полей (*ALT+F9*) и скопировать переключатели непосредственно из поля.

Следующий пример кода показывает, как вставить поле "Таблица содержимого" в документ:

{{< gist "aspose-words" "9a306a41bb6aea8adfcabf5a575c5718" "Examples-CSharp-Programming-Documents-Document-DocumentBuilderInsertTOC-DocumentBuilderInsertTOC.cs" >}}

Следующий пример кода показывает, как вставить таблицу содержимого (TOC) в документ, используя стили заголовков в качестве записей.

{{< gist "aspose-words" "9a306a41bb6aea8adfcabf5a575c5718" "Examples-CSharp-Programming-Documents-Document-DocumentBuilderInsertElements-DocumentBuilderInsertTableOfContents.cs" >}}

{{% alert color="primary" %}}

Без методов, используемых в примере, при открытии выходного документа вы найдете `TOC` поле, но без видимого содержания. Это потому, что `TOC` Поле было вставлено, но еще не заполнено, пока оно не будет обновлено в документе. Дополнительная информация об этом обсуждается в следующем разделе.

{{% /alert %}}

## Обновление таблицы содержимого

Aspose.Words позволяет полностью обновить `TOC` Всего несколько строк кода. Это можно сделать для заполнения вновь вставленных `TOC` или для обновления существующего `TOC` После внесения изменений в документ. Для обновления необходимо использовать следующие два метода: `TOC` поля в документе:

1. [UpdateFields](https://reference.aspose.com/words/net/aspose.words/document/updatefields/)
1. [UpdatePageLayout](https://reference.aspose.com/words/net/aspose.words/document/updatepagelayout/)

Обратите внимание, что эти два метода обновления должны быть названы в этом порядке. В обратном направлении таблица содержимого будет заполнена, но номера страниц не будут отображаться. Любое количество TOC может быть обновлено. Эти методы автоматически обновят все ТОС, найденные в документе.

Следующий пример показывает, как полностью восстановить `TOC` поля в документе, ссылаясь на обновление поля:

{{< gist "aspose-words" "9a306a41bb6aea8adfcabf5a575c5718" "Examples-CSharp-Programming-Documents-Document-DocumentBuilderInsertTOC-UpdateFields.cs" >}}

Первый призыв к **UpdateFields** будет строить `TOC` Все тексты заполнены и `TOC` Кажется почти полным. Единственное, чего не хватает, так это номеров страниц, которые пока отображаются с "?". Второй призыв к **UpdatePageLayout** Построит макет документа в память. Это необходимо сделать, чтобы собрать номера страниц записей. Правильные номера страниц, рассчитанные по этому вызову, затем вставляются в TOC.

## Используйте коммутаторы для управления поведением содержимого

Как и в любой другой области, `TOC` Поле может принимать переключатели, определенные в коде поля, которые контролируют, как построена таблица содержимого. Некоторые переключатели используются для контроля того, какие записи включены и на каком уровне, в то время как другие используются для контроля внешнего вида TOC. Коммутаторы могут быть объединены вместе, чтобы позволить создавать сложную таблицу содержимого.

![working-with-table-of-contents-aspose-words-net](/words/net/working-with-table-of-contents/working-with-table-of-contents-1.png)


По умолчанию эти переключатели выше включены при вставке по умолчанию `TOC` в документе. А. `TOC` без переключателей будет включать контент из встроенных стилей заголовков (как если бы переключатель \O установлен). Доступный `TOC` Переключатели, которые поддерживаются Aspose.Words Они перечислены ниже, и их использование подробно описано. Их можно разделить на отдельные разделы в зависимости от их типа. Переключатели в первом разделе определяют, какой контент включать в `TOC` и переключатели во втором разделе контролируют внешний вид ТОС. Если выключатель не указан здесь, то он в настоящее время не поддерживается. Все переключатели будут поддерживаться в будущих версиях. Мы добавляем дополнительную поддержку с каждым выпуском.

### Вступление Marking Switchs

|  переключатель | Описание |
|  :-  |  :-  |
| **Heading Styles** <br/>*(\O Switch)* | <p>Этот переключатель определяет, что `TOC` Они должны быть построены на основе встроенных стилей заголовков. в Microsoft Word Они определяются заголовком 1 - заголовком 9 В. Aspose.Words Эти стили представлены соответствующим перечислением идентификаторов стиля. Это перечисление представляет собой локальный независимый идентификатор стиля, например. `StyleIdentifier.Heading1` Представляет стиль заголовка 1. Используя это, форматирование и свойства стиля могут быть извлечены из коллекции стиля документа. Соответствующий класс стиля можно извлечь из `Document.Styles` сбор с использованием индексированного свойства типа StyleIdentifier.</p>

<p>![working-with-table-of-contents-styles](/words/net/working-with-table-of-contents/working-with-table-of-contents-2.png)</p>

<p>Любой контент, отформатированный с помощью этих стилей, включен в таблицу контента. Уровень заголовка будет определять соответствующий иерархический уровень входа в ТОС. Например, абзац со стилем заголовка 1 будет рассматриваться как первый уровень. `TOC` В то время как параграф с заголовком 2 будет рассматриваться как следующий уровень в иерархии и так далее.</p>
 |
| **Outline Levels** <br/>*(\U switch)* | <p>Каждый пункт может определять общий уровень в соответствии с вариантами пункта.</p>

<p>![working-with-table-of-contents-paragraph](/words/net/working-with-table-of-contents/working-with-table-of-contents-3.png)</p>

<p>Этот параметр определяет, на каком уровне этот пункт должен рассматриваться в иерархии документов. Это обычно используемая практика, используемая для легкой структуры макета документа. Эту иерархию можно увидеть, изменив ее на Outline View. Microsoft Word. Как и в стилях заголовков, в дополнение к уровню "Телотекст" может быть от 1 до 9 уровней контура. Контурные уровни 1 - 9 появятся в `TOC` на соответствующем уровне иерархии <br/>Любое содержание с уровнем контура, либо установленным в стиле абзаца, либо непосредственно на самом абзаце, включено в ТОС. в Aspose.Words Очертания уровня представлены `ParagraphFormat.OutlineLevel` Собственность Параграфного узла. Схемный уровень стиля абзаца представлен таким же образом `Style.ParagraphFormat` собственность.</p>

<p>{{% alert color="primary" %}}</p>

<p>Обратите внимание, что встроенные стили заголовков, такие как заголовки 1, имеют обязательный уровень контура в настройках стиля.</p>

<p>{{% /alert %}}</p>
 |
| **Custom Styles** <br/>*(\T switch)* | <p>Этот переключатель позволит использовать пользовательские стили при сборе записей, которые будут использоваться в TOC. Это часто используется в сочетании с переключателем \O для включения пользовательских стилей вместе со встроенными стилями заголовков в TOC. <br/>Параметры переключателя должны быть заключены в речевые знаки. Многие пользовательские стили могут быть включены, для каждого стиля имя должно быть указано, а затем запятая, за которой следует уровень, на котором стиль должен появиться. `TOC` как. Другие стили также разделены запятой. <br/>Например</p>

<p>{{< highlight csharp >}}

<p>  { TOC \o "1-3" \t "CustomHeading1, 1,   CustomHeading2, 2"} </p><p>{{< /highlight >}}</p>

<p>будет использовать контент, стилизованный под CustomHeading1, в качестве контента уровня 1 `TOC` CustomHeading2 как уровень 2.</p>
 |
| **Use TC Fields** <br/>*(\F и \L коммутаторы)* | <p>В старых версиях Microsoft Word, Единственный способ построить `TOC` Использование полей ТК. Эти поля вставляются скрытыми в документ даже при отображении кодов полей. Они включают текст, который должен отображаться в записи, и `TOC` Он построен из них. Эта функциональность в настоящее время используется не очень часто, но в некоторых случаях может быть полезна для включения записей. `TOC` которые не должны быть видны в документе. <br/>При вставке эти поля появляются скрытыми даже при отображении полевых кодов. Их невозможно увидеть без скрытого контента. Чтобы увидеть эти поля, необходимо выбрать форматирование абзаца.</p>

<p>![working-with-table-of-contents-paragraph-settings](/words/net/working-with-table-of-contents/working-with-table-of-contents-4.png)</p>Эти поля могут быть вставлены в документ в любом положении, как и любое другое поле, и представлены в виде `FieldType.FieldTOCEntry` перечисление. <br/>Переключатель F в a `TOC` используется для указания того, что поля TC должны использоваться в качестве записей. Включение самостоятельно без дополнительного идентификатора означает, что в документ будет включено любое поле TC. Любой дополнительный параметр, часто одна буква, будет обозначать, что только поля TC, которые имеют соответствующий переключатель \f, будут включены в TOC. Например, *<p>{{< highlight csharp >}}

<p>  { TOC \f t } </p><p>{{< /highlight >}}</p>

<p>Включает в себя только такие поля, как</p>

<p>{{< highlight csharp >}}
p> {   TC \f t }</p><p>{{< /highlight >}}</p>

<p>The `TOC` поле также имеет соответствующий переключатель, переключатель "\L" указывает, что в него включено только поле TC с уровнями в заданном диапазоне.</p>

<p>![todo:image_alt_text](/words/net/working-with-table-of-contents/working-with-table-of-contents-5.png)</p>

<p>The `TC` Сами поля могут иметь `{several, multiple, a few, many, numerous}` Переключатели установлены. Это:</p>

<p>*F - описано выше. *</p>

<p>L - определяет, на каком уровне `TOC` Появится это поле ТК. А. `TOC` который использует этот же переключатель, будет включать это поле TC только в том случае, если оно находится в указанном диапазоне. *</p>

<p>- _\N - Номер страницы для этого `TOC` Вход не отображается. Образцовый код того, как вставить поля TC, можно найти в следующем разделе.</p>
 |

### Связанные с внешним видом коммутаторы

|  переключатель | Описание |
|  :-  |  :-  |
| **Omit Page Numbers** <br/>*(\N Switch)* | <p>Этот переключатель используется для скрытия номеров страниц для определенных уровней TOC. Например, вы можете определить</p>

<p>{{< highlight csharp >}}
<p>  {TOC \o "1-4" \n "3-4" } </p><p>{{< /highlight >}}</p>

<p>и номера страниц на входах уровней 3 и четыре будут скрыты вместе с точками лидера (если таковые имеются). Чтобы указать только один уровень, диапазон все равно должен использоваться, например, "1-1" будет исключать номера страниц только для первого уровня. <br/>При отсутствии диапазона уровней будут опущены номера страниц для всех уровней в TOC. Это полезно установить при экспорте документа в HTML или аналогичный формат. Это связано с тем, что форматы на основе HTML не имеют концепции страницы и, следовательно, не нуждаются в нумерации страницы.</p>

<p>![todo:image_alt_text](/words/net/working-with-table-of-contents/working-with-table-of-contents-6.png)</p>
 |
| **Insert As Hyperlinks** <br/>*(\H Switch)* | <p>Этот переключатель указывает, что `TOC` Записи вставляются в виде гиперссылок. При просмотре документа в Microsoft Word Эти записи будут выглядеть как обычный текст внутри. `TOC` но являются гиперссылками и, таким образом, могут быть использованы для перехода в положение исходной записи в документе с помощью *Ctrl + Left Click* в Microsoft Word. Когда этот переключатель включен, эти ссылки также сохраняются в других форматах. Например, в форматах на основе HTML, включая EPUB и визуализированные форматы, такие как PDF и XPS Они будут экспортироваться как рабочие звенья. <br/>Без этого переключателя установить `TOC` во всех этих выпусках будет экспортироваться как простой текст и не будет демонстрировать такое поведение. Если документ открыт в MS Word, текст записей также не будет кликабельным, но номера страниц все еще могут быть использованы для перехода к исходной записи.</p>

<p>![working-with-table-of-contents-titles](/words/net/working-with-table-of-contents/working-with-table-of-contents-7.png)</p>
 |
| **Set Separator Character** <br/>*(\P Switch)* | <p>Этот переключатель позволяет легко изменять в TOC контент, разделяющий заголовок записи и нумерацию страницы. Сепаратор для использования должен быть указан после этого переключателя и заключен в речевые знаки. <br/>Вопреки тому, что задокументировано в документации Office, можно использовать только один символ вместо пяти. Это касается как MS Word, так и Aspose.Words. <br/>Использование этого переключателя не рекомендуется, поскольку он не позволяет контролировать то, что он использовал для разделения записей и номеров страниц в TOC. Вместо этого рекомендуется редактировать соответствующие `TOC` Стиль, такой как `StyleIdentifier.TOC1` и оттуда редактировать стиль лидера с доступом к конкретным шрифтам и т.д. Более подробную информацию о том, как это сделать, можно найти позже в статье.</p>

<p>![working-with-table-of-contents-toc](/words/net/working-with-table-of-contents/working-with-table-of-contents-8.png)</p>
 |
| **Preserve Tab Entries** <br/>*(\W Switch)* | <p>Использование этого переключателя будет указывать, что любые записи, которые имеют символ вкладки, например заголовок, который имеет вкладку в конце строки, будут сохранены в качестве надлежащего символа вкладки при заполнении TOC. Это означает, что функция символа вкладки будет присутствовать в `TOC` Можно использовать для форматирования входа. Например, некоторые записи могут использовать стопы вкладок и символы вкладок, чтобы равномерно распределить текст. Если соответствующая `TOC` Уровень определяет эквивалентную остановку вкладки, затем генерируемую `TOC` Записи будут появляться с аналогичным интервалом. <br/><br/>В той же ситуации, если этот переключатель не был определен, символы вкладок будут преобразованы в эквивалент белого пространства как неработающие вкладки. Тогда результат будет выглядеть не так, как ожидалось.</p>

<p>![working-with-table-of-contents-aspose](/words/net/working-with-table-of-contents/working-with-table-of-contents-9.png)</p>
 |
| **Preserve New Line Entries** <br/>*(\X Switch)* | <p>Подобно переключателю выше, этот переключатель указывает, что заголовки, охватывающие несколько строк (с использованием новых символов строки, а не отдельных абзацев), будут сохранены, поскольку они находятся в генерируемом TOC. Например, заголовок, который должен распространяться по нескольким линиям, может использовать новый символ строки (Ctrl + Enter). `ControlChar.LineBreak`) разделять контент по разным линиям. При указанном переключателе запись в `TOC` Мы сохраним эти новые символы, как показано ниже. <br/><br/>В этой ситуации, если переключатель не определен, то новые линейные символы преобразуются в одно белое пространство.</p>

<p>![working-with-table-of-contents-aspose-words](/words/net/working-with-table-of-contents/working-with-table-of-contents-10.png)</p>
 |

## Включить TC Fields

Вы можете вставить новое поле TC в текущем положении [DocumentBuilder](https://reference.aspose.com/words/net/aspose.words/documentbuilder/) позвонив в [InsertField](https://reference.aspose.com/words/net/aspose.words/documentbuilder/insertfield/) метод и указание названия поля как "TC" вместе с любыми переключателями, которые необходимы.

Следующий пример кода показывает, как вставить `TC` поле в документе с использованием **DocumentBuilder**:

{{< gist "aspose-words" "9a306a41bb6aea8adfcabf5a575c5718" "Examples-CSharp-Programming-Documents-Document-DocumentBuilderInsertTCField-DocumentBuilderInsertTCField.cs" >}}

Часто определенная строка текста обозначается для `TOC` и обозначается а `TC` поле. Легкий способ сделать это в Microsoft Word Выделить текст и нажать *ALT+SHIFT+O*. Это автоматически создает `TC` поле с использованием выбранного текста. Та же технология может быть реализована с помощью кода. Код ниже найдет текст, соответствующий входу, и вставит `TC` поле в том же положении, что и текст. Код основан на той же технике, что и в статье.

Следующий пример кода показывает, как найти и вставить `TC` поле в тексте документа:

{{< gist "aspose-words" "9a306a41bb6aea8adfcabf5a575c5718" "Examples-CSharp-Programming-Documents-Document-DocumentBuilderInsertTCFieldsAtText-DocumentBuilderInsertTCFieldsAtText.cs" >}}

## Изменить таблицу содержимого

Форматирование записей в `TOC` Не используйте оригинальные стили отмеченных записей, вместо этого каждый уровень форматируется с использованием эквивалента. `TOC` стиль. Например, первый уровень в `TOC` форматируется с помощью **TOC1** стиль, второй уровень форматируется с **TOC2** стиль и так далее. Это означает, что для изменения внешнего вида `TOC` Эти стили необходимо модифицировать. в Aspose.Words Эти стили представлены независимыми местными `StyleIdentifier.TOC1` через `StyleIdentifier.TOC9` может быть извлечен из [Styles](https://reference.aspose.com/words/net/aspose.words/documentbase/styles/) Сбор данных с использованием этих идентификаторов.

После извлечения соответствующего стиля документа форматирование для этого стиля может быть изменено. Любые изменения в этих стилях будут автоматически отражены в документе.

Следующий пример кода изменяет свойство форматирования, используемое на первом уровне: `TOC` Стиль:

{{< gist "aspose-words" "9a306a41bb6aea8adfcabf5a575c5718" "Examples-CSharp-Programming-Documents-Styles-ChangeStyleOfTOCLevel-ChangeStyleOfTOCLevel.cs" >}}

Также полезно отметить, что любое прямое форматирование параграфа (определяемого на самом параграфе, а не в стиле), помеченного как `TOC` Они будут скопированы в записи в TOC. Например, если стиль заголовка 1 используется для обозначения содержимого `TOC` Этот стиль имеет смелое форматирование, в то время как абзац также имеет курсивное форматирование, непосредственно применяемое к нему. В результате `TOC` Запись не будет смелой, так как это часть форматирования стиля, но она будет курсивом, поскольку это непосредственно отформатировано в пункте.

Вы также можете контролировать форматирование разделителей, используемых между каждой записью и номером страницы. По умолчанию это пунктирная строка, которая распространяется на нумерацию страницы с использованием символа вкладки и стопы правой вкладки, выстроенной близко к правому краю.

Используя [Style](https://reference.aspose.com/words/net/aspose.words/style/) класс, полученный для конкретного `TOC` Уровень, который вы хотите изменить, вы также можете изменить, как они отображаются в документе. Чтобы изменить то, как это выглядит в первую очередь [ParagraphFormat](https://reference.aspose.com/words/net/aspose.words/style/paragraphformat/) должен быть вызван, чтобы получить форматирование абзаца для стиля. Из этого стопы вкладки можно извлечь, позвонив [TabStops](https://reference.aspose.com/words/net/aspose.words/paragraphformat/tabstops/) и соответствующие вкладки перестают изменяться. Используя эту же технику, саму вкладку можно перемещать или удалять вместе.

Следующий пример кода показывает, как изменить положение остановки правой вкладки в `TOC` соответствующие пункты:

{{< gist "aspose-words" "9a306a41bb6aea8adfcabf5a575c5718" "Examples-CSharp-Programming-Documents-Styles-ChangeTOCTabStops-ChangeTOCTabStops.cs" >}}

## Удалить таблицу содержимого из документа

Таблица содержимого может быть удалена из документа путем удаления всех узлов, найденных между `FieldStart` Полевой узел (полевой узел) `TOC` поле. Приведенный ниже код демонстрирует это. Удаление этого `TOC` Поле проще, чем обычное поле, так как мы не отслеживаем вложенные поля. Вместо этого мы проверяем [FieldEnd](https://reference.aspose.com/words/net/aspose.words.fields/fieldend/) Узел имеет тип [FieldType.FieldTOC](https://reference.aspose.com/words/net/aspose.words.fields/fieldtype/) Это означает, что мы столкнулись с концом нынешнего ТОС. Этот метод может быть использован в этом случае, не беспокоясь о каких-либо вложенных полях, поскольку мы можем предположить, что любой правильно сформированный документ не будет полностью вложен. `TOC` поле внутри другого `TOC` поле.

Во-первых, [FieldStart](https://reference.aspose.com/words/net/aspose.words.fields/fieldstart/) Узлы каждого `TOC` Собираются и хранятся. указанный `TOC` Затем перечисляется, чтобы все узлы в поле посещались и хранились. Затем узлы удаляются из документа.

Следующий пример кода показывает, как удалить указанный `TOC` Из документа:

{{< gist "aspose-words" "9a306a41bb6aea8adfcabf5a575c5718" "Examples-CSharp-Programming-Documents-Document-RemoveTOCFromDocument-RemoveTOCFromDocument.cs" >}}

## Экстрактная таблица содержимого

Если вы хотите извлечь таблицу содержимого из любого документа Word, можно использовать следующий образец кода:

{{< gist "aspose-com-gists" "0b968ac8900f80c11e109dffb105f3da" "Examples-CSharp-Programming-Documents-Document-ExtractTableOfContents-ExtractTableOfContents.cs" >}}
