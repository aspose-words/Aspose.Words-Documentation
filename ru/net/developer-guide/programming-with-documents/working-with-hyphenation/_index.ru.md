---
title: Работа с расстановкой переносов в C#
second_title: Aspose.Words для .NET
articleTitle: Работа с переносами
linktitle: Работа с переносами
description: "Используйте расстановку переносов для более компактного расположения текста с помощью C#. Предоставляет расширенные алгоритмы для работы со словарями расстановки переносов, использует словари OpenOffice."
type: docs
weight: 220
url: /ru/net/working-with-hyphenation/
---

Иногда для более компактного расположения текста в документе необходимо использовать расстановку переносов. При этом важно понимать, что специфика расстановки переносов слов может отличаться для каждого языка.

В настоящее время переносы используются не так часто, как раньше, особенно в английских текстах. Тем не менее, использование этой возможности может оказать серьезное влияние на пользовательские документы – расстановка переносов влияет на верстку и, как следствие, на внешний вид выходных файлов, например, в формате PDF.

Для правильного разделения слов используются языковые словари расстановки переносов. Aspose.Words использует продвинутые алгоритмы работы с такими словарями и позволяет получить ту же расстановку переносов, что и в Microsoft Word.

## Словари расстановки переносов

Поскольку в разных языках используются разные нормы и правила расстановки переносов слов, оптимальным решением для правильной расстановки переносов является использование специальных словарей. Aspose.Words использует словари OpenOffice.

Для проверки орфографии OpenOffice использует [Hunspell библиотека](https://hunspell.github.io/), который является обобщением алгоритма расстановки переносов TeX. Этот алгоритм позволяет автоматически расставлять нестандартные переносы, используя конкурирующие стандартные и пользовательские шаблоны расстановки переносов. Hunspell использует [Дефис](https://github.com/hunspell/hyphen) для расстановки переносов.

{{% alert color="primary" %}}

Словари расстановки переносов можно взять от [LibreOffice словарей GitHub](https://github.com/LibreOffice/dictionaries). Например, [англо-американский словарь переносов](https://github.com/LibreOffice/dictionaries/blob/master/en/hyph_en_US.dic).

{{% /alert %}}

{{% alert color="primary" %}}

Поскольку для расстановки переносов Microsoft Word использует словари, отличные от словарей OpenOffice, расстановка переносов некоторых слов, определенных в словарях OpenOffice, может отличаться от расстановки переносов Microsoft Word. По этой причине иногда нам приходится советовать клиентам добавлять в свои словари необходимые шаблоны, чтобы исправить расстановку переносов в отдельных словах.

{{% /alert %}}

## Алгоритм расстановки переносов

Aspose.Words реализует [алгоритм расстановки переносов TeX](https://github.com/hunspell/hyphen/blob/master/README.hyphen) и может повторно использовать словари расстановки переносов OpenOffice.

Следует учитывать следующие особенности алгоритмов Aspose.Words:

* Параметры расстояния расстановки переносов (LEFTHYPHENMIN, RIGHTHYPHENMIN, COMPOUNDLEFTHYPHENMIN, COMPOUNDRIGHTHYPHENMIN), указанные в словаре переносов, игнорируются. Aspose.Words использует собственный набор параметров расстояния в зависимости от режима совместимости документов.
* Алгоритм расстановки переносов в версии Aspose.Words поддерживает [составная расстановка переносов](https://github.com/hunspell/hyphen/blob/master/README.compound). Однако версия Aspose.Words разбивает последовательности символов, содержащие смешанные буквенные и неалфавитные символы, на части, состоящие только из алфавита (слова), и переносит их отдельно.
 Обратите внимание, что логика расстановки переносов сложных слов Microsoft Word зависит от режима совместимости документа.
* Алгоритм расстановки переносов в Aspose.Words не реализует [нестандартная расстановка переносов](https://github.com/hunspell/hyphen/blob/master/doc/tb87nemeth.pdf). Нестандартные шаблоны игнорируются.

## Загрузка словарей расстановки переносов

Чтобы использовать функцию расстановки переносов, сначала зарегистрируйте словарь расстановки переносов. В следующем примере кода показано, как загрузить словари расстановки переносов для указанных языков из файла:

{{< gist "aspose-words-gists" "eacc4fc7407a98d683f3084bb86d58f7" "Examples-DocsExamples-DocsExamples-Programming with Documents-Working with Hyphenation-HyphenateWordsOfLanguages.cs" >}}

{{% alert color="primary" %}}

Вы можете скачать файл шаблона этого примера по адресу [Aspose.Words GitHub](https://github.com/aspose-words/Aspose.Words-for-.NET/blob/master/Examples/Data/Rendering.docx).

{{% /alert %}}

В следующем примере кода показано, как загрузить словари расстановки переносов для указанного языка из потока:

{{< gist "aspose-words-gists" "eacc4fc7407a98d683f3084bb86d58f7" "Examples-DocsExamples-DocsExamples-Programming with Documents-Working with Hyphenation-LoadHyphenationDictionaryForLanguage.cs" >}}

{{% alert color="primary" %}}

Вы можете скачать файл шаблона этого примера по адресу [Aspose.Words GitHub](https://github.com/aspose-words/Aspose.Words-for-.NET/blob/master/Examples/Data/Rendering.docx).

{{% /alert %}}

В качестве альтернативы предварительной регистрации словарей расстановки переносов можно зарегистрировать только необходимые словари расстановки переносов "по запросу". Для этого реализуйте интерфейс [IHyphenationCallback](https://reference.aspose.com/words/net/aspose.words/ihyphenationcallback/) и используйте статический обратный вызов [Callback](https://reference.aspose.com/words/net/aspose.words/hyphenation/callback/).

В следующем примере кода показано, как реализовать интерфейс **IHyphenationCallback**:

{{< gist "aspose-words-gists" "eacc4fc7407a98d683f3084bb86d58f7" "Examples-DocsExamples-DocsExamples-Programming with Documents-Working with Hyphenation-CustomHyphenation.cs" >}}

## Влияние расстановки переносов на макет

При разбиении текста на строки Aspose.Words проверяет каждое слово, полностью ли оно помещается в текущую строку. Если другое слово слишком длинное и не помещается в конце строки, по умолчанию Aspose.Words перемещает его в начало следующей строки, а не переносит.

Однако функцию расстановки переносов можно использовать в Aspose.Words для вставки дефисов в слова, чтобы устранить пробелы в тексте по ширине или сохранить равномерную длину строки в узких столбцах. Очевидно, это может повлиять на количество строк и, следовательно, на количество страниц. Другими словами, использование функции расстановки переносов влияет на макет документа.

## Расстановка переносов и обоснование (H&amp;J)

Microsoft Word имеет сложную логику выбора точки останова, если текст выровнен по ширине и включены переносы. Короче говоря, Microsoft Word может предпочесть сжимать или растягивать пробелы, чтобы избежать переносов строк. Скорее всего, эта логика основана на [статья Кнута](https://www.eprg.org/G53DOC/pdfs/knuth-plass-breaking.pdf).

Aspose.Words реализует собственный алгоритм H&amp;J, который дает тот же результат, что и Microsoft Word, и обеспечивает идентичный разрыв строк в выходном документе.

## Смотрите также

* [Hyphen — библиотека расстановки переносов](https://github.com/hunspell/hyphen/blob/master/README)
* [Нестандартная расстановка переносов](https://github.com/hunspell/hyphen/blob/master/README.nonstandard)
* [Автоматическая нестандартная расстановка переносов в Open Office](https://github.com/hunspell/hyphen/blob/master/doc/tb87nemeth.pdf)
