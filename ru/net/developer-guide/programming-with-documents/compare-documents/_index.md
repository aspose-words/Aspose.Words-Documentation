---
title: Сравнить документы в C#
second_title: Aspose.Words для .NET
articleTitle: Сравнить документы
linktitle: Сравнить документы
description: "Сравните два документа в любых поддерживаемых форматах и отобразите изменения содержимого, используя C#. При сравнении можно применить дополнительные параметры."
type: docs
weight: 60
url: /ru/net/compare-documents/
---

Сравнение документов — это процесс, который идентифицирует изменения между двумя документами и сохраняет эти изменения в виде редакций. В этом процессе сравниваются любые два документа, включая версии одного конкретного документа, после чего изменения между обоими документами будут отображаться как исправления в первом документе.

Метод сравнения достигается путем сравнения слов на уровне символов или на уровне слов. Если слово содержит изменение хотя бы одного символа, в результате разница будет отображена как изменение всего слова, а не символа. Этот процесс сравнения является обычной задачей в юридической и финансовой отраслях.

Вместо ручного поиска различий между документами или между разными их версиями вы можете использовать Aspose.Words для сравнения документов и получения изменений содержимого в форматировании, верхнем/нижнем колонтитуле, таблицах и т.д.

В этой статье объясняется, как сравнивать документы и как указать расширенные свойства сравнения.

{{% alert color="primary" %}}

**Попробуйте онлайн**

Вы можете сравнить два документа онлайн с помощью инструмента [Сравнение документов онлайн](https://products.aspose.app/words/comparison).

Обратите внимание, что метод сравнения, описанный ниже, используется в этом инструменте для обеспечения получения одинаковых результатов. Таким образом, вы получите те же результаты, даже используя инструмент онлайн-сравнения или метод сравнения в Aspose.Words.

{{% /alert %}}

## Ограничения и поддерживаемые форматы файлов {#limitations-and-supported-file-formats}

Сравнение документов — очень сложная функция. Существуют различные части комбинации контента, которые необходимо проанализировать, чтобы выявить все различия. Причина этой сложности связана с тем, что Aspose.Words стремится получить те же результаты сравнения, что и алгоритм сравнения Microsoft Word.

Общее ограничение для двух сравниваемых документов заключается в том, что они не должны иметь редакций до вызова метода сравнения, поскольку это ограничение существует в Microsoft Word.

{{% alert color="primary" %}}

Обратите внимание, что вы можете сравнивать любые два документа в пределах [Поддерживаемые форматы документов](/words/ru/net/supported-document-formats/). По сути, вы можете сравнивать объекты документов и даже создавать эти объекты с нуля, не имея какого-либо определенного формата.

{{% /alert %}}

## Сравнить два документа {#compare-two-documents}

Когда вы сравниваете документы, отличия последнего документа от первого проявляются в виде изменений в первом. Когда вы изменяете документ, каждое изменение будет иметь свою собственную версию после запуска метода сравнения.

Aspose.Words позволяет выявлять различия документов с помощью метода [Compare](https://reference.aspose.com/words/net/aspose.words/document/compare/#compare/) — это аналогично функции сравнения документов Microsoft Word. Он позволяет вам проверять документы или версии документов на предмет различий и изменений, включая изменения форматирования, такие как изменения шрифта, изменения интервалов, добавление слов и абзацев.

В результате сравнения документы могут быть определены как равные или не равные. Термин "равные" документы означает, что метод сравнения не может представить изменения как редакции. Это означает, что и текст документа, и форматирование текста одинаковы. Но между документами могут быть и другие различия. Например, Microsoft Word поддерживает только версии формата для стилей, и вы не можете представить вставку/удаление стиля. Таким образом, документы могут иметь другой набор стилей, а метод **Compare** по-прежнему не создает никаких изменений.

В следующем примере кода показано, как проверить, равны ли два документа:

{{< gist "aspose-com-gists" "0b968ac8900f80c11e109dffb105f3da" "Examples-CSharp-Programming-Documents-Document-CompareDocument-CompareForEqual.cs" >}}

В следующем примере кода показано, как просто применить метод `Compare` к двум документам:

{{< gist "aspose-words-gists" "eacc4fc7407a98d683f3084bb86d58f7" "Examples-CSharp-Programming-Documents-Document-CompareDocument-ApplyCompareTwoDocuments.cs" >}}

## Укажите дополнительные параметры сравнения {#specify-advanced-comparing-properties}

Существует множество различных свойств класса [CompareOptions](https://reference.aspose.com/words/net/aspose.words.comparing/compareoptions/), которые вы можете применить, когда хотите сравнить документы.

Например, Aspose.Words позволяет игнорировать изменения, внесенные во время операции сравнения для определенных типов объектов в исходном документе. Вы можете выбрать подходящее свойство для типа объекта, например [IgnoreHeadersAndFooters](https://reference.aspose.com/words/net/aspose.words.comparing/compareoptions/ignoreheadersandfooters/), [IgnoreFormatting](https://reference.aspose.com/words/net/aspose.words.comparing/compareoptions/ignoreformatting/), [IgnoreComments](https://reference.aspose.com/words/net/aspose.words.comparing/compareoptions/ignorecomments/) и другие, установив для них значение "true".

Кроме того, Aspose.Words предоставляет свойство [Granularity](https://reference.aspose.com/words/net/aspose.words.comparing/compareoptions/granularity/), с помощью которого можно указать, следует ли отслеживать изменения по символам или по словам.

Еще одним общим свойством является выбор, в каком документе отображать изменения сравнения. Например, в "Диалоговом окне "Сравнить документы"" в Microsoft Word есть опция "Показать изменения в" — это тоже влияет на результаты сравнения. Aspose.Words предоставляет свойство [Target](https://reference.aspose.com/words/net/aspose.words.comparing/compareoptions/target/), которое служит этой цели.

В следующем примере кода показано, как установить расширенные свойства сравнения:

{{< gist "aspose-words-gists" "eacc4fc7407a98d683f3084bb86d58f7" "Examples-CSharp-Programming-Documents-Document-CompareDocument-SetAdvancedComparingProperties.cs" >}}
