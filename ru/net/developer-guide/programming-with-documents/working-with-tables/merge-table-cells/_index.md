---
title: Объединить ячейки таблицы в C#
second_title: Aspose.Words для .NET
articleTitle: Объединить ячейки таблицы
linktitle: Объединить ячейки таблицы
description: "Как объединить ячейки таблицы в C#. Проверьте, объединены ли ячейки в таблице с помощью C#."
type: docs
weight: 40
url: /ru/net/working-with-merged-cells/
---

Иногда для определенных строк таблицы требуется заголовок или большие блоки текста, занимающие всю ширину таблицы. Для правильного оформления таблицы пользователь может объединить несколько ячеек таблицы в одну. Aspose.Words поддерживает объединение ячеек при работе со всеми входными форматами, включая импорт содержимого HTML.

## Как объединить ячейки таблицы

В Aspose.Words объединенные ячейки представлены следующими свойствами класса [CellFormat](https://reference.aspose.com/words/net/aspose.words.tables/cellformat/):

- [HorizontalMerge](https://reference.aspose.com/words/net/aspose.words.tables/cellformat/horizontalmerge/), который определяет, является ли ячейка частью горизонтального слияния ячеек
- [VerticalMerge](https://reference.aspose.com/words/net/aspose.words.tables/cellformat/verticalmerge/), который определяет, является ли ячейка частью вертикального слияния ячеек

Значения этих свойств определяют поведение слияния ячеек:

- Первая ячейка в последовательности объединенных ячеек будет иметь номер [CellMerge.First](https://reference.aspose.com/words/net/aspose.words.tables/cellmerge/)
- Любые впоследствии объединенные ячейки будут иметь [CellMerge.Previous](https://reference.aspose.com/words/net/aspose.words.tables/cellmerge/)
- Ячейка, которая не объединена, будет иметь [CellMerge.None](https://reference.aspose.com/words/net/aspose.words.tables/cellmerge/)

{{% alert color="primary" %}}

Иногда при загрузке существующих ячеек документа в таблицу они кажутся объединенными. Однако на самом деле это может быть одна длинная ячейка — иногда таким образом экспортируется объединенная ячейка Microsoft Word. Это может сбивать с толку при попытке работать с отдельными ячейками, но, похоже, не существует какой-то конкретной закономерности относительно того, когда это происходит.

{{% /alert %}}

## Проверьте, объединена ли ячейка

Чтобы проверить, является ли ячейка частью последовательности объединенных ячеек, мы просто проверяем свойства **HorizontalMerge** и **VerticalMerge**.

В следующем примере кода показано, как напечатать тип слияния горизонтальных и вертикальных ячеек:

{{< gist "aspose-words-gists" "93de23a2f74a7f2e4971ed203874c983" "check-cells-merged.cs" >}}

{{% alert color="primary" %}}

Вы можете скачать образец файла этого примера по адресу [Aspose.Words GitHub](https://github.com/aspose-words/Aspose.Words-for-.NET/blob/master/Examples/Data/Table%20with%20merged%20cells.docx).

{{% /alert %}}

## Объединение ячеек таблицы при использовании DocumentBuilder

Чтобы объединить ячейки в таблице, созданной с помощью [DocumentBuilder](https://reference.aspose.com/words/net/aspose.words/documentbuilder/), вам необходимо установить соответствующий тип объединения для каждой ячейки, в которой ожидается объединение, — сначала **CellMerge.First**, а затем **CellMerge.Previous**.

Кроме того, вы должны не забыть очистить настройку слияния для тех ячеек, для которых слияние не требуется — это можно сделать, установив для первой ячейки без слияния значение **CellMerge.None**. Если этого не сделать, все ячейки в таблице будут объединены.

В следующем примере кода показано, как создать таблицу с двумя строками, в которой ячейки в первой строке объединяются горизонтально:

{{< gist "aspose-words-gists" "93de23a2f74a7f2e4971ed203874c983" "horizontal-merge.cs" >}}

В следующем примере кода показано, как создать таблицу из двух столбцов, в которой ячейки первого столбца объединены по вертикали:

{{< gist "aspose-words-gists" "93de23a2f74a7f2e4971ed203874c983" "vertical-merge.cs" >}}

## Объединение ячеек таблицы в других случаях

В других ситуациях, когда **DocumentBuilder** не используется, например, в существующей таблице, объединение ячеек предыдущим способом может оказаться не таким простым. Вместо этого мы можем обернуть основные операции, связанные с применением свойств слияния к ячейкам, в метод, который значительно упрощает задачу. Этот метод аналогичен методу автоматизации "Объединить", который вызывается для объединения диапазона ячеек в таблице.

Приведенный ниже код объединит ячейки таблицы в указанном диапазоне, начиная с заданной ячейки и заканчивая конечной ячейкой. В этом случае диапазон может охватывать несколько строк или столбцов:

{{< gist "aspose-words-gists" "93de23a2f74a7f2e4971ed203874c983" "merge-cells.cs" >}}

В следующем примере кода показано, как объединить диапазон ячеек между двумя указанными ячейками:

{{< gist "aspose-words-gists" "93de23a2f74a7f2e4971ed203874c983" "merge-cell-range.cs" >}}

{{% alert color="primary" %}}

Вы можете скачать образец файла этого примера по адресу [Aspose.Words GitHub](https://github.com/aspose-words/Aspose.Words-for-.NET/blob/master/Examples/Data/Table%20with%20merged%20cells.docx).

{{% /alert %}}

В зависимости от используемой вами версии .NET Framework вы можете усовершенствовать этот метод, превратив его в метод расширения. В этом случае вы можете вызвать этот метод непосредственно в ячейке, чтобы объединить диапазон ячеек, например `cell1.Merge(cell2)`.

## Вертикальные и горизонтальные объединенные ячейки в таблице HTML

Как мы уже говорили в предыдущих статьях, таблица в Microsoft Word представляет собой набор независимых строк. Каждая строка имеет набор ячеек, независимых от ячеек других строк. Таким образом, в таблице Microsoft Word нет такого объекта как "столбец", а "1-й столбец" — это что-то вроде "набора 1-х ячеек каждой строки таблицы". Это позволяет пользователям иметь таблицу, в которой, например, 1-я строка состоит из двух ячеек – 2 см и 1 см, а 2-я строка состоит из двух разных ячеек – шириной 1 см и 2 см. И Aspose.Words поддерживает эту концепцию таблиц.

Таблица в HTML имеет принципиально другую структуру: каждая строка имеет одинаковое количество ячеек и (это важно для задачи) каждая ячейка имеет ширину соответствующего столбца, одинаковую для всех ячеек в одном столбце. Поэтому, если **HorizontalMerge** и **VerticalMerge** возвращают неправильное значение, используйте следующий пример кода:

{{< gist "aspose-words-gists" "93de23a2f74a7f2e4971ed203874c983" "print-horizontal-and-vertical-merged.cs" >}}

{{< gist "aspose-words-gists" "93de23a2f74a7f2e4971ed203874c983" "horizontal-and-vertical-merge-helper-classes.cs" >}}

{{% alert color="primary" %}}

Вы можете скачать образец файла этого примера по адресу [Aspose.Words GitHub](https://github.com/aspose-words/Aspose.Words-for-.NET/blob/master/Examples/Data/Table%20with%20merged%20cells.docx).

{{% /alert %}}

## Преобразование в горизонтально объединенные ячейки

Иногда невозможно определить, какие ячейки объединены, поскольку некоторые новые версии Microsoft Word больше не используют флаги слияния при горизонтальном объединении ячеек. Но для ситуаций, когда ячейки объединяются в ячейку по горизонтали по их ширине с помощью флагов слияния, Aspose.Words предоставляет метод `ConvertToHorizontallyMergedCells` для преобразования ячеек. Этот метод просто преобразует таблицу и добавляет новые ячейки по мере необходимости.

В следующем примере кода показан описанный выше метод в действии:

{{< gist "aspose-words-gists" "93de23a2f74a7f2e4971ed203874c983" "convert-to-horizontally-merged-cells.cs" >}}
