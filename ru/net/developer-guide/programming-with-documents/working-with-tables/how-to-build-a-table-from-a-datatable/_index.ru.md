---
title: Как построить стол из `DataTable` в C#
second_title: Aspose.Words для .NET
articleTitle: Постройте стол из `DataTable`
linktitle: Постройте стол из `DataTable`
description: "Пример заполнения таблицы документов из внешней базы данных с использованием C#."
type: docs
weight: 120
url: /ru/net/how-to-build-a-table-from-a-datatable/
timestamp: 2024-09-25-11-08-55
---

Часто ваше приложение будет извлекать данные из базы данных и хранить их в виде **DataTable**. Вы можете легко вставить эти данные в документ в виде новой таблицы и быстро применить форматирование ко всей таблице.

{{% alert color="primary" %}}

Отметим, что предпочтительным способом вставки данных из **DataTable** В таблице документов используется [Mail Merge с регионами](/words/net/types-of-mail-merge-operations/#mail-merge-with-regions). Техника, представленная в этой статье, предлагается только в том случае, если вы не можете создать подходящий шаблон для объединения данных, другими словами, если вам нужно, чтобы все происходило программно.

{{% /alert %}}

Использовать Aspose.Words, Вы можете легко получить данные из базы данных и хранить их в виде таблицы:

1. Создать новый **DocumentBuilder** объект на вашем **Document**.
1. Начните новый стол, используя **DocumentBuilder**.
1. Если мы хотим вставить имена каждой из колонок из нашего **DataTable** Затем в виде строки заголовка пройдите через каждый столбец данных и запишите имена столбцов в строку в таблице.
1. Итерировать через каждый **DataRow** в **DataTable**:
   1. итерировать через каждый объект в **DataRow**.
   1. Вставить объект в документ с использованием **DocumentBuilder**. Используемый метод зависит от типа вставляемого объекта например **DocumentBuilder.Writeln** для текста и **DocumentBuilder.InsertImage** для байтового массива, который представляет собой изображение.
   1.По окончании обработки **DataRow** Заканчивается также строка, создаваемая **DocumentBuilder** используя **DocumentBuilder.EndRow**.
1. Когда-то все ряды из **DataTable** были обработаны закончить стол, позвонив **DocumentBuilder.EndTable**.
1. Наконец, мы можем установить желаемый стиль таблицы, используя одно из соответствующих свойств таблицы. **Table.StyleIdentifier** автоматически применять форматирование ко всей таблице.

The **ImportTableFromDataTable** Метод принимает a **DocumentBuilder** объект, **DataTable** содержит данные и флаг, который указывает, идет ли колонка от **DataTable** Они включены в верхней части стола. Этот метод создает таблицу из этих параметров, используя текущее положение и форматирование строителя. Предоставляет способ импорта данных из `DataTable` и вставить его в новую таблицу с помощью конструктора документов.

Следующие данные в нашей **DataTable** Используется в этом примере:

![how-to-build-a-table-from-a-datatable-aspose-words-net](/words/net/how-to-build-a-table-from-a-datatable/how-to-build-a-table-from-a-datatable-1.png)

Следующий пример кода показывает, как выполнить вышеуказанный алгоритм в Aspose.Words:

{{< gist "aspose-words-gists" "affb937d8f345f60e6a506e1da3db9fa" "import-table-from-data-table.cs" >}}

Этот метод можно легко назвать с помощью **DocumentBuilder** и данные.

Следующий пример кода показывает, как импортировать данные из `DataTable` и включить его в новую таблицу в документе:

{{< gist "aspose-words-gists" "affb937d8f345f60e6a506e1da3db9fa" "build-table-from-data-table.cs" >}}
