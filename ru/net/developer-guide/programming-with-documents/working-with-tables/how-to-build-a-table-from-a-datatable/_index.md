---
title: Как построить таблицу из `DataTable` в C#
second_title: Aspose.Words для .NET
articleTitle: Постройте таблицу из `DataTable`
linktitle: Постройте таблицу из `DataTable`
description: "Пример заполнения таблицы документов из внешней базы данных с использованием C#."
type: docs
weight: 120
url: /ru/net/how-to-build-a-table-from-a-datatable/
---

Часто ваше приложение извлекает данные из базы данных и сохраняет их в виде **DataTable**. Вы можете легко вставить эти данные в документ как новую таблицу и быстро применить форматирование ко всей таблице.

{{% alert color="primary" %}}

Обратите внимание, что предпочтительным способом вставки данных из **DataTable** в таблицу документа является использование [Mail Merge с регионами](https://docs.aspose.com/words/net/types-of-mail-merge-operations/#mail-merge-with-regions). Техника, представленная в этой статье, рекомендуется только в том случае, если вы не можете заранее создать подходящий шаблон для объединения данных, другими словами, если вы требуют, чтобы все происходило программно.

{{% /alert %}}

Используя Aspose.Words, вы можете легко получить данные из базы данных и сохранить их в виде таблицы:

1. Создайте новый объект **DocumentBuilder** на своем **Document**.
1. Создайте новую таблицу, используя **DocumentBuilder**.
1. Если мы хотим вставить имена каждого столбца из нашего **DataTable** в качестве строки заголовка, то проходим по каждому столбцу данных и записываем имена столбцов в строку таблицы.
1. Перебрать каждые **DataRow** в **DataTable**:
  1. Перебрать каждый объект в **DataRow**.
  1. Вставьте объект в документ, используя **DocumentBuilder**. Используемый метод зависит от типа вставляемого объекта, например **DocumentBuilder.Writeln** для текста и **DocumentBuilder.InsertImage** для массива байтов, который представляет изображение.
  1. В конце обработки **DataRow** также завершите строку, созданную **DocumentBuilder**, используя **DocumentBuilder.EndRow**.
1. Как только все строки из **DataTable** будут обработаны, завершите таблицу, вызвав **DocumentBuilder.EndTable**.
1. Наконец, мы можем установить желаемый стиль таблицы, используя одно из соответствующих свойств таблицы, например **Table.StyleIdentifier**, чтобы автоматически применять форматирование ко всей таблице.

Метод **ImportTableFromDataTable** принимает объект **DocumentBuilder**, **DataTable**, содержащий данные, и флаг, указывающий, включен ли заголовок столбца из **DataTable** в верхнюю часть таблицы. Этот метод создает таблицу на основе этих параметров, используя текущую позицию и форматирование построителя. Предоставляет метод импорта данных из `DataTable` и вставки их в новую таблицу с помощью DocumentBuilder.

В этом примере используются следующие данные из нашего **DataTable**:

![how-to-build-a-table-from-a-datatable-aspose-words-net](/words/net/how-to-build-a-table-from-a-datatable/how-to-build-a-table-from-a-datatable-1.png)

В следующем примере кода показано, как выполнить приведенный выше алгоритм в Aspose.Words:

{{< gist "aspose-words-gists" "affb937d8f345f60e6a506e1da3db9fa" "import-table-from-data-table.cs" >}}

Затем этот метод можно легко вызвать, используя ваш **DocumentBuilder** и данные.

В следующем примере кода показано, как импортировать данные из `DataTable` и вставить их в новую таблицу документа:

{{< gist "aspose-words-gists" "affb937d8f345f60e6a506e1da3db9fa" "build-table-from-data-table.cs" >}}
