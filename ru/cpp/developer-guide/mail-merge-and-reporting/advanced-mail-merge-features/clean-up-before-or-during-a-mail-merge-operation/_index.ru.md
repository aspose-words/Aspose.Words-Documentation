---
title: Выполните очистку до или во время операции Mail Merge
second_title: Aspose.Words для C++
articleTitle: Выполните очистку до или во время операции Mail Merge
linktitle: Выполните очистку до или во время операции Mail Merge
type: docs
description: "Применяйте различные параметры очистки и удаления, такие как удаление полей слияния перед выполнением операции Mail Merge или удаление неиспользуемых областей во время операции mail merge."
keywords: "cleanup options Mail Merge c#"
weight: 10
url: /ru/cpp/clean-up-before-or-during-mail-merge/
timestamp: 2024-01-27-14-07-04
---

Aspose.Words позволяет применять различные параметры очистки и удаления, такие как удаление полей объединения перед выполнением операции Mail Merge или удаление неиспользуемых областей во время операции mail merge. В этом разделе объясняется, как удалить объединенные поля и как настроить параметр удаления.

## Удаление объединенных полей

Когда вы используете какой-либо длинный шаблон, созданный кем-то другим, вы можете захотеть удалить все поля слияния, которые уже существуют в этом шаблоне, перед выполнением операции mail merge. Вы можете использовать метод [DeleteFields](https://reference.aspose.com/words/cpp/aspose.words.mailmerging/mailmerge/deletefields/), если хотите удалить все объединяемые поля из документа без выполнения операции mail merge. На этот метод не влияют никакие параметры удаления свойства [CleanupOptions](https://reference.aspose.com/words/cpp/aspose.words.mailmerging/mailmerge/get_cleanupoptions/), и при его выполнении удаляются только объединяемые поля, а не какие-либо содержащие поля или пустые абзацы.

В следующем примере кода показано, как удалить все поля слияния из вашего шаблона без выполнения операции mail merge:

{{< gist "aspose-words-gists" "d55d8631947d283b1f0da99afa06c492" "Examples-DocsExamples-source-Programming with Documents-Working with Fields-DeleteFields.h" >}}

## Установите параметр `Removing`

Aspose.Words позволяет удалять несоединенные поля, области и абзацы из шаблона во время операции Mail Merge с помощью параметров удаления.

Используйте свойство **CleanupOptions** вместе с перечислением [MailMergeCleanupOptions](https://reference.aspose.com/words/cpp/aspose.words.mailmerging/mailmergecleanupoptions/), чтобы задать параметр удаления. Укажите, какие элементы вы хотите удалить, выбрав следующие параметры (вы можете комбинировать несколько).:

* Удалить пустые абзацы
* Удаление неиспользуемых областей
* Удалить неиспользуемые поля
* Удалить содержащие поля
* Удаление статических полей
* Удаление пустых строк таблицы

Поле слияния можно считать несоединенным при выполнении одного из следующих условий:

1. Если поле слияния в источнике данных не содержит столбца или поля сопоставления.
2. Если поле слияния в источнике данных содержит поле сопоставления, но данные имеют значение null.

{{% alert color="primary" %}}

Если вы объединяете данные, используя отдельные источники данных, то эти параметры удаления будут включены только при последнем вызове метода Mail Merge execute.

{{% /alert %}}

### Удалить пустые абзацы

Абзац, содержащий только поля для объединения, будет пустым, когда процесс Mail Merge удалит все поля для объединения как не объединенные. Эти пустые абзацы могут добавить ненужного пространства и изменить внешний вид сгенерированного отчета. При работе с абзацами в процессе Mail Merge могут возникнуть две ситуации:

1. Поле Mail Merge будет объединено с пустыми данными.
2. Поле для объединения не используется и будет удалено.

В обоих случаях опция **RemoveEmptyParagraphs** автоматически удалит пустые абзацы из документа. Кроме того, она удалит поля `TableStart` и TableEnd для объединения, если остальная часть абзаца пуста.

В следующем примере кода показано, как удалить пустые абзацы:

{{< gist "aspose-words-gists" "d55d8631947d283b1f0da99afa06c492" "Examples-DocsExamples-source-Mail Merge and Reporting-Working with CleanupOptions-RemoveEmptyParagraphs.h" >}}

{{% alert color="primary" %}}

Вы можете скачать примерный файл этого примера с сайта [Aspose.Words GitHub](https://github.com/aspose-words/Aspose.Words-for-C/tree/master/Examples).

{{% /alert %}}

### Удаление неиспользуемых полей

Aspose.Words позволяет удалить все неиспользуемые Mail Merge поля, присвоив флагу **RemoveUnusedFields** значение **CleanupOptions**. Этот параметр позволяет удалить объединяемые поля, которые не содержат соответствующих данных в источнике данных.

В следующем примере кода показано, как автоматически удалить все неиспользуемые поля слияния из документа во время операции mail merge:

{{< gist "aspose-words-gists" "d55d8631947d283b1f0da99afa06c492" "cpp-Mail-Merge-MailMergeCleanUp-RemoveUnusedFields.cpp" >}}

### Удаление содержащих полей

Объединяемое поле может содержаться внутри другого поля, такого как поле **IF** или поле формулы. Удалите это внешнее поле, когда объединяемое поле будет объединено или удалено из документа.

В следующем примере кода показано, как удалить поля, содержащие поля слияния, из документа:

{{< gist "aspose-words-gists" "d55d8631947d283b1f0da99afa06c492" "cpp-Mail-Merge-MailMergeCleanUp-RemoveContainingFields.cpp" >}}

**Примечание**

### Удаление пустых строк таблицы

Aspose.Words позволяет удалять пустые строки таблицы, присвоив флагу **RemoveEmptyTableRows** значение **CleanupOptions**. Этот параметр позволяет удалять строки таблицы, содержащие пустые поля слияния.

В следующем примере кода показано, как удалить пустые строки таблицы, содержащие области mail merge, из документа:

{{< gist "aspose-words-gists" "d55d8631947d283b1f0da99afa06c492" "cpp-Mail-Merge-MailMergeCleanUp-RemoveEmptyTableRows.cpp" >}}
