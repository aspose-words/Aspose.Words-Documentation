---
title: Робота з стильами та темами в C#
second_title: Aspose.Words для .NET
articleTitle: Робота з стильами та темами
linktitle: Робота з стильами та темами
description: "Головна Microsoft Word форматування функцій, робота з стилями та темами, використовуючи C#й"
type: docs
weight: 110
url: /uk/net/working-with-styles-and-themes/
---

Про нас [StyleCollection](https://reference.aspose.com/words/net/aspose.words/stylecollection/) клас використовується для управління вбудованими та застосувати користувацькі налаштування до стилів.

## Стиль доступу

Ви можете отримати колекцію стилів, визначених у документі за допомогою [Document.Styles](https://reference.aspose.com/words/net/aspose.words/documentbase/styles/) майно. Ця колекція має як вбудовані, так і призначені для користувача стилі в документі. Особливий стиль можна отримати за допомогою свого імені / псевдоніма, ідентифікатора стилю або індексу. Приклад коду показує, як отримати доступ до колекції стилів, визначених у документі.

{{< gist "aspose-com-gists" "0b968ac8900f80c11e109dffb105f3da" "Examples-CSharp-Programming-Documents-Document-AccessStyles-AccessStyles.cs" >}}

## Як витягувати контент на основі стилів

На простому рівні, що перерозподіляє вміст на основі стилів з документа Word, може бути корисним для ідентифікації, списку та підрахунку абзаців і рядків тексту, відформатованих певним стилем. Наприклад, для визначення окремих видів контенту в документі, таких як приклади, заголовки, посилання, ключові слова, імена фігур та приклади.

Для того, щоб зробити це кілька кроків далі, це також може бути використаний для важелювання структури документа, визначених стилях він використовує, для повторного використання документа для іншого виходу, наприклад HTML. Це насправді, як будується документація Aspose, що надходить Aspose.Words до тесту. Інструмент вбудований за допомогою Aspose.Words введіть документи Word і розбиває їх на теми на певних рівнях заголовка. Файл XML виробляється за допомогою Aspose.Words що використовується для побудови навігаційної деревини, ви можете побачити зліва. А потім Aspose.Words перетворює кожну тему в HTML.

Розчин для перерозподілу тексту, відформатований певними стилями в документі Word, як правило, економічним і прямим Aspose.Wordsй

### Рішення

Ілюструвати, як легко Aspose.Words ручка ретривування контенту на основі стилів, розглянемо приклад. У цьому прикладі ми будемо отримувати текстові форматування з певним стилем абзацу та стилем персонажа з зразка документа Word. На високому рівні це буде залучено:# Відкриття документа Word за допомогою [Document](https://reference.aspose.com/words/net/aspose.words/document/) клас.# Отримання зібрань всіх абзаців і всіх проходжень у документі.# Вибравши тільки потрібні абзаци і проходи. Зокрема, ми отримаємо текст, відформатований за допомогою пункту "Налаштування 1" та стилю "Intense Emphasis" з цього зразка документа Word.

![working-with-styles-and-themes-aspose-words-net](/words/net/working-with-styles-and-themes/working-with-styles-and-themes-1.png)


У цьому документі про зразок текст відформатований за допомогою пункту "Налаштування 1" є "Вставити вкладку", "Швидкі стилі" та "Theme", а текст відформатований стилем "Інтенсивний акцент" – це кілька екземплярів синього, ініціалізованого, сміливого тексту, таких як "галереї" та "загальний погляд".

### Код

Реалізація стильного запиту досить проста в Aspose.Words Модель об'єкта документа, як це просто використовує інструменти, які вже знаходяться в місці. Для цього рішення реалізуються два способи:# **ParagraphsByStyleName** до Цей метод отримує масив тих абзаців у документі, який має певну назву стилю. Нема **RunsByStyleName** до Цей метод отримує масив тих, хто працює в документі, який має певну назву стилю. Обидва ці методи є дуже схожими, єдиними відмінностями є типи вузлів і представлення інформації стилю в абзаци і запускати вершини. Тут здійснюється реалізація абзаців ByStyleName: Нижче наведено всі абзаци, відформатовані за вказаним стилем.

{{< gist "aspose-words" "9a306a41bb6aea8adfcabf5a575c5718" "Examples-CSharp-Programming-Documents-Styles-ExtractContentBasedOnStyles-ParagraphsByStyleName.cs" >}}

{{% alert color="primary" %}}

Ця реалізація також використовує `Document.GetChildNodes` метод методу `Document` клас, який повертає колекцію всіх вузлів з вказаним типом, що в цьому випадку в усіх пунктах.

Примітка, що другий параметр другого параметра **Document.GetChildNodes** метод встановлюється до trueй Це змушує **Document.GetChildNodes** метод вибору з усіх вузлів дитини, що рекурсивно рекурсивно, а не вибору безпосередньої дитини.

{{% /alert %}}

Крім того, варто відзначити, що збір абзаців не створює безпосередній наклад, оскільки абзаци завантажуються в цю колекцію лише тоді, коли ви маєте доступ до них. Потім все, що потрібно зробити, щоб перейти через збірку, використовуючи стандарт длявчителя оператора і додати абзаци, які мають вказаний стиль на абзаци Стильовий масив. Про нас `Paragraph` Назва стилю можна знайти в [Style.Name](https://reference.aspose.com/words/net/aspose.words/style/name/) майно майна [Paragraph.ParagraphFormat](https://reference.aspose.com/words/net/aspose.words/paragraph/paragraphformat/) об'єкт. Реалізація RunsByStyleName практично однакова, хоча ми, очевидно, використовуємо [NodeType.Run](https://reference.aspose.com/words/net/aspose.words/nodetype/) для отримання вузла запуску. Про нас [Font.Style](https://reference.aspose.com/words/net/aspose.words/font/style/) нерухомість [Run](https://reference.aspose.com/words/net/aspose.words/run/) об'єкт використовується для доступу до інформації про стиль **Run** вершини. Нижче наведено приклад пошуку всіх трас, відформатованих за допомогою вказаного стилю.

{{< gist "aspose-words" "9a306a41bb6aea8adfcabf5a575c5718" "Examples-CSharp-Programming-Documents-Styles-ExtractContentBasedOnStyles-RunsByStyleName.cs" >}}


Коли обидві запити реалізовані, все, що вам потрібно зробити, щоб передати об'єкт документа і вказати назви стилю, які ви хочете отримати: Нижче наведено запити та результати відображення. Ви можете завантажити файл шаблону цього прикладу з [Головна](https://github.com/aspose-words/Aspose.Words-for-.NET/blob/master/Examples/Data/Styles.docx)й

{{< gist "aspose-words" "9a306a41bb6aea8adfcabf5a575c5718" "Examples-CSharp-Programming-Documents-Styles-ExtractContentBasedOnStyles-ExtractContentBasedOnStyles.cs" >}}

### Кінець Результат

Коли все зроблено, запустити зразок буде відображати наступний вихід:

![styles-and-themes-aspose-words-net](/words/net/working-with-styles-and-themes/working-with-styles-and-themes-2.png)


Як ви можете побачити, це дуже простий приклад, показує кількість і текст зібраних абзаців і працює в інструкції документ Word.

## Скопіювати всі стилі з шаблону

Якщо ви хочете копіювати всі стилі з одного документа в інший. Ви можете використовувати `Document.CopyStylesFromTemplate` метод копіювання стилів з вказаного шаблону до документа. Коли стилі скопійовані з шаблону до документа, такі як названі стилі в документі перевизнаються, щоб відповідати описам стилів в шаблоні. Унікальні стилі з шаблону копіюються до документа. Унікальні стилі в документі залишаються незмінними. Початиlow code Приклад показує, як копіювати стилі з одного документа в інший.

{{< gist "aspose-words" "9a306a41bb6aea8adfcabf5a575c5718" "Examples-CSharp-Programming-Documents-Styles-CopyStyles-CopyStylesFromDocument.cs" >}}

## Як маніпулювати Тематичні властивості

Ми додали основні API в Aspose.Words доступу до властивостей теми документів. Зараз це API включає в себе наступні об'єкти:

- до Головна
- ТемиФонтс
- Теми

Ось як можна отримати тематичні властивості:

{{< gist "aspose-words" "9a306a41bb6aea8adfcabf5a575c5718" "Examples-CSharp-Programming-Documents-Theme-ManipulateThemeProperties-GetThemeProperties.cs" >}}

І ось як можна встановити тематичні властивості:

{{< gist "aspose-words" "9a306a41bb6aea8adfcabf5a575c5718" "Examples-CSharp-Programming-Documents-Theme-ManipulateThemeProperties-SetThemeProperties.cs" >}}
