---
title: Робота з таблицю змісту в Java
second_title: Aspose.Words для Java
articleTitle: Робота з Змістом
linktitle: Робота з Змістом
description: "Зміст поля деталі. Як створити і змінювати `TOC` використання поля Javaй"
type: docs
weight: 170
url: /uk/java/working-with-table-of-contents/
timestamp: 2024-10-21-11-17-44
---

Часто ви будете працювати з документами, що містять таблицю змісту (TOC). Використання Aspose.Words Ви можете вставляти свій власний таблицю змісту або повністю перебудувати існуючий таблицю змісту в документі за допомогою всього декількох рядків коду.

У статті описано, як працювати з таблицею поля контенту та демонструє:

- Як вставити бренд новий TOC.
- Оновлення нових або існуючих TOC в документі.
- Вкажіть перемикачі для керування форматуванням та загальною структурою ТЗ.
- Як змінити стилі і зовнішній вигляд таблиці змісту.
- Як видалити всю `TOC` поле разом з усіма записами з документа.

## Вставте таблицю змісту программатично

Ви можете вставити `TOC` (табл. змісту) поле в документ на поточному положенні за викликом [InsertTableOfContents](https://reference.aspose.com/words/java/com.aspose.words/documentbuilder/#insertTableOfContents-java.lang.String) метод.

Таблиця змісту у документі Word може бути побудована кількома способами і форматовано за допомогою різних варіантів. Увімкнено поле, що ви передаєте до методу управління способом, таблиця побудована і відображається у вашому документі.

Перемикачі за замовчуванням, які використовуються в `TOC` вставки Microsoft Word Р **""\o "1-3 \h \z \u"**й Описи цих вимикачів, а також перелік підтримуваних перемикачів можна знайти пізніше в статті. Якщо ви вже маєте документ, що містить аналогічний `TOC` ви хочете показати коди поля (*ALT+F9*) і скопіювати перемикачі безпосередньо з поля.

Приклад коду показує, як вставити таблицю поля змісту в документ:

{{< gist "aspose-words-gists" "827e71ccc0b8516a3cfe247b86ce6d4e" "Examples-src-main-java-com-aspose-words-examples-programming_documents-tableofcontents-InsertATableOfContentsField-InsertATableOfContentsField.java" >}}

Приклад коду показує, як вставити таблицю змісту (TOC) в документ, використовуючи стилі заголовків як записи:

{{< gist "aspose-words-gists" "827e71ccc0b8516a3cfe247b86ce6d4e" "Examples-src-main-java-com-aspose-words-examples-programming_documents-tableofcontents-InsertATableOfContentsUsingHeadingStyles-InsertATableOfContentsUsingHeadingStyles.java" >}}

Введіть номер мобільного, який Ви вказали при укладаннi договору з банком - для ідентифікації. Про нас [DocumentBuilder](https://reference.aspose.com/words/java/com.aspose.words/documentbuilder/) клас потім використовується для вставки деяких форматів вмісту зразка з відповідними заголовками стилі, які використовуються для позначення вмісту, який буде включений в TOC. Наступні рядки потім з'єднають `TOC` шляхом оновлення полів та макету сторінки документа.

![insert-table-of-contents-field-aspose-words-java](/words/java/working-with-table-of-contents/how-to-insert-and-work-with-the-table-of-contents-field-1.png)

{{% alert color="primary" %}}

Без методів, які використовуються в прикладі, коли ви відкриєте вихідний документ, ви знайдете `TOC` поле, але без видимого вмісту. Це тому, що `TOC` поле було вставлено, але ще не заселено, поки воно було оновлено в документі. Додаткова інформація про це розглядається в наступному розділі.

{{% /alert %}}

## Оновлення таблиці змісту

Aspose.Words дозволяє повністю оновлювати оновлення `TOC` лише кілька рядків коду. Це може бути зроблено для того, щоб створити нову вставку `TOC` або оновити існуючий `TOC` після внесення змін до документа.

Для оновлення потрібно використовувати наступні два способи `TOC` поля в документі:

1. [Document.updateFields()](https://reference.aspose.com/words/java/com.aspose.words/Document#updateFields())
1. [Document.updatePageLayout()](https://reference.aspose.com/words/java/com.aspose.words/Document#updatePageLayout())

Будь ласка, зверніть увагу, що ці два способи оновлення повинні бути викликані в цьому порядку. Якщо перевернути таблицю змісту буде опубліковано, але не буде відображатися номер сторінки. Будь-яка кількість різних TOC можна оновити. Ці методи автоматично оновлюватимуть всі ТЦ, знайдені в документі.

Приклад коду показує, як повністю відновити `TOC` поля в документі, викликаючи оновлення поля:

{{< gist "aspose-words-gists" "827e71ccc0b8516a3cfe247b86ce6d4e" "Examples-src-main-java-com-aspose-words-examples-programming_documents-tableofcontents-InsertATableOfContentsField-UpdateTableOfContents.java" >}}

Перший виклик [Document.updateFields()](https://reference.aspose.com/words/java/com.aspose.words/document/#updateFields) побудувати <span notrans="<span notrans=" `TOC`"=""></span>, > всі текстові записи заселені і `TOC` з'являється практично повністю. Єдине, що не вистачає сторінок, які зараз відображаються з "?".

Другий виклик [Document.updatePageLayout()](https://reference.aspose.com/words/java/com.aspose.words/document/#updatePageLayout) побудувати макет документа в пам'яті. Для збирання номерів сторінок. Виправте номери сторінок, розраховані з цього виклику, потім вставляються в TOC.

## Використовуйте перемикачі для контролю таблиці змісту

Як і будь-яке інше поле, `TOC` поле може приймати перемикачі, визначені в Полікоді, які контролює, як будується таблиця вмісту. Деякі перемикачі використовуються для контролю, які записи включені і на якому рівні, а інші використовуються для контролю зовнішнього вигляду TOC. Вимикачі можуть поєднуватися між собою, щоб забезпечити складний стіл контенту, який буде виготовлений.

![ccontrol-table-of-contents-field-aspose-words-java](/words/java/working-with-table-of-contents/how-to-insert-and-work-with-the-table-of-contents-field-2.png)


За замовчуванням, ці перемикачі вище включені при вставці за замовчуванням `TOC` у документі. Р `TOC` без перемикачів буде включати вміст з вбудованих стилів заголовка (як якщо наведено перемикач \O).

Доступний `TOC` перемикачі, які підтримуються Aspose.Words Нижче описуються і їх використання. Їх можна розділити на окремі розділи на основі їх типу. Перемикачі в першому розділі визначають те, що вміст включено в `TOC` і перемикачі в другій секції контролюють зовнішній вигляд TOC.

Якщо перемикач не зазначений тут, то він наразі не підтримується. Всі перемикачі будуть підтримуватися в наступних версіях. Ми додаємо підтримку кожного релізу.

### Вимикачи для маркування записів

|  Перемикач | Опис |
|  :-  |  :-  |
| **Heading Styles** <br/> *(\O перемикач)* <br/> | <p>Цей перемикач визначає, що `TOC` повинен бути вбудованим заголовком стилів. У Microsoft Word, вони визначаються заголовуванням 1 - Заголовок 9. У Aspose.Words ці стилі представлені відповідною студією StyleIdentifier. Ця анумерація являє собою локальний ідентифікатор стилю, наприклад, `StyleIdentifier.Heading1` являє собою заголовок 1 стиль. Використання цього форматування та властивостей стилю можна отримати з колекції стилів документа. Клас відповідного стилю можна отримати з `Document.Styles` збір за допомогою індексованого майна типу StyleIdentifier.</p>

<p>![style-table-of-contents-field-aspose-words-java](/words/java/working-with-table-of-contents/how-to-insert-and-work-with-the-table-of-contents-field-3.png)</p>

<p><br/><br/>Будь-який контент, відформатований цими стилями, входить до таблиці змісту. Рівень заголовка визначить відповідний ієрархічний рівень входу в ТОК. Наприклад, абзац з заголовуванням 1 стиль буде розглядатися як перший рівень `TOC` У той час як абзац з заголовуванням 2 буде розглядатися як наступний рівень в ієрархії і так далі.</p>
 |
| **Outline Levels** <br/> *(\U перемикач)* <br/> | <p>Кожен пункт може визначити рівень контуру за параметрами пункту.</p>

<p>![modify-table-of-contents-field-aspose-words-java](/words/java/working-with-table-of-contents/how-to-insert-and-work-with-the-table-of-contents-field-4.png)</p>

<p><br/><br/>Цей параметр диктує, які вирівняти цей пункт слід розглядати в ієрархії документа. Це загальноприйнята практика, яка використовується для легко структурування макета документа. Цей ієрархія можна переглянути, змінивши на зовнішній вигляд Microsoft Wordй Подібно до заголовків стилів, може бути 1 – 9 рівнів, крім рівня "Body Text". Зовнішні рівні 1 - 9 з'явиться в `TOC` у відповідному рівні ієрархії <br/>Будь-який вміст з рівнем контуру або встановленим в стилі абзацу або безпосередньо на сам абзац включений в TOC. У Aspose.Words Рівень контуру представлений рівнем контуру `ParagraphFormat.OutlineLevel` майно параграфа вузла. Рівень контуру стилю представлений таким же чином `Style.ParagraphFormat` майно.</p>

<p>{{% alert color="primary" %}}</p>

<p>Зверніть увагу, що вбудовані стилі заголовка, такі як Heading 1 мають обов'язковий набір рівня в налаштуваннях стилю.</p>

<p>{{% /alert %}}</p>
 |
| **Custom Styles** <br/> *(\T перемикач)* <br/> | <p>Цей перемикач дозволить використовувати користувацькі стилі при зборі записів для використання в TOC. Це часто використовується в поєднанні з перемикачем \ O, щоб включати спеціальні стилі разом з вбудованими головуванням стилів в TOC. <br/>Параметри перемикача повинні бути укладені в межах мовних знаків. Багато користувацьких стилів можна включити, для кожного стилю, ім'я повинна бути зазначена за допомогою коми за рівнем, який стиль повинен з'явитися в стилі `TOC` як. Подальші стилі також відокремлюються комою і. <br/>Зареєструватися</p>

<p>{{< highlight csharp >}}
{ TOC \o "1-3" \t "CustomHeading1, 1,   CustomHeading2, 2"}{{< /highlight >}}</p>

<p>використовувати стиль вмісту з CustomHeading1 як рівень 1 вмісту в `TOC` і CustomHeading2 як рівень 2.</p>
 |
| Використання TC поля <br/> *(\F і \L перемикачі) * <br/> | <p>У старших версіях Microsoft Word, єдиний спосіб побудови `TOC` було використання полів ТЦ. Ці поля вставляють приховані в документ, навіть якщо відображаються коди поля. Вони включають текст, який повинен відображатися в записі і `TOC` Будується з них. Цей функціонал тепер не використовується дуже часто, але може бути корисним в деяких випадках, щоб включати записи в `TOC` які не відступають, щоб бути видимими в документі. <br/>При вставленні цих полів з'являються приховані навіть при відображенні поля. Не можна побачити без показу прихованого вмісту. Щоб побачити ці поля Показати форматування абзаців необхідно вибрати.</p>

<p>![setup-table-of-contents-field-aspose-words-java](/words/java/working-with-table-of-contents/how-to-insert-and-work-with-the-table-of-contents-field-5.png)</p>

<p>Ці поля можуть бути вставлені в документ на будь-якій позиції, як будь-який інший поле, і представлені `FieldType.FieldTOCEntry` заохочення.<br/>Перемикач \F в `TOC` використовується для позначення, що поля TC повинні бути використані як записи. Перемикач самостійно без додаткового ідентифікатора означає, що будь-яке поле TC в документі буде включено. Будь-який додатковий параметр, часто один лист, спроектуватиме, що тільки поля TC, які мають відповідні \f перемикач буде включений в TOC. Наприклад *</p>

<p>{{< highlight csharp >}}
{ TOC \f t }{{< /highlight >}}</p>

<p>буде містити лише поля TC, такі як</p>

<p>{{< highlight csharp >}}
{ TC \f t }{{< /highlight >}}</p>

<p>Про нас `TOC` поле також має пов'язаний перемикач, перемикач "\L" визначає, що тільки поле TC з рівнями в зазначеному діапазоні включено.</p>

<p>![table-of-contents-field-aspose-words-java](/words/java/working-with-table-of-contents/how-to-insert-and-work-with-the-table-of-contents-field-6.png)</p>

<p><br/><br/>Про нас `TC` полів також можуть мати {several, `multiple`, a few, `many`, numerous} комплект вимикачів. Це:</p>

<p>- \F - Виключені вище. Ім'я *</p>

<p>- \L - Дефіни, які рівні в `TOC` це поле TC з'явиться в. Р `TOC` який використовує цей самий перемикач буде включати в себе це поле TC, якщо він знаходиться в зазначеному діапазоні.</p>

<p>- _\N - Номер сторінки для цього `TOC` запис не відображається. Приклад коду як вставити поля TC можна знайти в наступному розділі.</p>
 |

### Зовнішній вигляд Схожі перемикачі

|  Перемикач | Опис |
|  :-  |  :-  |
| **Omit Page Numbers** <br/> *(\N перемикач)* | <p>Цей перемикач використовується для приховувати номери сторінок для певних рівнів TOC. Наприклад, можна визначити</p>

<p>{{< highlight csharp >}}
{TOC \o "1-4" \n "3-4" }{{< /highlight >}}</p>

<p>і номери сторінок на записах рівнів 3 і чотири будуть приховані разом з лідерами точок (якщо є будь-який). Щоб визначити лише один рівень, потрібно використовувати діапазон, наприклад, "1-1" виключить лише номери сторінок для першого рівня. <br/>Постачання не діапазону рівня буде примітити номери сторінок для всіх рівнів в TOC. Це корисно для установки при експорті документа в HTML або аналогічний формат. Це тому, що HTML-формати не мають ніякої концепції сторінки, і таким чином, не потрібна кількість сторінок.</p>

<p>![table-of-contents-aspose-words-java](/words/java/working-with-table-of-contents/how-to-insert-and-work-with-the-table-of-contents-field-7.png)</p>
 |
| Вставити як гіперпосилання <br/> *(\H перемикач)* | <p>Цей перемикач визначає, що `TOC` записи вставляються як гіперпосилання. При перегляді документа в Microsoft Word ці записи все ще з'являються як звичайний текст всередині `TOC` але є гіперпосилання і, таким чином, може бути використаний для навігації в положення оригінального входу в документ за допомогою *Ctrl + клацніть лівою кнопкою миші * в Microsoft Wordй Коли цей перемикач включений, то ці посилання також зберігаються в інших форматах. Наприклад, в HTML-форматах, включаючи EPUB і продаються формати, такі як PDF і XPS, вони будуть експортовані як робочі посилання. <br/>Без цього перемикача, `TOC` у всіх цих виходах буде експортований як звичайний текст і не продемонструвати цю поведінку. Якщо документ відкривається в MS Word текст записів також не буде клацнути таким чином, але номери сторінок все ще можуть бути використані для навігації до оригінального запису.</p>

<p>![tree-table-of-contents-field-aspose-words-java](/words/java/working-with-table-of-contents/how-to-insert-and-work-with-the-table-of-contents-field-8.png)</p>
 |
| **Set Separator Character** <br/> *(\P перемикач)* <br/> | <p>Цей перемикач дозволяє відокремити заголовок запису та номер сторінки, щоб легко змінюватися в ТЗ. Сепаратор повинен бути зазначений після цього вимикача і закривається в мовних знаках. <br/>Приміряти, що документується в документації Office, можна використовувати тільки один символ замість п'яти. Це стосується як MS Word і Aspose.Wordsй <br/>Використання цього перемикача не рекомендується, оскільки він не дозволяє багато контролювати, що він використовується для окремих записів та номерів сторінок в TOC. замість цього рекомендується редагувати відповідні `TOC` стиль, такі як `StyleIdentifier.TOC1` і звідти відредагувати стиль лідера з доступом до певних членів шрифту тощо. Детальніше про те, як зробити це можна пізніше в статті.</p>

<p>![list-table-of-contents-field-aspose-words-java](/words/java/working-with-table-of-contents/how-to-insert-and-work-with-the-table-of-contents-field-9.png)</p>
 |
| **Preserve Tab Entries** <br/> *(\W перемикач)* | <p>За допомогою цього перемикача вкажіть, що будь-які записи, які мають символ вкладки, наприклад, заголовок, що має вкладку в кінці рядка, будуть зберігатися як правильний символ вкладки при популуванні TOC. Це означає функцію символу вкладки буде присутній в `TOC` і може використовуватися для форматування запису. Наприклад, деякі записи можуть використовувати вкладки і символи вкладок, щоб рівномірно розташувати текст. Довгий час `TOC` рівень визначає еквівалентні вкладки, після чого сформований `TOC` записи з'являться з схожою обшивкою. <br/><br/>У тій же ситуації, якщо цей вимикач не визначений, то символи вкладки будуть перетворені на білий простір, еквівалентний нефункціональним вкладкам. Після цього вихід не буде виглядати як очікувано.</p>

<p>![tab-table-of-contents-field-aspose-words-java](/words/java/working-with-table-of-contents/how-to-insert-and-work-with-the-table-of-contents-field-10.png)</p>
 |
| **Preserve New Line Entries** <br/> *(\X перемикач)* <br/> | <p>Подібно до перемикача вище, цей перемикач визначає, що заголовки, що простягаються на декількох лініях (з використанням нових символів, не окремих абзаців) будуть збережені як вони в генераному TOC. Наприклад, заголовок, яка полягає в тому, щоб поширюватися через декілька рядків, може використовувати новий символ лінії (Ctrl + Enter або `ControlChar.LineBreak`) відокремити вміст по різних лініях. За допомогою цього перемикача вказаний запис в `TOC` зберігати ці нові символи рядків, як показано нижче. <br/><br/>У цій ситуації, якщо перемикач не визначений, то нові символи лінії перетворюються на єдиний білий простір.</p>

<p>![tab-space-table-of-contents-field-aspose-words-java](/words/java/working-with-table-of-contents/how-to-insert-and-work-with-the-table-of-contents-field-11.png)</p>
 |

## Вставити ТК поля

Ви можете вставити нове поле TC на поточному положенні `DocumentBuilder` за викликом `DocumentBuilder.InsertField` метод і вказати назву поля як "TC" разом з будь-якими перемикачами, які необхідні.

Приклад наступного коду показує, як вставити `TC` поле в документ, використовуючи [DocumentBuilder](https://reference.aspose.com/words/java/com.aspose.words/documentbuilder/)й

{{< gist "aspose-words-gists" "827e71ccc0b8516a3cfe247b86ce6d4e" "Examples-src-main-java-com-aspose-words-examples-programming_documents-tableofcontents-InsertTCField-InsertTCField.java" >}}

Нерідко для конкретної лінії тексту позначається певна лінія тексту `TOC` і позначений `TC` поле. Простий спосіб зробити це в MS Word, щоб виділити текст і натисніть *ALT+SHIFT+O*. Це автоматично створює `TC` поле за допомогою вибраного тексту. Така ж техніка може бути виконана за допомогою коду. Введіть номер мобільного, який Ви вказали при укладаннi договору з банком - для ідентифікації `TC` поле в одному положенні як текст. Код базується на тій же техніці, яка використовується в статті. Приклад коду показує, як знайти і вставити `TC` поле в тексті в документі.

{{< gist "aspose-words-gists" "827e71ccc0b8516a3cfe247b86ce6d4e" "Examples-src-main-java-com-aspose-words-examples-programming_documents-tableofcontents-FindAndInsertATCField-InsertTCFieldHandler.java" >}}

## Змінення таблиці змісту

### Зміна форматування стилів

Форматування записів у форматі `TOC` не використовує оригінальні стилі позначених записів, замість цього кожен рівень відформатований за допомогою еквівалентного `TOC` стиль. Наприклад, перший рівень `TOC` відформатований з **ТЦ1** стиль, другий рівень відформатований з **ТЦ2** стиль і так далі. Це означає, що змінити зовнішній вигляд `TOC` ці стилі повинні бути змінені. У Aspose.Words ці стилі представлені місцевими `StyleIdentifier.TOC1` через `StyleIdentifier.TOC9` і можна отримати з `Document.Styles` збір за допомогою цих ідентифікаторів.

Після відповідного стилю документа було отримано форматування для цього стилю. Будь-які зміни до цих стилів будуть автоматично відображені в документі.

Приклад коду змінює форматування майна, що використовується в першому рівні `TOC` стиль.

{{< gist "aspose-words-gists" "827e71ccc0b8516a3cfe247b86ce6d4e" "Examples-src-main-java-com-aspose-words-examples-programming_documents-tableofcontents-ModifyATableOfContents-changeAFormattingPropertyUsedInFirstLevelTOCStyle.java" >}}

Також корисно відзначити, що будь-який прямий форматування абзацу (визначено на самому абзацу і не в стилі) позначений, що буде включений до `TOC` буде скопійовано в записі в TOC. Наприклад, якщо заголовок 1 стиль використовується для позначення вмісту для `TOC` і цей стиль має сміливе форматування, в той час як абзац також має italic форматування безпосередньо на нього. В результаті `TOC` запис не буде сміливим, оскільки це частина форматування стилів, проте це буде italic, оскільки це безпосередньо відформатовано на пункті.

Ви також можете керувати форматуванням сепараторів, що використовуються між кожним входом та номером сторінки. За замовчуванням, це пунктирна лінія, яка поширюється на номер сторінки, використовуючи символ вкладки та праву зупинку вкладок, розташовану поруч з правим запасом.

Використання `Style` клас, отриманий для конкретного `TOC` рівень, який ви хочете змінити, ви також можете змінити, як це з'являється в документі.

Щоб змінити, як це з'являється вперше `Style.ParagraphFormat` повинні бути викликані, щоб отримати форматування абзаців для стилю. Від цього вкладки можна отримати за допомогою виклику `ParagraphFormat.TabStops` і відповідна кнопка зупинки змінного струму. Використовуючи цю ж техніку, сам вкладок може бути переміщений або видалений.

Приклад наступного коду показує, як змінити позицію зупинки правої вкладки в `TOC` пов'язані абзаци.

{{< gist "aspose-words-gists" "827e71ccc0b8516a3cfe247b86ce6d4e" "Examples-src-main-java-com-aspose-words-examples-programming_documents-tableofcontents-ModifyATableOfContents-modifyPositionOfRightTabStopInTOC.java" >}}

## Видалити таблицю змісту з документа

Зміст може бути видалений з документа шляхом видалення всіх вузлів, знайдених між документом `FieldStart` і FieldEnd вершини `TOC` поле.

Код нижче показує це. Видалення видалення `TOC` поле простіша, ніж нормальне поле, так як ми не стежимо за в'язаними полями. Замість ми перевіряємо `FieldEnd` вузол типу `FieldType.FieldTOC` що означає, що ми зустрілися з закінченням поточного TOC. Ця методика може бути використана в цьому випадку, не турбуючись про будь-які незручні поля, як ми можемо припустити, що будь-який належним чином сформований документ не буде повністю непристойний `TOC` поле в іншому `TOC` поле.

Спочатку `FieldStart` вузли кожного `TOC` зібрані та зберігаються. Вказаний `TOC` потім занурюється так, що всі вузли в межах поля подаються і зберігаються. Потім виводяться вузли з документа. Приклад коду показує, як видалити зазначений код `TOC` з документа.

{{< gist "aspose-words-gists" "827e71ccc0b8516a3cfe247b86ce6d4e" "Examples-src-main-java-com-aspose-words-examples-programming_documents-tableofcontents-RemoveATableOfContents-RemoveATableOfContents.java" >}}

## Витягувати таблицю змісту

Якщо ви хочете витягти таблицю змісту з будь-якого документа Word, можна використовувати наступний зразок коду.

{{< gist "aspose-words-gists" "827e71ccc0b8516a3cfe247b86ce6d4e" "Examples-src-main-java-com-aspose-words-examples-programming_documents-tableofcontents-ExtractTableOfContents-ExtractTableOfContents.java" >}}
