---
title: Видалити формат файлу
second_title: Aspose.Words для Java
articleTitle: Видалити формат файлів і перевірити формат сумісності
linktitle: Видалити формат файлів і перевірити формат сумісності
description: "Отримуйте інформацію про формат документа, перш ніж відкрити його, щоб уникнути виключення, якщо ви не впевнені, що фактичний зміст файлу використовується Javaй"
type: docs
weight: 20
url: /uk/java/detect-file-format-and-check-format-compatibility/
timestamp: 2024-10-21-11-17-44
---

Іноді необхідно визначити формат документа перед відкриттям, оскільки розширення файлу не гарантує, що вміст файлу доречно. Наприклад, відомо, що кристалічні звіти часто виводяться документи у форматі RTF, але дають їм розширення .doc.

Aspose.Words дає можливість отримати інформацію про тип файлу, щоб уникнути виключення, якщо ви не впевнені, що фактичний зміст файлу є.

## Видалити формат файлів без виключення

Коли ви працюєте з декількома документами в різних форматах файлів, вам може знадобитися відокремити ці файли, які можуть бути оброблені Aspose.Words від тих, хто не може. Ви також можете дізнатися, чому деякі документи не можуть бути оброблені.

Якщо ви спробуєте завантажити файл в файл [Document](https://reference.aspose.com/words/java/com.aspose.words/document/) об'єкт і Aspose.Words не може розпізнати формат файлу або формат не підтримується, Aspose.Words викине виняток. Ви можете зловити ті винятки і проаналізувати їх, але Aspose.Words також надає [DetectFileFormat](https://reference.aspose.com/words/java/com.aspose.words/fileformatutil/#detectFileFormat-java.lang.String) метод, який дозволяє нам швидко визначити формат файлів без завантаження документа з можливими винятками. Цей метод повертає [FileFormatInfo](https://reference.aspose.com/words/java/com.aspose.words/fileformatinfo/) об'єкт, який містить інформацію про тип файлу.

{{% alert color="primary" %}}

ДетектФайл Формат тільки перевіряє формат файлу, але не перевіряє формат файлу. Не існує гарантії, що файл буде відкрито успішно, навіть якщо **DetectFileFormat** повертає, що це один з підтримуваних форматів. Це через **DetectFileFormat** метод читає тільки часткові дані формату файлів, достатні для перевірки формату файлу, але не достатньо для повної перевірки.

{{% /alert %}}

## Перевірити формат файлів сумісність

Ми можемо перевірити формат сумісності всіх файлів у вибраній папці та сортувати їх за форматом у відповідні підпапки.

Оскільки ми маємо справу з вмістом в папці, то перше, що нам потрібно зробити, це зібрати всі файли в цій папці за допомогою папки **GetFiles** метод методу `Directory` клас (від класу) `System.IO` простір імен.

Приклад наступного коду показує, як отримати список всіх файлів в папці:

{{< gist "aspose-words-gists" "827e71ccc0b8516a3cfe247b86ce6d4e" "Examples-src-main-java-com-aspose-words-examples-loading_saving-CheckFormatCompatibility-GetListOfFilesInFolder.java" >}}

Коли зібрані всі файли, решта роботи виконується **DetectFileFormat** метод, який перевіряє формат файлу.

Наприклад, наступний код показує, як ітерувати над зібраним переліком файлів, перевірити формат кожного файлу та переміщати кожен файл у відповідну папку:

{{< gist "aspose-words-gists" "827e71ccc0b8516a3cfe247b86ce6d4e" "Examples-src-main-java-com-aspose-words-examples-loading_saving-CheckFormatCompatibility-CheckFormatCompatibility.java" >}}

Файли переміщуються в відповідні підпапки з використанням `Move` метод методу `File` клас, з того ж `System.IO` простір імен.

На прикладі вище використовуються наступні файли. Назва файлу зліва і його опис справа:

| Group Файли | Вхідний документ | Тип |
|  :-  |  :-  |  :-  |
| Підтримка форматів файлів | Тест файл (Doc).doc | Microsoft Word 95/6.0 або Microsoft Word 97 – 2003 документ. |
|  | Тест файл (Dot).dot | Microsoft Word 95/6.0 або Microsoft Word 97 – 2003 шаблон. |
|  | Тест файл (Docx).docx | Офіс Відкритий XML-розробка ML документ без макросів. |
|  | Файл тесту (Docm).docm | Офіс Відкритий XML-розробка ML документ з макросом. |
|  | Тест файл (Dotx).dotx | Офіс Відкритий XML-розробка ML шаблон. |
|  | Тест файл (Dotm).dotm | Офіс Відкритий XML-розробка ML шаблон з макросом. |
|  | English, Українська, Français. | FlatOPC OOXML Документ. |
|  | Тест файл (RTF).rtf | Багатий текст Формат документа. |
|  | English, Українська, Français. | Microsoft Word 2003 Словообробка ML документ. |
|  | English, Українська, Français. | HTML документ. |
|  | English, Українська, Français. | MHTML (Web архів) документ. |
|  | Тест файл (Odt).odt | OpenDocument Text (OpenOffice Writer). |
|  | Тест файл (Ott).ott | Шаблон документа OpenDocument. |
|  | Файл тесту (DocPreWord60).doc | Microsoft Word 2.0 документ. |
| Зашифровані документи | Тест файл (Enc).doc | Зашифрований Microsoft Word 95/6.0 або Microsoft Word 97 – 2003 документ. |
|  | Тест файл (Enc).docx | Зашифрована Office Open XML Wordprocessing ML документ. |
| Непідтримані формати файлів | Файл тесту (JPG). й | Файл зображень JPEG. |

