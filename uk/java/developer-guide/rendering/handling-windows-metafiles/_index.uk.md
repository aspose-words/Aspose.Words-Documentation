---
title: Рушники Windows Метафайли в Java
second_title: Aspose.Words для Java
articleTitle: Рушники Windows Метафайли
linktitle: Рушники Windows Метафайли
description: "Aspose.Words для Java реалізує власну Windows Метафайловий програвач для відтворення формату Metafile на всіх платформах і підтримує обробку основних функцій метафайлу і може виконувати випадання до різних типів метафайлів."
type: docs
weight: 30
url: /uk/java/handling-windows-metafiles/
timestamp: 2024-01-27-14-07-04
---

Windows Формат метафілу - формат файлів зображень, який може містити як векторну, так і растрову графіку. Цей формат використовується для зберігання даних графіки в пам'яті або на диску. Метафайл зберігає список викликів функцій Windows Графічний інтерфейс пристрою (GDI), який повинен бути виконаний для відображення зображення на екрані. Система інтерпретує та виконує ці команди в контексті відображення.

Раніше, Windows Метафайл - єдиний формат векторного зображення, що підтримується Microsoft Wordй Microsoft Word Тепер також підтримує формат SVG, але формат метафайлу все ще зазвичай використовується в документах Word. Крім того, Metafile може бути змінним форматом для деяких інших додатків, таких як Microsoft Вісіо. Основною метою Metafile є забезпечення обміну графічною інформацією між Windows додатки.

Є 3 версії Windows Мета

- WMF - зберігає виклик 16bit GDI.
- EMF - зберігає виклик Win32/GDI.
- EMF+ Metafile зберігає виклик GDI+. EMF+ Metafile також може бути подвійним, що описує однакову графіку як з EMF, так і EMF+ частин.

Чистий випуск Windows Метафайл - це не підтримується самими форматами, до яких зазвичай зберігаються документи. Тому потрібно конвертувати формат Metafile в інші растрові або векторні формати. Легко конвертувати Windows Метафайл до растрового зображення на .NET просто переходячи його на GDI+, але це не можливо на інших платформах, оскільки навіть GDI+ не дає можливості витягти векторну графіку з Metafile. Для вирішення цих питань Aspose.Words реалізує власну Windows Метафайл-плеєр, який здатний відтворювати формат Metafile як векторний, так і растровий графік на всіх платформах.

## Контроль Aspose.Words Метафайл плеєр

Про нас [MetafileRenderingOptions](https://reference.aspose.com/words/java/com.aspose.words/metafilerenderingoptions/) клас дозволяє керувати метафайлом. Наприклад, ви можете визначити, як зображення метафайлу необхідно надати за допомогою [RenderingMode](https://reference.aspose.com/words/java/com.aspose.words/metafilerenderingmode/) майно, яке має особливий сенс при перетворенні на бітмапи (див. також [MetafileRenderingOptions](https://reference.aspose.com/words/java/com.aspose.words/imagesaveoptions/#getMetafileRenderingOptions) майно.

## Підтримує Растрові операції

Растрові операції – це комплексна функція метафілу, яка наразі має обмежену підтримку. Растрові операції доступні в форматах WMF і EMF. Формат EMF+ не використовує растрові операції безпосередньо, але може містити деталі EMF, вбудовані профілі WMF або EMF.

Є бінарні та ternary raster операції:

- Бінарні растрові операції наносяться на команди ручного малюнка, такі як лінії малювання і вигини. При накладанні лінії колір ручки поєднується з кольором утилізації пункту призначення (кольор відповідного пікселя на поверхні пристрою) за допомогою вказаних бітумних логічних операцій з значенням кольору шістки. Приклад зображення нижче ілюструє ефект всіх 16 бінарних растрових операцій, які застосовуються до 20 різних кольорових барів. Нанесені вертикальні кольорові стовпчики, горизонтальні стовпчики після кожної операції бінарних растрових виробів. Для простих випадків R2_BLACK малює чорний, R2_NOT перетворює колір, R2_NOP не змінює фон, і R2_WHITE малює білий.

<img src="/words/java/handling-windows-metafiles/handling-windows-metafiles-1.png" alt="handling-windows-metafiles-aspose-words-java-1" style="width:650px"/>

- Тернарні растрові операції застосовуються при накладанні растрових зображень. Вони поєднують кольори відповідних бітма зображення пікселів, пензлика, і місце призначення бітма, використовуючи бітумні логічні операції з вказаними значеннями кольорів шестигран. Однією з найбільш поширених цілей використання денних растрових операцій є емульсія прозорості. Наведено зображення на прикладі нижче, показує, як можна використовувати прозорість ікони. Існує два типи бітмаксів: b/w маска бітма і кольорова бітмапа. По-перше, маска бітма малюється з рариком SRCAND. Змінити область піктограми на чорно-білу, залишаючи прозору область незмінною. Після чого друге бітма намальовується з рариком SRCINVERT. Відображається колір пікселів на чорному регіоні, залишаючи прозору область незмінною.

<img src="/words/java/handling-windows-metafiles/handling-windows-metafiles-2.png" alt="handling-windows-metafiles-aspose-words-java-2" style="width:650px"/>

Растрові операції не можуть перетворюватися в векторну графіку безпосередньо. Aspose.Words емульгує растрові операції шляхом часткового знеболювання поверхні пристрою, ураженої растровими операціями. Для цієї мети [EmulateRasterOperations](https://reference.aspose.com/words/java/com.aspose.words/metafilerenderingoptions/#getEmulateRasterOperations) Зручності в готелі.

{{% alert color="primary" %}}

У той час як бінарні растрові операції наразі не підтримуються і обмежена кількість операцій денного растрового призначення підтримується Aspose.Words, він може обробляти основні випадки перетворення в векторну графіку безпосередньо, наприклад, R2_BLACK, R2_WHITE, R2_NOPй Також, що значно впливає на продуктивність поверхні пристрою, особливо коли береться значна кількість записів растрових операцій.

{{% /alert %}}

Приклад показує, як показано нижче Aspose.Words надає метафілію на бітмапа, коли неможливо правильно надати деякі з записів метафілу до векторної графіки:

{{< gist "aspose-words-gists" "827e71ccc0b8516a3cfe247b86ce6d4e" "Examples-src-main-java-com-aspose-words-examples-rendering_printing-HandleDocumentWarnings-HandleDocumentWarnings.java" >}}

{{< gist "aspose-words-gists" "827e71ccc0b8516a3cfe247b86ce6d4e" "Examples-src-main-java-com-aspose-words-examples-rendering_printing-RenderMetafileToBitmap-RenderMetafileToBitmap.java" >}}
