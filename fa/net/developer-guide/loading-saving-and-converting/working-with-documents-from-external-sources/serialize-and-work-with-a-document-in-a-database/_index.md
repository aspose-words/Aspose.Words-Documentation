---
title: مرتب سازی سند در پایگاه داده
second_title: Aspose.Words برای .NET
articleTitle: سریال سازی و کار با یک سند در یک پایگاه داده
linktitle: سریال سازی و کار با یک سند در یک پایگاه داده
description: "یک سند را به آرایه بایتی برای کار با این سند در پایگاه داده با استفاده از C# تبدیل کنید. شما می توانید یک سند را به و از پایگاه داده ذخیره و بازیابی کنید."
type: docs
weight: 10
url: /fa/net/serialize-and-work-with-a-document-in-a-database/
---

یکی از کارهایی که ممکن است لازم باشد هنگام کار با اسناد انجام دهید، ذخیره و بازیابی اشیاء **Document** به و از پایگاه داده است. به عنوان مثال، اگر شما هر نوع سیستم مدیریت محتوا را پیاده سازی می کنید، این امر ضروری است. تمام نسخه های قبلی اسناد باید در سیستم پایگاه داده ذخیره شوند. توانایی ذخیره اسناد در پایگاه داده نیز زمانی که برنامه شما یک سرویس مبتنی بر وب ارائه می دهد بسیار مفید است.

Aspose.Words توانایی تبدیل یک سند به آرایه بایتی را برای کار بعدی با این سند در پایگاه داده فراهم می کند.

## تبدیل یک سند به آرایه بایت

برای ذخیره یک سند در یک پایگاه داده یا آماده سازی یک سند برای انتقال در سراسر وب، اغلب لازم است که سند را سریالی کنید تا یک آرایه بایتی بدست آورید.

برای سریال کردن یک شی [Document](https://reference.aspose.com/words/net/aspose.words/document/) در Aspose.Words:

1. با استفاده از روش [Save](https://reference.aspose.com/words/net/aspose.words/document/save/) اضافه بار کلاس **Document**، آن را در یک **MemoryStream** ذخیره کنید.
1. متد **ToArray** را فراخوانی کنید، که آرایه ای از بایت ها را نشان می دهد که سند را به شکل بایت نشان می دهد.

سپس مراحل بالا را می توان معکوس کرد تا بایت ها دوباره در یک شی **Document** بارگذاری شوند.

{{% alert color="primary" %}}

فرمت ذخیره انتخاب شده برای اطمینان از حفظ بالاترین وفاداری هنگام ذخیره و بارگذاری مجدد در شی **Document** مهم است. به همین دلیل پیشنهاد می شود از یک سری فرمت فایل OOXML استفاده شود.

{{% /alert %}}

مثال زیر نحوه سریال سازی یک شی **Document** برای به دست آوردن یک آرایه بایت و سپس نحوه غیر سریال سازی آرایه بایت برای به دست آوردن مجدد یک شی **Document** را نشان می دهد:

{{< gist "aspose-com-gists" "0b968ac8900f80c11e109dffb105f3da" "Examples-CSharp-Loading-and-Saving-ConvertDocumentToByte-ConvertDocumentToByte.cs" >}}

فایل قالب این نمونه را می توانید از [Aspose.Words GitHub](https://github.com/aspose-words/Aspose.Words-for-.NET/blob/master/Examples/Data/Document.docx) دانلود کنید.

## ذخیره، خواندن و حذف یک سند در یک پایگاه داده

این بخش نحوه ذخیره یک سند را در پایگاه داده و بارگذاری مجدد آن در یک شیء `Document` برای کار با آن نشان می دهد. برای سادگی، نام فایل کلیدی است که برای ذخیره و واکشی اسناد از پایگاه داده استفاده می شود. پایگاه داده شامل دو ستون است. ستون اول "FileName" به عنوان یک رشته ذخیره می شود و برای شناسایی اسناد استفاده می شود. ستون دوم "FileContent" به عنوان یک شی `BLOB` ذخیره می شود که شی سند را به شکل بایت ذخیره می کند.

مثال کد زیر نحوه تنظیم اتصال به پایگاه داده و اجرای دستورات را نشان می دهد:

{{< gist "aspose-words" "9a306a41bb6aea8adfcabf5a575c5718" "Examples-CSharp-Loading-and-Saving-LoadAndSaveDocToDatabase-OpenDatabaseConnection.cs" >}}

{{% alert color="primary" %}}

در این مثال، ما از پایگاه داده Microsoft Access .mdb برای ذخیره یک سند Aspose.Words استفاده می کنیم.

{{% /alert %}}

مثال کد زیر نشان می دهد که چگونه یک سند را در پایگاه داده ذخیره کنید، سپس همان سند را دوباره بخوانید و در نهایت رکورد حاوی سند را از پایگاه داده حذف کنید:

{{< gist "aspose-words" "9a306a41bb6aea8adfcabf5a575c5718" "Examples-CSharp-Loading-and-Saving-LoadAndSaveDocToDatabase-OpenRetrieveAndDelete.cs" >}}

### یک سند را در یک پایگاه داده ذخیره کنید

همانطور که در ابتدای این مقاله توضیح داده شد، برای ذخیره یک سند در پایگاه داده، این سند را به آرایه ای از بایت تبدیل کنید. سپس، این آرایه بایت را در یک فیلد پایگاه داده ذخیره کنید.

مثال کد زیر نحوه ذخیره یک سند در پایگاه داده مشخص شده را نشان می دهد:

{{< gist "aspose-com-gists" "0b968ac8900f80c11e109dffb105f3da" "Examples-CSharp-Loading-and-Saving-LoadAndSaveDocToDatabase-StoreToDatabase.cs" >}}

CommandString را مشخص کنید که یک عبارت SQL است که تمام کارها را انجام می دهد:

- برای ذخیره یک سند در پایگاه داده، از دستور "INSERT INTO" استفاده می شود و یک جدول به همراه مقادیر دو فیلد رکورد - FileName و FileContent مشخص می شود. برای جلوگیری از پارامترهای اضافی، نام فایل از خود شیء **Document** گرفته شده است. مقدار فیلد `FileContent` بایت هایی از جریان حافظه تخصیص داده می شود که حاوی یک نمایش باینری از سند ذخیره شده است.
- خط باقی مانده کد دستوری را اجرا می کند که سند Aspose.Words را در پایگاه داده ذخیره می کند.

### یک سند را از یک پایگاه داده بازیابی کنید

برای بازیابی یک سند از پایگاه داده، رکورد حاوی داده های سند را به صورت آرایه ای از بایت ها انتخاب کنید. سپس آرایه بایت را از رکورد در **MemoryStream** بارگیری کنید و یک شی **Document** ایجاد کنید که سند را از **MemoryStream** بارگیری می کند.

مثال کد زیر نحوه بازیابی و بازگرداندن یک سند را از پایگاه داده مشخص شده با استفاده از نام فایل به عنوان کلید برای واکشی این سند نشان می دهد:

{{< gist "aspose-com-gists" "0b968ac8900f80c11e109dffb105f3da" "Examples-CSharp-Loading-and-Saving-LoadAndSaveDocToDatabase-ReadFromDatabase.cs" >}}

{{% alert color="primary" %}}

دستور SQL "SELECT * FROM" برای واکشی رکورد مناسب بر اساس نام فایل استفاده می شود.

{{% /alert %}}

### حذف یک سند از پایگاه داده

برای حذف یک سند از پایگاه داده، از دستور SQL مناسب بدون هیچ گونه دستکاری روی شی **Document** استفاده کنید.

مثال کد زیر نحوه حذف یک سند از پایگاه داده را با استفاده از نام فایل برای واکشی رکورد نشان می دهد:

{{< gist "aspose-com-gists" "0b968ac8900f80c11e109dffb105f3da" "Examples-CSharp-Loading-and-Saving-LoadAndSaveDocToDatabase-DeleteFromDatabase.cs" >}}
