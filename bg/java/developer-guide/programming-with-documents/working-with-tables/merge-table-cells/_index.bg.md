---
title: Сливане на таблици клетки в Java
second_title: Aspose.Words вместо Java
articleTitle: Сливане на клетки от таблица
linktitle: Сливане на клетки от таблица
description: "Как да обедините клетките на таблицата в Java. Проверете дали клетките в таблица се сливат, като използвате Java."
type: docs
weight: 40
url: /bg/java/working-with-merged-cells/
timestamp: 2024-01-27-14-07-04
---

Понякога някои редове в таблица изискват заглавие или големи блокове текст, които заемат пълната ширина на таблицата. За правилното проектиране на масата, потребителят може да слее няколко клетки на масата в една. Aspose.Words поддържа слетите клетки при работа с всички входни формати, включително импортиране на HTML съдържание.

## Как да обединим клетките на таблицата

В Aspose.Words, слетите клетки са представени от следните свойства на [CellFormat](https://reference.aspose.com/words/java/com.aspose.words/cellformat/) клас:

- [HorizontalMerge](https://reference.aspose.com/words/java/com.aspose.words/cellformat/#getHorizontalMerge) което описва дали клетката е част от хоризонтално сливане на клетки
- [VerticalMerge](https://reference.aspose.com/words/java/com.aspose.words/cellformat/#getVerticalMerge) което описва дали клетката е част от вертикално сливане на клетки

Стойностите на тези свойства определят сливането на поведението на клетките:

- Първата клетка в поредица от слети клетки ще има [CellMerge.First](https://reference.aspose.com/words/java/com.aspose.words/cellmerge/#FIRST)
- Всички впоследствие слети клетки ще имат [CellMerge.Previous](https://reference.aspose.com/words/java/com.aspose.words/cellmerge/#PREVIOUS)
- Клетка, която не се слива ще има [CellMerge.None](https://reference.aspose.com/words/java/com.aspose.words/cellmerge/#NONE)

![work-with-merged-cells-aspose-words-java](/words/java/working-with-merged-cells/working-with-merged-cells-1.png)

{{% alert color="primary" %}}

Понякога, когато се зареждат съществуващи документни клетки в таблица, те ще изглеждат обединени. Въпреки това, тя всъщност може да бъде една дълга клетка, понякога Microsoft Word износ на слети клетки по този начин. Това може да бъде объркващо, когато се опитвате да работите с отделни клетки, но изглежда няма никакъв конкретен модел, когато това се случи.

{{% /alert %}}

## Проверка дали клетка се свързва

За да проверим дали дадена клетка е част от поредица от слети клетки, просто проверяваме **HorizontalMerge** както и **VerticalMerge** имоти.

Следният пример за код показва как да отпечатате типа хоризонтално и вертикално сливане на клетките:

{{< gist "aspose-words-gists" "4fe6fda3615c0c441401e2131533d93b" "check-cells-merged.java" >}}

## Сливане на таблици клетки при използване на документ строител

Сливане на клетки в таблица, създадена с [DocumentBuilder](https://reference.aspose.com/words/java/com.aspose.words/documentbuilder/), трябва да зададете подходящия тип сливане за всяка клетка, където сливането се очаква по-рано **CellMerge.First** и тогава **CellMerge.Previous**.

Също така, не трябва да забравяте да изчистите настройката за сливане за тези клетки, където не се изисква сливане го може да се направи чрез задаване на първата несливаща се клетка към **CellMerge.None**. Ако това не стане, всички клетки в таблицата ще бъдат обединени.

Следният пример за код показва как да се създаде таблица с два реда, където клетките в първия ред се сливат хоризонтално:

{{< gist "aspose-words-gists" "4fe6fda3615c0c441401e2131533d93b" "horizontal-merge.java" >}}

Следният пример за код показва как да се създаде таблица с две колони, в която клетките в първата колона се сливат вертикално:

{{< gist "aspose-words-gists" "4fe6fda3615c0c441401e2131533d93b" "vertical-merge.java" >}}

## Сливане на таблици клетки в други случаи

В други ситуации, когато **DocumentBuilder** не се използва, като например в съществуваща таблица, сливане на клетки по предишния начин може да не е толкова лесно. Вместо това можем да увием основните операции, свързани с прилагането на сливане на свойствата на клетките в метод, който прави задачата много по-лесна. Този метод е подобен на метода за сливане автоматизация, който се нарича сливане на набор от клетки в таблица.

Кодът по-долу ще слее клетките на таблицата в определения диапазон, започвайки от дадена клетка и завършвайки в крайната клетка. В този случай обхватът може да обхваща няколко реда или колони:

{{< gist "aspose-words-gists" "4fe6fda3615c0c441401e2131533d93b" "merge-cells.java" >}}

Следният пример за код показва как да се слее набор от клетки между две определени клетки:

{{< gist "aspose-words-gists" "4fe6fda3615c0c441401e2131533d93b" "merge-cell-range.java" >}}

## Вертикални и хоризонтални свързващи клетки в HTML таблица

Както казахме в предишните статии, маса в Microsoft Word е набор от независими редове. Всеки ред има набор от клетки, които са независими от клетките на други редове. По този начин в Microsoft Word таблица не съществува такъв обект като готварски, а първата колона е нещо като набор от 1-ви клетки на всеки ред в таблицата. Това позволява на потребителите да имат таблица, в която, например, първият ред се състои от две клетки 2см и 1см, а вторият ред се състои от две различни клетки, които са широки 1см и 2см. И Aspose.Words поддържа тази концепция за масите.

Таблица в HTML има по същество различна структура: всеки ред има еднакъв брой клетки и (това е важно за задачата) всяка клетка има широчината на съответната колона, еднаква за всички клетки в една колона. Така че, ако **HorizontalMerge** както и **VerticalMerge** връщане на неправилна стойност, използвайте следния пример с код:

{{< gist "aspose-words-gists" "4fe6fda3615c0c441401e2131533d93b" "print-horizontal-and-vertical-merged.java" >}}

{{< gist "aspose-words-gists" "4fe6fda3615c0c441401e2131533d93b" "horizontal-and-vertical-merge-helper-classes.java" >}}

## Конвертиране в хоризонтално положение Разделени клетки

Понякога не е възможно да се открият кои клетки се сливат, защото някои по-нови версии на Microsoft Word вече не използват сливащите се флагове, когато клетките се сливат хоризонтално. Но за ситуации, в които клетките се сливат в клетка хоризонтално с широчината си, използвайки сливащи се флагове, Aspose.Words осигурява `ConvertToHorizontallyMergedCells` метод за преобразуване на клетки. Този метод просто трансформира таблицата и добавя нови клетки, когато е необходимо.

Следният пример с код показва гореспоменатия метод в действие:

{{< gist "aspose-words-gists" "4fe6fda3615c0c441401e2131533d93b" "convert-to-horizontally-merged-cells.java" >}}
