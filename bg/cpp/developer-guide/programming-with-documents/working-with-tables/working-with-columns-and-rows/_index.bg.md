---
title: Работа с колони и редове в C++
second_title: Aspose.Words за C++
articleTitle: Работа с колони и редове
linktitle: Работа с колони и редове
description: "Работа с части от таблица – редове, колони и клетки, използващи C++. Посочете Заглавния Ред C++."
type: docs
weight: 30
url: /bg/cpp/working-with-columns-and-rows/
timestamp: 2024-01-27-14-07-04
---

За повече контрол върху начина на работа на таблиците научете как да манипулирате колони и редове.

## Намерете индекса на елементите на таблицата

Колоните, редовете и клетките се управляват чрез достъп до избрания възел на документа по неговия индекс. Намирането на индекса на всеки възел включва събиране на всички дъщерни възли от типа на елемента от родителския възел и след това използване на метода [IndexOf](https://reference.aspose.com/words/cpp/aspose.words/nodecollection/indexof/) за намиране на индекса на желания възел в колекцията.

### Намиране на индекса на таблица в документ

Понякога може да се наложи да направите промени в определена таблица в документ. За да направите това, можете да се обърнете към таблица по нейния индекс.

Следващият пример за код показва как да извлечете индекса на таблица в документ:

{{< gist "aspose-words-gists" "08b4741d451b8f6519bcb0b916f18bb8" "retrieve-table-index.h" >}}

### Намерете индекса на ред в Таблица {#find-the-index-of-a-row-in-a-table}

По същия начин може да се наложи да направите промени в определен ред в избрана таблица. За да направите това, можете също да препращате към ред по неговия индекс.

Следващият пример за код показва как да извлечете индекса на ред в таблица:

{{< gist "aspose-words-gists" "08b4741d451b8f6519bcb0b916f18bb8" "retrieve-row-index.h" >}}

### Намерете индекса на клетка в ред {#find-the-index-of-a-cell-in-a-row}

И накрая, може да се наложи да направите промени в определена клетка и можете да направите това и по Индекс на клетките.

Следващият пример за код показва как да извлечете индекса на клетка в ред:

{{< gist "aspose-words-gists" "08b4741d451b8f6519bcb0b916f18bb8" "retrieve-cell-index.h" >}}

## Работа с колони

В Aspose.Words обектен модел на документ (DOM), [Table](https://reference.aspose.com/words/cpp/aspose.words.tables/table/) възел се състои от [Row](https://reference.aspose.com/words/cpp/aspose.words.tables/row/) възли и след това [Cell](https://reference.aspose.com/words/cpp/aspose.words.tables/cell/) възли. Така, в `Document` обектен модел на Aspose.Words, както и в Word документи, няма концепция за колона.

По дизайн редовете на таблицата в Microsoft Word и Aspose.Words са напълно независими, а основните свойства и операции се съдържат само в редовете и клетките на таблицата. Това дава възможност на таблиците да имат някои интересни атрибути:

- Всеки ред на таблица може да има напълно различен брой клетки
- Вертикално, клетките на всеки ред могат да имат различни ширини
- Възможно е да се присъедините към таблици с различни формати на редове и брой клетки

Всички операции, извършвани върху колони, всъщност са" преки пътища", които извършват операцията, като колективно променят клетките на редовете по такъв начин, че да изглежда, че те се прилагат към колони. Това означава, че можете да извършвате операции върху колони, като просто итерирате върху същия индекс на клетки от редове на таблица.

Следващият пример за код опростява такива операции, като доказва клас фасада, който събира клетките, които съставляват" колона " на таблица:

{{< gist "aspose-words-gists" "08b4741d451b8f6519bcb0b916f18bb8" "column-class.h" >}}

Следващият пример за код показва как да вмъкнете празна колона в таблица:

{{< gist "aspose-words-gists" "08b4741d451b8f6519bcb0b916f18bb8" "insert-blank-column.h" >}}

Следващият пример за код показва как да премахнете колона от таблица в документ:

{{< gist "aspose-words-gists" "08b4741d451b8f6519bcb0b916f18bb8" "remove-column.h" >}}

## Задаване на редове като заглавни редове

Можете да изберете да повторите първия ред в таблицата като заглавен ред само на първата страница или на всяка страница, ако таблицата е разделена на няколко. В Aspose.Words можете да повтаряте заглавния ред на всяка страница, като използвате свойството [HeadingFormat](https://reference.aspose.com/words/cpp/aspose.words.tables/rowformat/get_headingformat/).

Можете също да маркирате няколко заглавни реда, ако тези редове са разположени един след друг в началото на таблицата. За да направите това, трябва да приложите свойствата **HeadingFormat** към тези редове.

{{% alert color="primary" %}}

Обърнете внимание, че заглавните редове не работят в вложени таблици. Това означава, че ако имате маса в друга маса, тази настройка няма да има ефект. Това е ограничение на Microsoft Word, което не позволява това, а не Aspose.Words.

{{% /alert %}}

Следващият пример за код показва как да създадете таблица, която включва заглавни редове, които се повтарят на следващите страници:

{{< gist "aspose-words-gists" "08b4741d451b8f6519bcb0b916f18bb8" "repeat-rows-on-subsequent-pages.h" >}}

## Пазете таблиците и редовете от счупване на страници

Има моменти, когато съдържанието на една таблица не трябва да се разделя на страници. Например, ако заглавието е над таблица, заглавието и таблицата трябва винаги да се съхраняват заедно на една и съща страница, за да се запази правилният външен вид.

Има две отделни техники, които са полезни за постигането на тази функционалност.:

- `Allow row break across pages`, който се прилага към редовете на таблицата
- `Keep with next`, която се прилага към абзаците в клетките на таблицата

По подразбиране горните свойства са забранени.

### Пазете ред от счупване на страници {#keep-a-row-from-breaking-across-pages}

Това включва ограничаване на съдържанието в клетките на ред от разделяне на страница. В Microsoft Word това може да се намери под свойства на таблицата като опцията "Разрешаване на ред да се прекъсне през страници". В Aspose.Words това се намира под [RowFormat](hhttps://reference.aspose.com/words/cpp/aspose.words.tables/rowformat/) обект на а [Row](https://reference.aspose.com/words/cpp/aspose.words.tables/row/) като собственост [RowFormat.AllowBreakAcrossPages](https://reference.aspose.com/words/cpp/aspose.words.tables/rowformat/get_allowbreakacrosspages/).

Следващият пример за код показва как да забраните прекъсването на редове в страници за всеки ред в таблица:

{{< gist "aspose-words-gists" "08b4741d451b8f6519bcb0b916f18bb8" "row-format-disable-break-across-pages.h" >}}

### Пазете таблицата да не се счупи на страници {#keep-a-table-from-breaking-across-pages}

За да спрем разделянето на таблицата на страници, трябва да уточним, че искаме съдържанието, съдържащо се в таблицата, да остане заедно.

За да направите това, Aspose.Words използва метод, който позволява на потребителите да изберат таблица и да разрешат параметъра [KeepWithNext](https://reference.aspose.com/words/cpp/aspose.words/paragraphformat/get_keepwithnext/) да е верен за всеки абзац в клетките на таблицата. Изключение е последният параграф в таблицата, който трябва да бъде зададен като неверен.

Следващият пример за код показва как да зададете таблица, за да останат заедно на една и съща страница:

{{< gist "aspose-words-gists" "08b4741d451b8f6519bcb0b916f18bb8" "keep-table-together.h" >}}
