---
title: Вложени Mail Merge С региони в C++
second_title: Aspose.Words за C++
articleTitle: Вложени Mail Merge С региони
linktitle: Вложени Mail Merge С региони
type: docs
description: "Извършете операция Mail Merge с вложени региони, използвайки C++. Вложено обединяване е функция, която ви позволява да обедините йерархични данни от вашия източник на данни във вашия шаблон за обединяване."
keywords: "mail merge with nested regions c++"
weight: 30
url: /bg/cpp/nested-mail-merge-with-regions/
timestamp: 2024-09-24-14-35-44
---

В някои сценарии може да се наложи да използвате вложени Mail Merge С региони. Вложено обединяване е функция, която ви позволява да обедините йерархични данни от вашия източник на данни във вашия шаблон за обединяване, за да попълните лесно вашия документ. По принцип йерархичните данни се представят като набор от елементи от данни, а йерархичните зависимости описват как елементите от данни са свързани помежду си (един елемент от данни е родител на друг).

Aspose.Words ви позволява да извършите операция Mail Merge с вложени региони. Можете да използвате тази функция, ако имате източник на данни, който е организиран в дървовидна структура и искате да изпълните операция Mail Merge, за да попълните шаблон с йерархични данни.

{{% alert color="primary" %}}

Вложен Mail Merge е от значение само когато изпълнява а Mail Merge С региони.

{{% /alert %}}

## Какво е вложено Mail Merge

Областта Mail Merge се нарича вложена, ако имате две или повече Mail Merge региони, където един от тях е вътре в другия в йерархична форма. Имайте предвид, че всеки регион съдържа данни от една таблица.

Най-често срещаният пример за вложено Mail Merge е поръчка, която съдържа няколко елемента, където трябва да свържете много таблици с данни и да представите информацията в шаблон.

Снимката по-долу показва два вложени региона, където регионът *Order* Mail Merge е родител на региона *Item* Mail Merge.

<img src="nested-mail-merge-with-regions-1.png" alt="nested_mail_merge_with_regions" style="width:650px"/>

## Как да обработваме Mail Merge С вложени региони

Данните, които трябва да бъдат обединени в шаблон, могат да идват от различни източници, главно релационни бази данни или XML документи. В нашия пример ще използваме [SQLite](https://www.sqlite.org/index.html) база данни за съхранение на нашите данни и да го заредите с потребителски източник на данни изпълнение.

Изображението по-долу показва как данните от таблицата *Order*, предадени на вложените региони за обединяване, ще бъдат свързани с таблицата *Item*, както и резултатите, генерирани по време на операцията по сливане.

<img src="nested-mail-merge-with-regions-2.png" alt="mail_merge_with_nested_regions" style="width:650px"/>

Както можете да видите от изходния документ, всяка поръчка от таблицата **Order** се вмъква в шаблона за обединяване с всички свързани с поръчката елементи от таблицата **Item**. Следващата поръчка ще бъде вмъкната заедно с техните артикули, докато не бъдат изброени всички поръчки и артикули. Редът на влагане Mail Merge С региони в шаблона трябва да съответства на релациите от данни между таблиците в източника на данни.

## Как да създадете Релации от потребителски източник на данни

Имплементирайте интерфейса [IMailMergeDataSource](https://reference.aspose.com/words/cpp/aspose.words.mailmerging/imailmergedatasource/), За да създадете релации в структурата родител-дете на вашия потребителски източник на данни. Използвайте метода [GetChildDataSource](https://reference.aspose.com/words/cpp/aspose.words.mailmerging/imailmergedatasource/getchilddatasource/), за да върнете съответните данни на детето от текущия запис на родител.

Следващият пример за код показва как да генерирате фактура, използвайки вложени Mail Merge с региони от [SQLite](https://www.sqlite.org/index.html) база данни със [SQLiteCpp](https://github.com/SRombauts/SQLiteCpp):

{{< gist "aspose-words-gists" "3435df005db9907ec9ba3a6b777ae6fb" "nested-mail-merge.h" >}}
