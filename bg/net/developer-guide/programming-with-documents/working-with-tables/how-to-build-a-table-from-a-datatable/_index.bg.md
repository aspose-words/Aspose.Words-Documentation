---
title: Как да се изгради таблица от `DataTable` в C#
second_title: Aspose.Words вместо .NET
articleTitle: Изграждане на таблица от `DataTable`
linktitle: Изграждане на таблица от `DataTable`
description: "Пример за попълване на таблица с документи от външна база данни, като се използва C#."
type: docs
weight: 120
url: /bg/net/how-to-build-a-table-from-a-datatable/
timestamp: 2024-09-25-11-08-55
---

Често вашето приложение ще изтегли данни от база данни и ще го съхранява под формата на **DataTable**. Можете лесно да въведете тези данни във вашия документ като нова таблица и бързо да приложите форматиране на цялата таблица.

{{% alert color="primary" %}}

Имайте предвид, че предпочитаният начин за въвеждане на данни от a **DataTable** в таблица с документи се използва [Mail Merge с региони](/words/net/types-of-mail-merge-operations/#mail-merge-with-regions). Техниката, представена в тази статия, се предлага само ако не сте в състояние да създадете подходящ шаблон преди ръка, за да се слеят данни с, с други думи, ако се изисква всичко да се случи програмно.

{{% /alert %}}

Използване Aspose.Words, лесно можете да извлечете данни от база данни и да ги съхранявате като таблица:

1. Създаване на нов **DocumentBuilder** Възразявам. **Document**.
1. Създаване на нова таблица с помощта на **DocumentBuilder**.
1. Ако искаме да вмъкнем имената на всяка от колоните от нашите **DataTable** като заглавен ред след това итерат през всяка колона данни и напишете имената на колоните в ред в таблицата.
1. Итерат през всеки **DataRow** в **DataTable**:
   1. Итерат през всеки обект в **DataRow**.
   1. Въведете обекта в документа, като използвате **DocumentBuilder**. Използваният метод зависи от вида на обекта, който се вмъква, например **DocumentBuilder.Writeln** за текст и **DocumentBuilder.InsertImage** за байт масив, който представлява изображение.
   1. В края на обработката **DataRow** Също така край на реда, създаден от **DocumentBuilder** чрез **DocumentBuilder.EndRow**.
1. След като всички редове от **DataTable** Бяха обработени довършвайки таблицата с обаждане **DocumentBuilder.EndTable**.
1. Накрая можем да зададете желания стил таблица с помощта на един от подходящите свойства таблица като **Table.StyleIdentifier** автоматично да се прилага форматиране на цялата таблица.

На **ImportTableFromDataTable** метод приема **DocumentBuilder** обект, **DataTable** съдържащ данните и флаг, който посочва дали заглавието на колоната от **DataTable** са включени в горната част на масата. Този метод изгражда таблица от тези параметри, използвайки текущата позиция и форматирането на сградата. Предоставя метод за внос на данни от `DataTable` и да го поставите в нова таблица с помощта на DocumentBuilder.

Следните данни в нашия **DataTable** се използва в този пример:

![how-to-build-a-table-from-a-datatable-aspose-words-net](/words/net/how-to-build-a-table-from-a-datatable/how-to-build-a-table-from-a-datatable-1.png)

Следният пример за код показва как да се изпълни горния алгоритъм в Aspose.Words:

{{< gist "aspose-words-gists" "affb937d8f345f60e6a506e1da3db9fa" "import-table-from-data-table.cs" >}}

След това методът може лесно да се нарече използване на вашия **DocumentBuilder** и данни.

Следният пример за код показва как да се внасят данните от a `DataTable` и да го поставите в нова таблица в документа:

{{< gist "aspose-words-gists" "affb937d8f345f60e6a506e1da3db9fa" "build-table-from-data-table.cs" >}}
