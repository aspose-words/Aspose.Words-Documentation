---
title: Проследяване на промените в документ в C#
second_title: Aspose.Words вместо .NET
articleTitle: Запис на промените в документ
linktitle: Запис на промените в документ
description: "Проследяване на промените в съдържанието и форматирането, направени от вас или други, използвайки C#. Достъп до индивидуални ревизии в документ и прилагане на различни свойства за тях."
type: docs
weight: 270
url: /bg/net/track-changes-in-a-document/
---

Функционалността на промените в релсите, известни също като преглед, ви позволява да следите промените в съдържанието и форматирането, направени от вас или други потребители. Функция за промяна на песента с Aspose.Words поддържа промените в следите Microsoft Word. С тази функционалност можете да получите достъп до индивидуални ревизии във вашия документ и да приложите различни свойства към тях.

Когато активирате функцията за промяна на песента, всички въведени, изтрити и променени елементи на документа ще бъдат визуално подчертани с информация за това от кого, кога и какво е променено. Обекти, които носят информация за това, което е било променено, се наричат "проследяване на промените." Например, да предположим, че искате да прегледате документ и да направите важни промени, това може да означава, че трябва да направите ревизии. Също така може да се наложи да вмъкнете коментари, за да обсъдите някои от промените. Тук идват промените в документите.

Тази статия обяснява как да се управляват и проследяват промените, създадени от много рецензенти на същия документ, както и свойствата за проследяване на промените.

{{% alert color="primary" %}}

Имайте предвид, че коментарът в Aspose.Words, както и в Microsoft Word, могат да бъдат свързани с проследяване на промени. Не забравяйте обаче, че коментарите са напълно независими от проследяването на промените.

{{% /alert %}}

## Какво представлява преразглеждането

Преди да се потопиш в ревизиите, нека да обясним значението на ревизиите. A [revision](https://reference.aspose.com/words/net/aspose.words/revision/) е промяна, която настъпва в един възел на документ по време на група за преразглеждане, представена от [RevisionGroup](https://reference.aspose.com/words/net/aspose.words/revision/group/) клас, е група от последователни ревизии, които се появяват в много възли на документ. По принцип преразглеждането е средство за проследяване на промените.

Преработките се използват в функцията за проследяване на промените и в рамките на функцията за сравнение на документите, където ревизиите се появяват в резултат на сравнение. Така че ревизиите в функцията за проследяване на промените показват от кого и какво е променено.

{{% alert color="primary" %}}

Имайте предвид, че Microsoft Word не ви позволява да разглеждате индивидуални ревизии, а само да разглеждате последователни ревизии като едно цяло. Но... Aspose.Words решава това ограничение с **RevisionGroup** Клас.

{{% /alert %}}

Aspose.Words подкрепя различни видове преразглеждане, както и в Microsoft Word, като вмъкване, изтриване, формат Промяна, styleDefinition Промяна и движение. Всички видове ревизия са представени с [RevisionType](https://reference.aspose.com/words/net/aspose.words/revisiontype/) Изброяване.

{{% alert color="primary" %}}

Обърнете внимание, че ревизиите имат резултат подобен на Microsoft Word но Aspose.Words не открива форматиране по време на проследяване на промените.

{{% /alert %}}

## Начало и спиране на проследяването на промените

Редактирането на документ обикновено не се брои за ревизия, докато не започнете да го проследявате. Aspose.Words позволява автоматично проследяване на всички промени във вашия документ с прости стъпки. Можете лесно да започнете процеса на проследяване на промените с помощта на [StartTrackRevisions](https://reference.aspose.com/words/net/aspose.words/document/starttrackrevisions/#starttrackrevisions/) метод. Ако трябва да спрете процеса на проследяване на промените, така че всички бъдещи редактирания да не се считат за ревизии, ще трябва да използвате [StopTrackRevisions](https://reference.aspose.com/words/net/aspose.words/document/stoptrackrevisions/) метод.

{{% alert color="primary" %}}

Имайте предвид, че `StartTrackingRevisions` метод не променя състоянието на [TrackRevisions](https://reference.aspose.com/words/net/aspose.words/document/trackrevisions/) собственост и не използва стойността си за целите на проследяване на преразглеждането. Освен това, ако възел е бил преместен от едно място на друго вътре в проследявания документ, тогава ще бъдат създадени промени в движението, включително преместване от и преминаване към обхват.

{{% /alert %}}

В края на процеса на проследяване на промените във вашия документ, ще имате възможността дори да приемете всички ревизии или да ги отхвърлите, за да върнете документа в първоначалния му вид. Това може да се постигне с помощта на [AcceptAllRevisions](https://reference.aspose.com/words/net/aspose.words/document/acceptallrevisions/) или [RejectAll](https://reference.aspose.com/words/net/aspose.words/revisioncollection/rejectall/) метод. В допълнение, можете да приемете или отхвърлите всяко преразглеждане отделно чрез използване на [Accept](https://reference.aspose.com/words/net/aspose.words/revision/accept/) или [Reject](https://reference.aspose.com/words/net/aspose.words/revision/reject/) метод.

Всички промени ще бъдат проследени за една итерация от момента, в който започнете процеса до момента, в който го спрете. Връзката между различните итерации е представена като следния сценарий: завършвате процеса на проследяване, след това правите някои промени и започвате проследяване на промените отново. С този сценарий всички промени, които не сте приели или отхвърлили, ще бъдат показани отново.

{{% alert color="primary" %}}

Имайте предвид, че `AcceptAllRevisions` метод е подобен на ... Microsoft Word.

{{% /alert %}}

Следният пример за код показва как да се работи с промените в проследяването:

{{< gist "aspose-words-gists" "eacc4fc7407a98d683f3084bb86d58f7" "Examples-DocsExamples-DocsExamples-Programming with Documents-Working with Revisions-AcceptAllRevisions.cs" >}}

Следният пример за код показва как се генерират ревизии при преместване на възел в проследяван документ:

{{< gist "aspose-words-gists" "eacc4fc7407a98d683f3084bb86d58f7" "Examples-DocsExamples-DocsExamples-Programming with Documents-Working with Revisions-MoveNodeInTrackedDocument.cs" >}}

## Управление и магазин промени като ревизия

С предишната функция за проследяване на промените можете да разберете кои промени са направени във вашия документ и кой е направил тези промени. Докато с [TrackRevisions](https://reference.aspose.com/words/net/aspose.words/document/trackrevisions/) функция, принуждавате всички промени в документа си да се съхраняват като ревизии.

Aspose.Words позволява да проверите дали документът има ревизия или не чрез използване на [HasRevision](https://reference.aspose.com/words/net/aspose.words/document/hasrevisions/) собственост. Ако не е необходимо автоматично проследяване на промените във вашия документ чрез StartTrackRevisions и StopTrackRevisions методи, тогава можете да използвате `TrackRevisions` Имот за проверка дали промените се проследяват при редактиране на документ в Microsoft Word и се съхранява като ревизии.

На `TrackRevisions` функцията прави ревизии вместо истински DOM промени. Но самите ревизии са отделни. Например, Ако изтриете параграф, Aspose.Words Направете го като ревизия, маркирайте го като изтриване, вместо да го изтривате.

Освен това, Aspose.Words позволява да проверите дали даден обект е бил поставен, изтрит или променен форматиращ с помощта на [IsDeleteRevision](https://reference.aspose.com/words/net/aspose.words/inline/isdeleterevision/), [IsFormatRevision](https://reference.aspose.com/words/net/aspose.words/inline/isformatrevision/), [IsInsertRevision](https://reference.aspose.com/words/net/aspose.words/inline/isinsertrevision/), [IsMoveFromRevision](https://reference.aspose.com/words/net/aspose.words/inline/ismovefromrevision/), както и [IsMoveToRevision](https://reference.aspose.com/words/net/aspose.words/inline/ismovetorevision/) имоти.

{{% alert color="primary" %}}

Имайте предвид, че няма връзка между самите ревизии и `TrackRevisions` собственост. В допълнение, можете да приемете/отменете ревизиите независимо от функцията за проследяване на промените.

{{% /alert %}}

Следният пример за код показва как да се прилагат различни свойства с ревизии:

{{< gist "aspose-words-gists" "eacc4fc7407a98d683f3084bb86d58f7" "Examples-DocsExamples-DocsExamples-Programming with Documents-Working with Revisions-ShapeRevision.cs" >}}
