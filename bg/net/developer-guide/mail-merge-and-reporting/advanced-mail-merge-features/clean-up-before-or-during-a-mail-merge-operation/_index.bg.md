---
title: Почистване преди или по време на Mail Merge
second_title: Aspose.Words за .NET
articleTitle: Почистване преди или по време на операция Mail Merge
linktitle: Почистване преди или по време на операция Mail Merge
type: docs
description: "Приложете различни опции за почистване и премахване, като например изтриване на полетата за обединяване, преди да извършите операция Mail Merge или премахване на неизползваните региони по време на операция Mail Merge, използвайки C#."
keywords: "cleanup options Mail Merge c#"
weight: 10
url: /bg/net/clean-up-before-or-during-mail-merge/
timestamp: 2024-07-11-08-07-06
---

Aspose.Words ви позволява да прилагате различни опции за почистване и премахване, като например изтриване на полета за обединяване, преди да извършите операция Mail Merge или премахване на неизползвани региони по време на операция Mail Merge. Този раздел ще обясни как да изтриете обединени полета и как да настроите опция за премахване.

## Изтриване На Обединени Полета

Когато използвате някой дълъг шаблон, който е създаден от някой друг, може да искате да изтриете всички полета за обединяване, които вече съществуват в този шаблон, преди да извършите операция Mail Merge. Можете да използвате метода [DeleteFields](https://reference.aspose.com/words/net/aspose.words.mailmerging/mailmerge/deletefields/), ако искате да изтриете всички полета за обединяване от документ, без да изпълнявате операция Mail Merge. Този метод не се влияе от опциите за премахване на свойството [CleanupOptions](https://reference.aspose.com/words/net/aspose.words.mailmerging/mailmerge/cleanupoptions/) и изпълнението му премахва само Обединените полета, а не всички съдържащи полета или празни параграфи.

Следващият пример за код показва как да изтриете всички полета за обединяване от вашия шаблон, без да изпълнявате операция Mail Merge:

{{< gist "aspose-words-gists" "f39874821cb317d245a769c9ce346fea" "delete-fields.cs" >}}

## Задаване на опция `Removing`

Aspose.Words ви позволява да премахнете неергирани полета, региони и абзаци от шаблон по време на операция Mail Merge, като използвате Опции за премахване.

Използвайте свойството **CleanupOptions** заедно с изброяването [MailMergeCleanupOptions](https://reference.aspose.com/words/net/aspose.words.mailmerging/mailmergecleanupoptions/), за да зададете опцията Премахване. Посочете кои елементи искате да премахнете, като изберете следните опции (можете да комбинирате повече от един):

* Премахване на празни параграфи
* Премахване на неизползвани региони
* Премахване на неизползвани полета
* Премахване на съдържащи полета
* Премахване на статични полета
* Премахване на празните редове на таблицата

Можете да считате поле за обединяване като неергирано в едно от следните условия::

1. Ако полето за обединяване в източника на данни няма колона или поле за съпоставяне.
2. Ако полето за обединяване в източника на данни съдържа поле за съпоставяне, но данните са нулеви.

{{% alert color="primary" %}}

Ако обединявате данни с помощта на отделни източници на данни, тези опции за премахване ще бъдат разрешени само с последното повикване на метода Mail Merge изпълнение.

{{% /alert %}}

### Премахване На Празни Параграфи

Абзац, който включва само полета за обединяване, ще бъде празен, когато процесът Mail Merge премахне всички негови полета за обединяване като неначислени. Тези празни параграфи могат да добавят нежелано място и да променят начина, по който ще изглежда генерираният отчет. Може да се сблъскате с две ситуации с абзаци по време на операция Mail Merge:

1. Полето Mail Merge ще бъде обединено с празни данни.
2. Полето за обединяване е неизползвано и ще бъде премахнато.

И в двата случая опцията **RemoveEmptyParagraphs** автоматично ще премахне празните абзаци от документа. Също така ще премахне полетата `TableStart` и TableEnd обединяване, ако останалата част от абзаца е празна.

Следващият пример за код показва как да премахнете празните параграфи:

{{< gist "aspose-words-gists" "f39874821cb317d245a769c9ce346fea" "remove-empty-paragraphs.cs" >}}

{{% alert color="primary" %}}

Можете да изтеглите примерния файл на този пример от [Aspose.Words GitHub](https://github.com/aspose-words/Aspose.Words-for-.NET/blob/master/Examples/Data/Table%20with%20fields.docx).

{{% /alert %}}

### Премахване На Неизползвани Региони

В предишните версии на Aspose.Words празните Mail Merge региони бяха премахнати автоматично от документа по време на операцията Mail Merge. С най-новата версия на приложението.думи, празни Mail Merge региони остават след операцията Mail Merge по подразбиране. Въпреки това, можете да използвате опцията **RemoveUnusedRegions**, за да премахнете неизползваните Mail Merge региони по време на операцията Mail Merge. Например можете да обедините документ с празен източник на данни, съдържащ таблици с данни, които водят до неизползвани региони в документа.

Следващият пример за код показва как да премахнете неизползваните региони за обединяване:

{{< gist "aspose-words-gists" "f39874821cb317d245a769c9ce346fea" "remove-unmerged-regions.cs" >}}

{{% alert color="primary" %}}

Можете да изтеглите примерния файл на този пример от [Aspose.Words GitHub](https://github.com/aspose-words/Aspose.Words-for-.NET/blob/master/Examples/Data/Mail%20merge%20destination%20-%20Northwind%20suppliers.docx).

{{% /alert %}}

**Забележка**

### Премахване На Неизползвани Полета

Aspose.Words ви позволява да премахнете всички неизползвани Mail Merge полета, като присвоите флаг **RemoveUnusedFields** на **CleanupOptions**. Тази опция ще премахне полетата за обединяване, които нямат съответните данни в източника на данни.

Следващият пример за код показва как да премахнете всички неизползвани полета за обединяване от документ автоматично по време на операция Mail Merge:

{{< gist "aspose-words-gists" "f39874821cb317d245a769c9ce346fea" "remove-unused-fields.cs" >}}

### Премахване На Съдържащи Полета

Полето за обединяване може да се съдържа в друго поле, като например поле **IF** или поле за Формула. Премахнете това външно поле, когато полето за обединяване се обедини или премахне от документа.

Следващият пример за код показва как да премахнете полета, които съдържат полета за обединяване от документ:

{{< gist "aspose-words-gists" "f39874821cb317d245a769c9ce346fea" "remove-containing-fields.cs" >}}

**Забележка**

### Премахване На Празните Редове На Таблицата

Aspose.Words ви позволява да премахнете празните редове на таблицата, като присвоите флаг **RemoveEmptyTableRows** на **CleanupOptions**. Тази опция ще премахне редовете на таблицата, които съдържат празни полета за обединяване.

Следващият пример за код показва как да премахнете празните редове на таблица, които съдържат Mail Merge региони от документ:

{{< gist "aspose-words-gists" "f39874821cb317d245a769c9ce346fea" "remove-empty-table-rows.cs" >}}
