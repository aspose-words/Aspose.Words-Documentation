---
title: Сливане на таблици клетки
second_title: Aspose.Words вместо Python via .NET
articleTitle: Сливане на таблици клетки
linktitle: Сливане на таблици клетки
description: "Как да се слее таблица клетки в Python. Проверете дали клетките в таблица се сливат с помощта на Python."
type: docs
weight: 40
url: /bg/python-net/working-with-merged-cells/
---

Понякога някои редове в таблица изискват заглавие или големи блокове от текст, които заемат пълната ширина на таблицата. За правилното проектиране на масата, потребителят може да слее няколко клетки на масата в една. Aspose.Words поддържа слетите клетки при работа с всички входни формати, включително внос на HTML съдържание.

## Как да се сливат клетки маса

В Aspose.Words, Слетите клетки са представени от следните свойства на [CellFormat](https://reference.aspose.com/words/python-net/aspose.words.tables/cellformat/) клас:

- [HorizontalMerge](https://reference.aspose.com/words/python-net/aspose.words.tables/cellformat/horizontal_merge/) което описва дали клетката е част от хоризонтално сливане на клетки
- [VerticalMerge](https://reference.aspose.com/words/python-net/aspose.words.tables/cellformat/vertical_merge/) което описва дали клетката е част от вертикално сливане на клетки

Стойностите на тези свойства определят сливането на поведението на клетките:

- Първата клетка в поредица от слети клетки ще има [CellMerge.First](https://reference.aspose.com/words/python-net/aspose.words.tables/cellmerge/#first)
- Всички впоследствие слети клетки ще имат [CellMerge.Previous](https://reference.aspose.com/words/python-net/aspose.words.tables/cellmerge/#previous)
- Клетка, която не се слива ще има [CellMerge.None](https://reference.aspose.com/words/python-net/aspose.words.tables/cellmerge/#none)

{{% alert color="primary" %}}

Понякога, когато се зареждат съществуващи документни клетки в таблица, те ще изглеждат обединени. Въпреки това, тя всъщност може да бъде една дълга клетка понякога Microsoft Word износ на слети клетки по този начин. Това може да бъде объркващо, когато се опитвате да работите с отделни клетки, но изглежда няма никакъв конкретен модел, когато това се случи.

{{% /alert %}}

## Проверете дали клетката е разбъркана

За да проверим дали клетката е част от поредица от слети клетки, просто проверяваме **HorizontalMerge** както и **VerticalMerge** имоти.

Следният пример за код показва как да отпечатате типа хоризонтално и вертикално сливане на клетки:

{{< gist "aspose-words-gists" "b89ea9092bd2486dc056818cf4f73e24" "check-cells-merged.py" >}}

{{% alert color="primary" %}}

Можете да изтеглите примерния файл от [Aspose.Words GitHub](https://github.com/aspose-words/Aspose.Words-for-Python-via-.NET/blob/master/Examples/Data/Table%20with%20merged%20cells.docx).

{{% /alert %}}

## Сливане на таблици клетки при използване на документ строител

Сливане на клетките в таблица, създадена с [DocumentBuilder](https://reference.aspose.com/words/python-net/aspose.words/documentbuilder/), трябва да зададете подходящия тип сливане за всяка клетка, където сливането се очаква. **CellMerge.First** и тогава **CellMerge.Previous**.

Също така, не трябва да забравяте да изчистите настройката за сливане за тези клетки, където не се изисква сливане. **CellMerge.None**. Ако това не се направи, всички клетки в таблицата ще бъдат обединени.

Следният пример за код показва как да се създаде таблица с два реда, където клетките в първия ред се сливат хоризонтално:

{{< gist "aspose-words-gists" "b89ea9092bd2486dc056818cf4f73e24" "horizontal-merge.py" >}}

Следният пример за код показва как да се създаде таблица с две колони, в която клетките в първата колона се сливат вертикално:

{{< gist "aspose-words-gists" "b89ea9092bd2486dc056818cf4f73e24" "vertical-merge.py" >}}

## Сливане на таблици клетки в други случаи

В други ситуации, когато **DocumentBuilder** не се използва, като например в съществуваща таблица, сливането на клетките по предишния начин може да не е толкова лесно. Вместо това можем да увием основните операции, свързани с прилагането на сливащи се свойства към клетките в метод, който улеснява задачата. Този метод е подобен на метода за сливане на автоматизация, който се нарича сливане на набор от клетки в таблица.

Кодът по-долу ще слее клетките на таблицата в определения диапазон, като се започне от дадена клетка и завършва в крайната клетка. В този случай обхватът може да обхваща няколко реда или колони:

{{< gist "aspose-words-gists" "b89ea9092bd2486dc056818cf4f73e24" "merge-cells.py" >}}

Следният пример за код показва как да се слее набор от клетки между две определени клетки:

{{< gist "aspose-words-gists" "b89ea9092bd2486dc056818cf4f73e24" "merge-cell-range.py" >}}

{{% alert color="primary" %}}

Можете да изтеглите примерния файл от [Aspose.Words GitHub](https://github.com/aspose-words/Aspose.Words-for-Python-via-.NET/blob/master/Examples/Data/Table%20with%20merged%20cells.docx).

{{% /alert %}}

В зависимост от версията на рамката, която използвате, може да искате да усъвършенствате този метод, като го превърнете в метод на разширение. В този случай, можете да наречете този метод директно върху клетка, за да се слее набор от клетки, като `cell1.Merge(cell2)`.

## Конвертиране хоризонтално Разделени клетки

Понякога не е възможно да се открият кои клетки се сливат, защото някои по-нови версии на Microsoft Word не използват повече сливащи се флагове, когато клетките се сливат хоризонтално. Но за ситуации, в които клетките се сливат в клетка хоризонтално по широчина, използвайки сливащи се флагове, Aspose.Words осигурява `ConvertToHorizontallyMergedCells` метод за преобразуване на клетките. Този метод просто трансформира таблицата и добавя нови клетки, когато е необходимо.

Следният пример с код показва гореспоменатия метод в действие:

{{< gist "aspose-words-gists" "b89ea9092bd2486dc056818cf4f73e24" "convert-to-horizontally-merged-cells.py" >}}
