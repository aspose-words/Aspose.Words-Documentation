---
title: تسلسل المستند في قاعدة بيانات
second_title: Aspose.Words لـ .NET
articleTitle: إجراء تسلسل والعمل مع مستند في قاعدة بيانات
linktitle: إجراء تسلسل والعمل مع مستند في قاعدة بيانات
description: "قم بتحويل مستند إلى مصفوفة بايت للعمل مع هذا المستند في قاعدة بيانات باستخدام C#. يمكنك تخزين واسترجاع مستند من وإلى قاعدة البيانات."
type: docs
weight: 10
url: /ar/net/serialize-and-work-with-a-document-in-a-database/
---

إحدى المهام التي قد تحتاج إلى إنجازها عند العمل مع المستندات هي تخزين واسترجاع كائنات **Document** من وإلى قاعدة البيانات. على سبيل المثال، قد يكون هذا ضروريًا إذا كنت تقوم بتنفيذ أي نوع من نظام إدارة المحتوى. يجب تخزين جميع الإصدارات السابقة من المستندات في نظام قاعدة البيانات. تعد القدرة على تخزين المستندات في قاعدة البيانات مفيدة للغاية أيضًا عندما يوفر تطبيقك خدمة قائمة على الويب.

يوفر Aspose.Words القدرة على تحويل مستند إلى مصفوفة بايت للعمل اللاحق مع هذا المستند في قاعدة البيانات.

## تحويل مستند إلى صفيف بايت

لتخزين مستند في قاعدة بيانات أو لإعداد مستند لإرساله عبر الويب، غالبًا ما يكون من الضروري إجراء تسلسل للمستند للحصول على مصفوفة بايت.

لإجراء تسلسل لكائن [Document](https://reference.aspose.com/words/net/aspose.words/document/) في Aspose.Words:

1. احفظه في **MemoryStream** باستخدام التحميل الزائد لأسلوب [Save](https://reference.aspose.com/words/net/aspose.words/document/save/) لفئة **Document**.
1. استدعاء الأسلوب **ToArray**، الذي يقوم بإرجاع مجموعة من البايتات التي تمثل المستند في شكل بايت.

يمكن عكس الخطوات المذكورة أعلاه لتحميل البايتات مرة أخرى إلى كائن **Document**.

{{% alert color="primary" %}}

يعد تنسيق الحفظ المحدد مهمًا لضمان الحفاظ على أعلى دقة عند الحفظ وإعادة التحميل في كائن **Document**. لهذا السبب، يُقترح استخدام سلسلة من تنسيقات ملفات OOXML.

{{% /alert %}}

يوضح المثال أدناه كيفية إجراء تسلسل لكائن **Document** للحصول على مصفوفة بايت، ثم كيفية إلغاء تسلسل مصفوفة البايت للحصول على كائن **Document** مرة أخرى:

{{< gist "aspose-com-gists" "0b968ac8900f80c11e109dffb105f3da" "Examples-CSharp-Loading-and-Saving-ConvertDocumentToByte-ConvertDocumentToByte.cs" >}}

يمكنك تنزيل ملف القالب الخاص بهذا المثال من [Aspose.Words GitHub](https://github.com/aspose-words/Aspose.Words-for-.NET/blob/master/Examples/Data/Document.docx).

## تخزين وقراءة وحذف مستند في قاعدة بيانات

يوضح هذا القسم كيفية حفظ مستند في قاعدة بيانات ثم تحميله مرة أخرى إلى كائن `Document` للعمل معه. للتبسيط، اسم الملف هو المفتاح المستخدم لتخزين المستندات وجلبها من قاعدة البيانات. تحتوي قاعدة البيانات على عمودين. يتم تخزين العمود الأول "اسم الملف" كسلسلة ويستخدم لتحديد المستندات. يتم تخزين العمود الثاني "FileContent" ككائن `BLOB` الذي يخزن كائن المستند في شكل بايت.

يوضح مثال التعليمات البرمجية التالي كيفية إعداد اتصال بقاعدة بيانات وتنفيذ الأوامر:

{{< gist "aspose-words" "9a306a41bb6aea8adfcabf5a575c5718" "Examples-CSharp-Loading-and-Saving-LoadAndSaveDocToDatabase-OpenDatabaseConnection.cs" >}}

{{% alert color="primary" %}}

في هذا المثال، نستخدم قاعدة بيانات Microsoft Access .mdb لتخزين مستند Aspose.Words.

{{% /alert %}}

يوضح مثال التعليمات البرمجية التالي كيفية حفظ مستند في قاعدة البيانات، ثم قراءة نفس المستند مرة أخرى، وأخيرًا حذف السجل الذي يحتوي على المستند من قاعدة البيانات:

{{< gist "aspose-words" "9a306a41bb6aea8adfcabf5a575c5718" "Examples-CSharp-Loading-and-Saving-LoadAndSaveDocToDatabase-OpenRetrieveAndDelete.cs" >}}

### حفظ مستند إلى قاعدة بيانات

لحفظ مستند في قاعدة بيانات، قم بتحويل هذا المستند إلى صفيف من البايتات، كما هو موضح في بداية هذه المقالة. ثم قم بحفظ صفيف البايت هذا في حقل قاعدة بيانات.

يوضح مثال التعليمات البرمجية التالي كيفية حفظ مستند في قاعدة البيانات المحددة:

{{< gist "aspose-com-gists" "0b968ac8900f80c11e109dffb105f3da" "Examples-CSharp-Loading-and-Saving-LoadAndSaveDocToDatabase-StoreToDatabase.cs" >}}

حدد CommandString، وهو تعبير SQL الذي يقوم بكل العمل:

- لحفظ مستند في قاعدة البيانات، يتم استخدام الأمر "INSERT INTO" ويتم تحديد جدول مع قيم حقلي سجل - FileName وFileContent. لتجنب المعلمات الإضافية، يتم أخذ اسم الملف من كائن **Document** نفسه. يتم تعيين قيمة حقل `FileContent` بالبايتات من دفق الذاكرة، الذي يحتوي على تمثيل ثنائي للمستند المخزن.
- ينفذ السطر المتبقي من التعليمات البرمجية الأمر الذي يخزن مستند Aspose.Words في قاعدة البيانات.

### استرداد مستند من قاعدة بيانات

لاسترداد مستند من قاعدة البيانات، حدد السجل الذي يحتوي على بيانات المستند كصفيف من البايتات. ثم قم بتحميل مصفوفة البايت من السجل إلى **MemoryStream** وقم بإنشاء كائن **Document** الذي سيقوم بتحميل المستند من **MemoryStream**.

يوضح مثال التعليمات البرمجية التالي كيفية استرداد مستند وإعادته من قاعدة البيانات المحددة باستخدام اسم الملف كمفتاح لجلب هذا المستند:

{{< gist "aspose-com-gists" "0b968ac8900f80c11e109dffb105f3da" "Examples-CSharp-Loading-and-Saving-LoadAndSaveDocToDatabase-ReadFromDatabase.cs" >}}

{{% alert color="primary" %}}

يتم استخدام أمر SQL "SELECT * FROM" لجلب السجل المناسب بناءً على اسم الملف.

{{% /alert %}}

### حذف مستند من قاعدة بيانات

لحذف مستند من قاعدة البيانات، استخدم أمر SQL المناسب دون أي معالجة على كائن **Document**.

يوضح مثال التعليمات البرمجية التالي كيفية حذف مستند من قاعدة البيانات، باستخدام اسم الملف لجلب السجل:

{{< gist "aspose-com-gists" "0b968ac8900f80c11e109dffb105f3da" "Examples-CSharp-Loading-and-Saving-LoadAndSaveDocToDatabase-DeleteFromDatabase.cs" >}}
